<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analytical Tetrahedron Algorithm · Flink</title><meta name="title" content="Analytical Tetrahedron Algorithm · Flink"/><meta property="og:title" content="Analytical Tetrahedron Algorithm · Flink"/><meta property="twitter:title" content="Analytical Tetrahedron Algorithm · Flink"/><meta name="description" content="Documentation for Flink."/><meta property="og:description" content="Documentation for Flink."/><meta property="twitter:description" content="Documentation for Flink."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/flink.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="Flink logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Flink</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Introduction</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro.html">Welcome</a></li><li><a class="tocitem" href="../install.html">Installation</a></li><li><a class="tocitem" href="../usage.html">Basic Usage</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Modules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="m_constants.html">Constants</a></li><li><a class="tocitem" href="m_face.html">Colorful Terminal Output</a></li><li><a class="tocitem" href="m_linkedlist.html">Linked List</a></li><li><a class="tocitem" href="m_mpi.html">Message Passing Interface</a></li><li><a class="tocitem" href="m_parser.html">Configuration Parser</a></li><li><a class="tocitem" href="m_sparse.html">Sparse Matrix</a></li><li><a class="tocitem" href="m_spring.html">Pseudorandom Number Generator</a></li><li><a class="tocitem" href="m_stack.html">Stack</a></li><li class="is-active"><a class="tocitem" href="m_tetra.html">Analytical Tetrahedron Algorithm</a><ul class="internal"><li><a class="tocitem" href="#Type"><span>Type</span></a></li><li><a class="tocitem" href="#Source"><span>Source</span></a></li><li><a class="tocitem" href="#Usage"><span>Usage</span></a></li><li><a class="tocitem" href="#Theory"><span>Theory</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Subroutines</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="s_error.html">Error and Exception</a></li><li><a class="tocitem" href="s_fourier.html">Fourier Transformation</a></li><li><a class="tocitem" href="s_function.html">Special Functions</a></li><li><a class="tocitem" href="s_integrator.html">Integration</a></li><li><a class="tocitem" href="s_matrix.html">Matrix</a></li><li><a class="tocitem" href="s_spline.html">Spline Interpolation</a></li><li><a class="tocitem" href="s_util.html">Utility</a></li><li><a class="tocitem" href="s_vector.html">Vector</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Appendix</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../appendix/make.html">make.inc</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Modules</a></li><li class="is-active"><a href="m_tetra.html">Analytical Tetrahedron Algorithm</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="m_tetra.html">Analytical Tetrahedron Algorithm</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/huangli712/Flink" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Analytic-Tetrahedron-Algorithm"><a class="docs-heading-anchor" href="#Analytic-Tetrahedron-Algorithm">Analytic Tetrahedron Algorithm</a><a id="Analytic-Tetrahedron-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Analytic-Tetrahedron-Algorithm" title="Permalink"></a></h1><p>In this module, two tetrahedron integration algorithms are implemented. They are:</p><ul><li>P. E. Blochl tetrahedron integration algorithm,</li><li>Lambin-Vigneron tetrahedron integration algorithm.</li></ul><p>Note that the former is used to calculate the DFT density of states, while the later is used to calculate the lattice Green&#39;s functions during the DFT + DMFT calculations. Besides, we also implement three smearing algorithm, which can be used to calculate the DFT density of states as well. They are:</p><ul><li>Gaussian smearing algorithm,</li><li>Fermi-Dirac smearing algorithm,</li><li>Marzari-Vanderbilt cold smearing algorithm.</li></ul><p>This module depends on the <code>s_util.f90/s_qsorter()</code> subroutine.</p><h2 id="Type"><a class="docs-heading-anchor" href="#Type">Type</a><a id="Type-1"></a><a class="docs-heading-anchor-permalink" href="#Type" title="Permalink"></a></h2><p>module</p><h2 id="Source"><a class="docs-heading-anchor" href="#Source">Source</a><a id="Source-1"></a><a class="docs-heading-anchor-permalink" href="#Source" title="Permalink"></a></h2><p><code>src/m_tetra.f90</code></p><h2 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h2><p><strong>(1)</strong> P. E. Blochl tetrahedron integration algorithm.</p><pre><code class="language-fortran hljs">call tetra_blochl_weight1(z, e, dos, tos)</code></pre><p>or</p><pre><code class="language-fortran hljs">call tetra_blochl_weight2(z, e, ddd, ttt)</code></pre><p>For the external energy <code>z</code> and the one-particle energies at the corners of the tetrahedron <code>e</code>, the subroutine <code>tetra_blochl_weight1()</code> returns total contributions of the given tetrahedron to the density of states <code>dos</code> and integrated density of states <code>tos</code>, the subroutine <code>tetra_blochl_weight2()</code> returns corner-dependent contributions of the given tetrahedron to the density of states <code>ddd</code> and integrated density of states <code>ttt</code>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The subroutines</p><ul><li><code>tetra_blochl_weight1()</code></li><li><code>tetra_blochl_weight2()</code></li></ul><p>are private. So, please call the public interface <code>tetra_weight()</code>.</p></div></div><p><strong>(2)</strong> Lambin-Vigneron tetrahedron integration algorithm.</p><pre><code class="language-fortran hljs">call tetra_lambin_weight(z, e, weights)</code></pre><p>For the external energy <code>z</code> and the energy eigenvalues for four corners at given tetrahedron, the subroutine <code>tetra_lambin_weight()</code> returns corner-dependent integration weights <code>weights</code> for lattice Green&#39;s function. Note that now <code>z</code>, <code>e</code>, and <code>weights</code> are all complex.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The subroutine <code>tetra_lambin_weight()</code> is private. So, please call the public interface <code>tetra_weight()</code>.</p></div></div><p><strong>(3)</strong> Gaussian smearing algorithm.</p><pre><code class="language-fortran hljs">call smearing_gauss_weight1(z, e, dos, tos)</code></pre><p>or</p><pre><code class="language-fortran hljs">call smearing_gauss_weight2(z, e, dos, tos)</code></pre><p>or</p><pre><code class="language-fortran hljs">call smearing_gauss_weight3(z, e, dd, tt)</code></pre><p>Here, <code>z</code> means external energy, <code>e</code> means energy at given k-point and band in <code>smearing_gauss_weight1()</code>, corner energies at given tetrahedron in <code>smearing_gauss_weight2()</code> and <code>smearing_gauss_weight3()</code>. In <code>smearing_gauss_weight1()</code> and <code>smearing_gauss_weight2()</code>, the total contributions of the given tetrahedron to the density of states <code>dos</code> and integrated density of states <code>tos</code> are returned. In <code>smearing_gauss_weight3()</code>, the corner-dependent contributions (integration weights) of the given tetrahedron to the density of states <code>dd</code> and integrated density of states <code>tt</code> are returned.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The subroutines</p><ul><li><code>smearing_gauss_weight1()</code></li><li><code>smearing_gauss_weight2()</code></li><li><code>smearing_gauss_weight3()</code></li></ul><p>are private. So, please call the public interface <code>smearing_gauss()</code>.</p></div></div><p><strong>(4)</strong> Fermi-Dirac smearing algorithm.</p><pre><code class="language-fortran hljs">call smearing_fermi_weight1(z, e, dos, tos)</code></pre><p>or</p><pre><code class="language-fortran hljs">call smearing_fermi_weight2(z, e, dos, tos)</code></pre><p>or</p><pre><code class="language-fortran hljs">call smearing_fermi_weight3(z, e, dd, tt)</code></pre><p>Here, <code>z</code> means external energy, <code>e</code> means energy at given k-point and band in <code>smearing_fermi_weight1()</code>, corner energies at given tetrahedron in <code>smearing_fermi_weight2()</code> and <code>smearing_fermi_weight3()</code>. In <code>smearing_fermi_weight1()</code> and <code>smearing_fermi_weight2()</code>, the total contributions of the given tetrahedron to the density of states <code>dos</code> and integrated density of states <code>tos</code> are returned. In <code>smearing_fermi_weight3()</code>, the corner-dependent contributions (integration weights) of the given tetrahedron to the density of states <code>dd</code> and integrated density of states <code>tt</code> are returned.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The subroutines</p><ul><li><code>smearing_fermi_weight1()</code></li><li><code>smearing_fermi_weight2()</code></li><li><code>smearing_fermi_weight3()</code></li></ul><p>are private. So, please call the public interface <code>smearing_fermi()</code>.</p></div></div><p><strong>(5)</strong> Marzari-Vanderbilt cold smearing algorithm.</p><pre><code class="language-fortran hljs">call smearing_marzari_weight1(z, e, dos, tos)</code></pre><p>or</p><pre><code class="language-fortran hljs">call smearing_marzari_weight2(z, e, dos, tos)</code></pre><p>or</p><pre><code class="language-fortran hljs">call smearing_marzari_weight3(z, e, dd, tt)</code></pre><p>Here, <code>z</code> means external energy, <code>e</code> means energy at given k-point and band in <code>smearing_marzari_weight1()</code>, corner energies at given tetrahedron in <code>smearing_marzari_weight2()</code> and <code>smearing_marzari_weight3()</code>. In <code>smearing_marzari_weight1()</code> and <code>smearing_marzari_weight2()</code>, the total contributions of the given tetrahedron to the density of states <code>dos</code> and integrated density of states <code>tos</code> are returned. In <code>smearing_marzari_weight3()</code>, the corner-dependent contributions (integration weights) of the given tetrahedron to the density of states <code>dd</code> and integrated density of states <code>tt</code> are returned.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The subroutines</p><ul><li><code>smearing_marzari_weight1()</code></li><li><code>smearing_marzari_weight2()</code></li><li><code>smearing_marzari_weight3()</code></li></ul><p>are private. So, please call the public interface <code>smearing_marzari()</code>.</p></div></div><h2 id="Theory"><a class="docs-heading-anchor" href="#Theory">Theory</a><a id="Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Theory" title="Permalink"></a></h2><h3 id="Analytical-Tetrahedron-Integration-(Blochl&#39;s-Algorithm)"><a class="docs-heading-anchor" href="#Analytical-Tetrahedron-Integration-(Blochl&#39;s-Algorithm)">Analytical Tetrahedron Integration (Blochl&#39;s Algorithm)</a><a id="Analytical-Tetrahedron-Integration-(Blochl&#39;s-Algorithm)-1"></a><a class="docs-heading-anchor-permalink" href="#Analytical-Tetrahedron-Integration-(Blochl&#39;s-Algorithm)" title="Permalink"></a></h3><p><strong>Number of states</strong></p><p>Here we list the expressions for the integrated density of states or number of states function <span>$n(\epsilon)$</span> from a given tetrahedron. The number of states function is used to determine the Fermi level. The expressions shown are similar to those given in previous papers. For the sake of simplicity we have omitted all band indices. The one-particle energies at the corners of the tetrahedron are <span>$\epsilon_1$</span>, <span>$\epsilon_2$</span>, <span>$\epsilon_3$</span>, <span>$\epsilon_4$</span>, which are ordered according to increasing values. <span>$\epsilon_{ij}$</span> is a shorthand notation for <span>$\epsilon_i - \epsilon_j$</span>. <span>$V_T$</span> is the reciprocal-space volume of the tetrahedron, and <span>$V_G$</span> is the volume of the reciprocal unit cell.</p><p class="math-container">\[\begin{equation}
n(\epsilon) = 0
\end{equation}\]</p><p>for <span>$\epsilon &lt; \epsilon_1$</span>,</p><p class="math-container">\[\begin{equation}
n(\epsilon) = \frac{V_T}{V_G} \frac{(\epsilon - \epsilon_1)^3}{\epsilon_{21}\epsilon_{31}\epsilon_{41}}
\end{equation}\]</p><p>for <span>$\epsilon_1 &lt; \epsilon &lt; \epsilon_2$</span>,</p><p class="math-container">\[\begin{equation}
n(\epsilon) = \frac{V_T}{V_G}
\frac{1}{\epsilon_{31}\epsilon_{41}}
\left[
\epsilon^2_{21} +
3\epsilon_{21}(\epsilon-\epsilon_2) +
3(\epsilon - \epsilon_2)^2 -
\frac{\epsilon_{31} + \epsilon_{42}}{\epsilon_{32}\epsilon_{42}}(\epsilon - \epsilon_2)^3
\right]
\end{equation}\]</p><p>for <span>$\epsilon_2 &lt; \epsilon &lt; \epsilon_3$</span>,</p><p class="math-container">\[\begin{equation}
n(\epsilon) = \frac{V_T}{V_G}
\left(
1 - \frac{(\epsilon_4 - \epsilon)^3}{\epsilon_{41}\epsilon_{42}\epsilon_{43}}
\right)
\end{equation}\]</p><p>for <span>$\epsilon_3 &lt; \epsilon &lt; \epsilon_4$</span>, and</p><p class="math-container">\[\begin{equation}
n(\epsilon) = \frac{V_T}{V_G}
\end{equation}\]</p><p>for <span>$\epsilon &gt; \epsilon_4$</span>.</p><p><strong>Integration weights</strong></p><p>Here we give the expressions that result in the integration weights <span>$w_{nj}$</span>. By <span>$w_1$</span>, <span>$w_2$</span>, <span>$w_3$</span>, and <span>$w_4$</span> we denote the contribution to the integration weights at the four corners of a tetrahedron, which are again ordered according to increasing one-particle energies. Note that the band index <span>$n$</span> is suppressed.</p><p>For a fully tetrahedron, i.e., <span>$\epsilon_F &lt; \epsilon_1$</span>, the contributions vanish:</p><p class="math-container">\[\begin{equation}
w_1 = w_2 = w_3 = w_4 = 0.
\end{equation}\]</p><p>For <span>$\epsilon_1 &lt; \epsilon_F &lt; \epsilon_2$</span>, we obtain</p><p class="math-container">\[\begin{equation}
w_1 = C
\left[
4 - (\epsilon_F - \epsilon_1)
\left(\frac{1}{\epsilon_{21}} + \frac{1}{\epsilon_{31}} + \frac{1}{\epsilon_{41}}\right)
\right],
\end{equation}\]</p><p class="math-container">\[\begin{equation}
w_2 = C \frac{\epsilon_F - \epsilon_1}{\epsilon_{21}},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
w_3 = C \frac{\epsilon_F - \epsilon_1}{\epsilon_{31}},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
w_4 = C \frac{\epsilon_F - \epsilon_1}{\epsilon_{41}},
\end{equation}\]</p><p>with</p><p class="math-container">\[\begin{equation}
C = \frac{V_T}{4V_G} \frac{(\epsilon_F - \epsilon_1)^3}{\epsilon_{21}\epsilon_{31}\epsilon_{41}}.
\end{equation}\]</p><p>For <span>$\epsilon_2 &lt; \epsilon_F &lt; \epsilon_3$</span>, we obtain</p><p class="math-container">\[\begin{equation}
w_1 = C_1 +
(C_1 + C_2) \frac{\epsilon_3 - \epsilon_F}{\epsilon_{31}} +
(C_1 + C_2 + C_3)\frac{\epsilon_4 - \epsilon_F}{\epsilon_{41}},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
w_2 = C_1 + C_2 + C_3 +
(C_2 + C_3) \frac{\epsilon_3 - \epsilon_F}{\epsilon_{32}} +
C_3 \frac{\epsilon_4 - \epsilon_F}{\epsilon_{42}},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
w_3 = (C_1 + C_2) \frac{\epsilon_F - \epsilon_1}{\epsilon_{31}} +
(C_2 + C_3) \frac{\epsilon_F - \epsilon_2}{\epsilon_{32}},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
w_4 = (C_1 + C_2 + C_3)\frac{\epsilon_F - \epsilon_1}{\epsilon_{41}} +
C_3 \frac{\epsilon_F - \epsilon_2}{\epsilon_{42}},
\end{equation}\]</p><p>with</p><p class="math-container">\[\begin{equation}
C_1 = \frac{V_T}{4V_G} \frac{(\epsilon_F - \epsilon_1)^2}{\epsilon_{41}\epsilon_{31}},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
C_2 = \frac{V_T}{4V_G}
\frac{(\epsilon_F - \epsilon_1)(\epsilon_F - \epsilon_2)(\epsilon_3 - \epsilon_F)}{\epsilon_{41}\epsilon_{32}\epsilon_{31}},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
C_3 = \frac{V_T}{4V_G}
\frac{(\epsilon_F - \epsilon_2)^2(\epsilon_4 - \epsilon_F)}{\epsilon_{42}\epsilon_{32}\epsilon_{41}}.
\end{equation}\]</p><p>For <span>$\epsilon_3 &lt; \epsilon_F &lt; \epsilon_4$</span>, the weights are</p><p class="math-container">\[\begin{equation}
w_1 = \frac{V_T}{4V_G} - C \frac{\epsilon_4 - \epsilon_F}{\epsilon_{41}},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
w_2 = \frac{V_T}{4V_G} - C \frac{\epsilon_4 - \epsilon_F}{\epsilon_{42}},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
w_3 = \frac{V_T}{4V_G} - C \frac{\epsilon_4 - \epsilon_F}{\epsilon_{43}},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
w_4 = \frac{V_T}{4V_G} - C
\left[
4 - \left(\frac{1}{\epsilon_{41}} + \frac{1}{\epsilon_{42}} + \frac{1}{\epsilon_{43}}\right)
(\epsilon_4 - \epsilon_F)
\right],
\end{equation}\]</p><p>with</p><p class="math-container">\[\begin{equation}
C = \frac{V_T}{4V_G} \frac{(\epsilon_4 - \epsilon_F)^3}{\epsilon_{41}\epsilon_{42}\epsilon_{43}}.
\end{equation}\]</p><p>For a fully occupied tetrahedron the contribution for each corner is identical:</p><p class="math-container">\[\begin{equation}
w_1 = w_2 = w_3 = w_4 = \frac{V_T}{4V_G}.
\end{equation}\]</p><p>The corresponding correction <span>$dw_i$</span> to the integration weights has an extremely simple form:</p><p class="math-container">\[\begin{equation}
dw_i = \sum_T \frac{1}{40} D_T (\epsilon_F) \sum^4_{j=1} (\epsilon_j - \epsilon_i).
\end{equation}\]</p><p><strong>Density of states</strong></p><p>The contribution of one tetrahedron to the density of states at energy <span>$\epsilon$</span> is given by</p><p class="math-container">\[\begin{equation}
D_T(\epsilon) = 0
\end{equation}\]</p><p>for <span>$\epsilon &lt; \epsilon_1$</span> and for <span>$\epsilon_4 &lt; \epsilon$</span>,</p><p class="math-container">\[\begin{equation}
D_T(\epsilon) = \frac{V_T}{V_G}
\frac{3(\epsilon-\epsilon_1)^2}{\epsilon_{21}\epsilon_{31}\epsilon_{41}}
\end{equation}\]</p><p>for <span>$\epsilon_1 &lt; \epsilon &lt; \epsilon_2$</span>,</p><p class="math-container">\[\begin{equation}
D_T(\epsilon) = \frac{V_T}{V_G}
\frac{1}{\epsilon_{31}\epsilon_{41}}
\left[
3\epsilon_{21} + 6(\epsilon - \epsilon_2)
- 3\frac{(\epsilon_{31} + \epsilon_{42})(\epsilon - \epsilon_2)^2}{\epsilon_{32}\epsilon_{42}}
\right]
\end{equation}\]</p><p>for <span>$\epsilon_2 &lt; \epsilon &lt; \epsilon_3$</span>, and</p><p class="math-container">\[\begin{equation}
D_T(\epsilon) = \frac{V_T}{V_G}
\frac{3(\epsilon_4 - \epsilon)^2}{\epsilon_{41}\epsilon_{42}\epsilon_{43}}
\end{equation}\]</p><p>for <span>$\epsilon_3 &lt; \epsilon &lt; \epsilon_4$</span>.</p><p><strong>References:</strong></p><p>[1] P. E. Blochl, O. Jepsen, and O. K. Anderson, <em>Phys. Rev. B</em> <strong>49</strong>, 16223 (1994)</p><h3 id="Analytical-Tetrahedron-Integration-(Lambin-Vigneron&#39;s-Algorithm)"><a class="docs-heading-anchor" href="#Analytical-Tetrahedron-Integration-(Lambin-Vigneron&#39;s-Algorithm)">Analytical Tetrahedron Integration (Lambin-Vigneron&#39;s Algorithm)</a><a id="Analytical-Tetrahedron-Integration-(Lambin-Vigneron&#39;s-Algorithm)-1"></a><a class="docs-heading-anchor-permalink" href="#Analytical-Tetrahedron-Integration-(Lambin-Vigneron&#39;s-Algorithm)" title="Permalink"></a></h3><p>In this part we will write up the equations of Lambin and Vigneron for the weight factors used in the analytical tetrahedron method. The purpose of this is to rewrite their formulas in a simpler, more readable and hopefully more stable form.</p><p>Before we start writing out the equations let us define a few symbols. The external frequency is denoted by <span>$z$</span> and the energy at corner number <span>$i$</span> is denoted by <span>$\epsilon_i$</span>.  We define <span>$z_i = z-\epsilon_i$</span> and also <span>$\epsilon_{ij} = \epsilon_i-\epsilon_j$</span>.</p><p>In the general case when all the tetrahedron corners have different energies the equation for the weight factor at corner <span>$i$</span> is according to LV</p><p class="math-container">\[\begin{align}
r_i
&amp;\equiv
6\int_{0}^{1}dc\int_{0}^{1-c}db\int_{0}^{1-b-c}da
\frac{(1-a-b-c)\delta_{i1}+a\delta_{i2}+b\delta_{i3}+c\delta_{i4}}
{z_1-a\epsilon_{21}-b\epsilon_{31}-c\epsilon_{41}} \\
&amp;=
\frac{z_i^2}{\prod_{k\neq i}\epsilon_{ki}}+\sum_{j\neq i}
\frac{z_j^3}{\prod_{k\neq j}\epsilon_{kj}}
\frac{\log\left(\frac{z_j}{z_i}\right)}{\epsilon_{ij}}.
\end{align}\]</p><p>If we now use the identity:</p><p class="math-container">\[\begin{equation}
  0 = \sum_{i=1}^{4}\frac{z_i^2}{\prod_{j\neq i}(z_i-z_j)} =
  \sum_{i=1}^{4}\frac{z_i^2}{\prod_{j\neq i}\epsilon_{ji}}
\end{equation}\]</p><p>the equation for the weight factor can be written as</p><p class="math-container">\[\begin{align}
r_i
&amp;=
\sum_{j \neq i}
\frac{z_j^2}{\prod_{k \neq j}\epsilon_{kj}}
\left[
\frac{z_j}{\epsilon_{ij}}\log\left(\frac{z_j}{z_i}\right)-1
\right] \\
&amp;=
\sum_{j \neq i}
\frac{z_j}{\prod_{k \neq i,j}\epsilon_{kj}}
\Big[
\frac{z_j}{\epsilon_{ji}}-
\frac{z_j^2}{\epsilon_{ij}^2}\log\left(1+\frac{\epsilon_{ji}}{z_j}\right)
\Big] \\
&amp;=
\sum_{j \neq i}
\frac{z_j}{\prod_{k \neq i,j}\epsilon_{kj}}lv\left(\frac{z_j}{\epsilon_{ji}}\right).
\end{align}\]</p><p>Here we have defined the so called Lambin-Vigneron function as:</p><p class="math-container">\[\begin{equation}
lv(x) = x\left(1-x\log\left[1+\frac{1}{x}\right]\right).
\end{equation}\]</p><p>This is a simple function which is easy to compute and also has the added benefit of having nice asymptotic limits, i.e.</p><p class="math-container">\[\begin{equation}
  \lim_{x\rightarrow 0}lv(x) = 0
\end{equation}\]</p><p>and</p><p class="math-container">\[\begin{equation}
  \lim_{x\rightarrow \infty}lv(x) = \frac{1}{2}.
\end{equation}\]</p><p>For considering the cases where the some of the corner energies are identical it is useful to write out the equations above explicitly for each corner:</p><p class="math-container">\[\begin{align}
r_1 &amp;=
 \frac{z_2}{\epsilon_{32}\epsilon_{42}}lv\left(\frac{z_2}{\epsilon_{21}}\right)
+\frac{z_3}{\epsilon_{23}\epsilon_{43}}lv\left(\frac{z_3}{\epsilon_{31}}\right)
+\frac{z_4}{\epsilon_{24}\epsilon_{34}}lv\left(\frac{z_4}{\epsilon_{41}}\right)
 \\
r_2 &amp;=
 \frac{z_1}{\epsilon_{31}\epsilon_{41}}lv\left(\frac{z_1}{\epsilon_{12}}\right)
+\frac{z_3}{\epsilon_{13}\epsilon_{43}}lv\left(\frac{z_3}{\epsilon_{32}}\right)
+\frac{z_4}{\epsilon_{14}\epsilon_{34}}lv\left(\frac{z_4}{\epsilon_{42}}\right)
 \\
r_3 &amp;=
 \frac{z_1}{\epsilon_{21}\epsilon_{41}}lv\left(\frac{z_1}{\epsilon_{13}}\right)
+\frac{z_2}{\epsilon_{12}\epsilon_{42}}lv\left(\frac{z_2}{\epsilon_{23}}\right)
+\frac{z_4}{\epsilon_{14}\epsilon_{24}}lv\left(\frac{z_4}{\epsilon_{43}}\right)
 \\
r_4 &amp;=
 \frac{z_1}{\epsilon_{21}\epsilon_{31}}lv\left(\frac{z_1}{\epsilon_{14}}\right)
+\frac{z_2}{\epsilon_{12}\epsilon_{32}}lv\left(\frac{z_2}{\epsilon_{24}}\right)
+\frac{z_3}{\epsilon_{13}\epsilon_{23}}lv\left(\frac{z_3}{\epsilon_{34}}\right)
\end{align}\]</p><p>The next case we consider is when two corners have equal energies and we assume here that the corners have been ordered in such as way that <span>$\epsilon_1 = \epsilon_2$</span>.  Looking at the formulas above we see that the limit <span>$\epsilon_1 \rightarrow \epsilon_2$</span> is trivial take for the weight factors for corners 1 and 2 but for corners 3 and 4 two terms must be taken together and using Mathematica we get:</p><p class="math-container">\[\begin{align}
r_2 &amp;=
 \frac{1}{2}\frac{z_2}{\epsilon_{32}\epsilon_{42}}
+\frac{z_3}{\epsilon_{23}\epsilon_{43}}lv\left(\frac{z_3}{\epsilon_{32}}\right)
+\frac{z_4}{\epsilon_{24}\epsilon_{34}}lv\left(\frac{z_4}{\epsilon_{42}}\right)
 \\
r_3 &amp;=
 \frac{z_2}{\epsilon_{23}\epsilon_{24}}
 -\left[\frac{2z_3}{\epsilon_{23}\epsilon_{24}}+\frac{z_4}{\epsilon_{24}^2}\right]
 lv\left(\frac{z_2}{\epsilon_{23}}\right)
+\frac{z_4}{\epsilon_{24}^2}lv\left(\frac{z_4}{\epsilon_{43}}\right)
 \\
r_4 &amp;=
 \frac{z_2}{\epsilon_{23}\epsilon_{24}}
 -\left[\frac{2z_4}{\epsilon_{23}\epsilon_{24}}+\frac{z_3}{\epsilon_{23}^2}\right]
 lv\left(\frac{z_2}{\epsilon_{24}}\right)
+\frac{z_3}{\epsilon_{23}^2}lv\left(\frac{z_3}{\epsilon_{34}}\right)
\end{align}\]</p><p>The next case we consider is <span>$\epsilon_1 = \epsilon_2$</span> and <span>$\epsilon_4 = \epsilon_3$</span> and we see from the formulas in equation (see above) that the limit <span>$\epsilon_4 \rightarrow \epsilon_3$</span> is trivial for corners 3 and 4 and the weight factor for corner 2 follows from symmetry. Hence we get:</p><p class="math-container">\[\begin{align}
r_2 &amp;=
 \frac{z_3}{\epsilon_{32}^2}+\frac{1}{2}\frac{z_2}{\epsilon_{32}^2}
 -3\frac{z_2}{\epsilon_{32}^2}lv\left(\frac{z_3}{\epsilon_{32}}\right)
 \\
r_3 &amp;=
 \frac{z_2}{\epsilon_{23}^2}+\frac{1}{2}\frac{z_3}{\epsilon_{23}^2}
 -3\frac{z_3}{\epsilon_{23}^2}lv\left(\frac{z_2}{\epsilon_{23}}\right)
\end{align}\]</p><p>Next case is <span>$\epsilon_1 = \epsilon_2 = \epsilon_3$</span> and this case we can either obtain from the formulas in equation (44) or simply do the corresponding integral which is simple in this case since we have:</p><p class="math-container">\[\begin{align}
  r_3 &amp;= \int_{0}^{1}dc\int_{0}^{1-c}db\int_{0}^{1-b-c}da
  \frac{b}{z_3-c\epsilon_{43}}
  \\
  r_4 &amp;= \int_{0}^{1}dc\int_{0}^{1-c}db\int_{0}^{1-b-c}da
  \frac{c}{z_3-c\epsilon_{43}}.
\end{align}\]</p><p>Performing these integrals we obtain:</p><p class="math-container">\[\begin{align}
r_3 &amp;=
 \frac{2z_3-5z_4}{6\epsilon_{34}^2}+
 \frac{z_4}{\epsilon_{34}^2}lv\left(\frac{z_4}{\epsilon_{43}}\right) \\
r_4 &amp;=
 \frac{z_4}{\epsilon_{43}^2}+\frac{1}{2}\frac{z_3}{\epsilon_{43}^2}
 -3\frac{z_3}{\epsilon_{43}^2}lv\left(\frac{z_4}{\epsilon_{43}}\right)
\end{align}\]</p><p>The final case is of course the simplest one where all the corners have the same energy and in that case we obtain:</p><p class="math-container">\[\begin{equation}
r_4 = \frac{1}{4}\frac{1}{z_4}
\end{equation}\]</p><p><strong>References:</strong></p><p>[1] Gunnar Palsson, <em>PhD Thesis</em>, Rutgers University (2001)</p><p>[2] P. Lambin and J. P. Vigneron, <em>Phys. Rev. B</em> <strong>29</strong>, 3430 (1984)</p><h3 id="Smearning-algorithm"><a class="docs-heading-anchor" href="#Smearning-algorithm">Smearning algorithm</a><a id="Smearning-algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Smearning-algorithm" title="Permalink"></a></h3><p><strong>Gaussian smearing</strong></p><p class="math-container">\[\begin{equation}
n(x) = \frac{1 - \text{erfc}{(-x)}} {8}
\end{equation}\]</p><p class="math-container">\[\begin{equation}
D(x) = \frac{1}{4} \frac{\exp(-x^2/2)}{\sqrt{\pi}\gamma}
\end{equation}\]</p><p>where <span>$x = (z - e) / \gamma$</span>. <span>$\gamma$</span> is a adjustable parameter, <span>$z$</span> is the external energy, <span>$e$</span> is the energy at given <span>$k$</span>-point and band or corner energies at given tetrahedron.</p><p><strong>Fermi-Dirac smearing</strong></p><p class="math-container">\[\begin{equation}
n(x) = \frac{1}{1 + \exp{(-x)}}
\end{equation}\]</p><p class="math-container">\[\begin{equation}
D(x) = \frac{1}{2} \frac{1}{1 + \cosh{(x)}}
\end{equation}\]</p><p>where <span>$x = (z - e) / \gamma$</span>. <span>$\gamma$</span> is a adjustable parameter, <span>$z$</span> is the external energy, <span>$e$</span> is the energy at given <span>$k$</span>-point and band or corner energies at given tetrahedron.</p><p><strong>Marzari-Vanderbilt cold smearing</strong></p><p class="math-container">\[\begin{equation}
n(x) = \frac{\text{erf}(\tilde{x})}{2} + \frac{1}{\sqrt{2\pi}}
\exp(-\tilde{x}^2) + \frac{1}{2}
\end{equation}\]</p><p class="math-container">\[\begin{equation}
D(x) = \frac{2}{\sqrt{\pi}}
\exp{(-\tilde{x}^2)}( 2 - \sqrt{2}x )
\end{equation}\]</p><p>where <span>$x = (z - e) / \gamma$</span> and <span>$\tilde{x} = x - \frac{1}{\sqrt{2}}$</span>. <span>$\gamma$</span> is a adjustable parameter, <span>$z$</span> is the external energy, <span>$e$</span> is the energy at given <span>$k$</span>-point and band or corner energies at given tetrahedron.</p><p><strong>References:</strong></p><p>[1] N. Marzari, D. Vanderbilt, <em>et al.</em>, <em>Phys. Rev. Lett.</em> <strong>82</strong>, 3296 (1999)</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="m_stack.html">« Stack</a><a class="docs-footer-nextpage" href="s_error.html">Error and Exception »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 26 March 2025 11:32">Wednesday 26 March 2025</span>. Using Julia version 1.11.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
