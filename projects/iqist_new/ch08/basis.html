<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Single particle basis · iQIST</title><meta name="title" content="Single particle basis · iQIST"/><meta property="og:title" content="Single particle basis · iQIST"/><meta property="twitter:title" content="Single particle basis · iQIST"/><meta name="description" content="Documentation for iQIST."/><meta property="og:description" content="Documentation for iQIST."/><meta property="twitter:description" content="Documentation for iQIST."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/iqist.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="iQIST logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">iQIST</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><a class="tocitem" href="../team.html">Team</a></li><li><a class="tocitem" href="../copy.html">Copyright</a></li><li><a class="tocitem" href="../thanks.html">Acknowledgements</a></li><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../ch01/index.html">Contents</a></li><li><a class="tocitem" href="../ch01/what.html">What&#39;s iQIST?</a></li><li><a class="tocitem" href="../ch01/motivation.html">Motivation</a></li><li><a class="tocitem" href="../ch01/components.html">Components</a></li><li><a class="tocitem" href="../ch01/architecture.html">Software architecture</a></li><li><a class="tocitem" href="../ch01/feature.html">Features</a></li><li><a class="tocitem" href="../ch01/policy.html">Policy</a></li></ul></li><li><span class="tocitem">Installation</span><ul><li><a class="tocitem" href="../ch02/index.html">Contents</a></li><li><a class="tocitem" href="../ch02/obtain.html">Obtain</a></li><li><a class="tocitem" href="../ch02/uncompress.html">Uncompress</a></li><li><a class="tocitem" href="../ch02/directory.html">Directory structures</a></li><li><a class="tocitem" href="../ch02/envir.html">Compiling environment</a></li><li><a class="tocitem" href="../ch02/system.html">Compiling system</a></li><li><a class="tocitem" href="../ch02/inc.html">Explanation of make.inc</a></li><li><a class="tocitem" href="../ch02/full.html">Build iQIST at one step</a></li><li><input class="collapse-toggle" id="menuitem-6-9" type="checkbox"/><label class="tocitem" for="menuitem-6-9"><span class="docs-label">Build iQIST at multiple steps</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ch02/multi.html">Contents</a></li><li><a class="tocitem" href="../ch02/solvers.html">Build quantum impurity solvers</a></li><li><a class="tocitem" href="../ch02/atomic.html">Build atomic eigenvalue problem solver</a></li><li><a class="tocitem" href="../ch02/docs.html">Build documentation</a></li></ul></li></ul></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../ch03/index.html">Contents</a></li><li><a class="tocitem" href="../ch03/config.html">Configure your system</a></li><li><a class="tocitem" href="../ch03/recipes.html">iQIST recipes</a></li><li><a class="tocitem" href="../ch03/create.html">Prepare input files</a></li><li><a class="tocitem" href="../ch03/execute.html">Execute the codes</a></li><li><a class="tocitem" href="../ch03/monitor.html">Monitor the codes</a></li><li><a class="tocitem" href="../ch03/profile.html">Profile the codes</a></li></ul></li><li><span class="tocitem">Quantum impurity solvers</span><ul><li><a class="tocitem" href="../ch04/index.html">Contents</a></li><li><a class="tocitem" href="../ch04/choose.html">How to choose suitable quantum impurity solvers?</a></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Standard input files</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ch04/input.html">Contents</a></li><li><a class="tocitem" href="../ch04/in_ctqmc.html">solver.ctqmc.in</a></li><li><a class="tocitem" href="../ch04/in_hyb.html">solver.hyb.in</a></li><li><a class="tocitem" href="../ch04/in_umat.html">solver.umat.in</a></li><li><a class="tocitem" href="../ch04/in_eimp.html">solver.eimp.in</a></li><li><a class="tocitem" href="../ch04/in_anydos.html">solver.anydos.in</a></li><li><a class="tocitem" href="../ch04/in_ktau.html">solver.ktau.in</a></li><li><a class="tocitem" href="../ch04/in_atom.html">atom.cix</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox"/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">Standard output files</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ch04/output.html">Contents</a></li><li><a class="tocitem" href="../ch04/out_green.html">solver.green.dat</a></li><li><a class="tocitem" href="../ch04/out_weiss.html">solver.weiss.dat</a></li><li><a class="tocitem" href="../ch04/out_hybri.html">solver.hybri.dat</a></li><li><a class="tocitem" href="../ch04/out_grn.html">solver.grn.dat</a></li><li><a class="tocitem" href="../ch04/out_wss.html">solver.wss.dat</a></li><li><a class="tocitem" href="../ch04/out_hyb.html">solver.hyb.dat</a></li><li><a class="tocitem" href="../ch04/out_sgm.html">solver.sgm.dat</a></li><li><a class="tocitem" href="../ch04/out_hist.html">solver.hist.dat</a></li><li><a class="tocitem" href="../ch04/out_prob.html">solver.prob.dat</a></li><li><a class="tocitem" href="../ch04/out_nmat.html">solver.nmat.dat</a></li><li><a class="tocitem" href="../ch04/out_diag.html">solver.diag.dat</a></li><li><a class="tocitem" href="../ch04/out_stat.html">solver.status.dat</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-5" type="checkbox"/><label class="tocitem" for="menuitem-8-5"><span class="docs-label">Parameters</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ch04/parameters.html">Contents</a></li><li><a class="tocitem" href="../ch04/p_isscf.html">isscf</a></li><li><a class="tocitem" href="../ch04/p_isbnd.html">isbnd</a></li><li><a class="tocitem" href="../ch04/p_isspn.html">isspn</a></li><li><a class="tocitem" href="../ch04/p_nband.html">nband</a></li><li><a class="tocitem" href="../ch04/p_nspin.html">nspin</a></li><li><a class="tocitem" href="../ch04/p_norbs.html">norbs</a></li><li><a class="tocitem" href="../ch04/p_ncfgs.html">ncfgs</a></li><li><a class="tocitem" href="../ch04/p_niter.html">niter</a></li><li><a class="tocitem" href="../ch04/p_mkink.html">mkink</a></li><li><a class="tocitem" href="../ch04/p_mfreq.html">mfreq</a></li><li><a class="tocitem" href="../ch04/p_nffrq.html">nffrq</a></li><li><a class="tocitem" href="../ch04/p_nbfrq.html">nbfrq</a></li><li><a class="tocitem" href="../ch04/p_nfreq.html">nfreq</a></li><li><a class="tocitem" href="../ch04/p_ntime.html">ntime</a></li><li><a class="tocitem" href="../ch04/p_nflip.html">nflip</a></li><li><a class="tocitem" href="../ch04/p_ntherm.html">ntherm</a></li><li><a class="tocitem" href="../ch04/p_nsweep.html">nsweep</a></li><li><a class="tocitem" href="../ch04/p_nwrite.html">nwrite</a></li><li><a class="tocitem" href="../ch04/p_nclean.html">nclean</a></li><li><a class="tocitem" href="../ch04/p_nmonte.html">nmonte</a></li><li><a class="tocitem" href="../ch04/p_ncarlo.html">ncarlo</a></li><li><a class="tocitem" href="../ch04/p_u.html">U</a></li><li><a class="tocitem" href="../ch04/p_uc.html">Uc</a></li><li><a class="tocitem" href="../ch04/p_uv.html">Uv</a></li><li><a class="tocitem" href="../ch04/p_jz.html">Jz</a></li><li><a class="tocitem" href="../ch04/p_js.html">Js</a></li><li><a class="tocitem" href="../ch04/p_jp.html">Jp</a></li><li><a class="tocitem" href="../ch04/p_mune.html">mune</a></li><li><a class="tocitem" href="../ch04/p_beta.html">beta</a></li><li><a class="tocitem" href="../ch04/p_part.html">part</a></li><li><a class="tocitem" href="../ch04/p_alpha.html">alpha</a></li></ul></li></ul></li><li><span class="tocitem">Atomic eigenvalue problem solver</span><ul><li><input class="collapse-toggle" id="menuitem-9-1" type="checkbox"/><label class="tocitem" for="menuitem-9-1"><span class="docs-label">Standard input files</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ch05/input.html">README</a></li><li><a class="tocitem" href="../ch05/in_atom.html">atom.config.in</a></li><li><a class="tocitem" href="../ch05/in_cmat.html">atom.cmat.in</a></li><li><a class="tocitem" href="../ch05/in_emat.html">atom.emat.in</a></li><li><a class="tocitem" href="../ch05/in_tmat.html">atom.tmat.in</a></li></ul></li><li><span class="tocitem">Standard output files</span></li><li><input class="collapse-toggle" id="menuitem-9-3" type="checkbox"/><label class="tocitem" for="menuitem-9-3"><span class="docs-label">Parameters</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ch05/parameters.html">README</a></li><li><a class="tocitem" href="../ch05/p_ibasis.html">ibasis</a></li><li><a class="tocitem" href="../ch05/p_ictqmc.html">ictqmc</a></li><li><a class="tocitem" href="../ch05/p_icu.html">icu</a></li><li><a class="tocitem" href="../ch05/p_icf.html">icf</a></li><li><a class="tocitem" href="../ch05/p_isoc.html">isoc</a></li><li><a class="tocitem" href="../ch05/p_nband.html">nband</a></li><li><a class="tocitem" href="../ch05/p_nspin.html">nspin</a></li><li><a class="tocitem" href="../ch05/p_norbs.html">norbs</a></li><li><a class="tocitem" href="../ch05/p_ncfgs.html">ncfgs</a></li><li><a class="tocitem" href="../ch05/p_nmini.html">nmini</a></li><li><a class="tocitem" href="../ch05/p_nmaxi.html">nmaxi</a></li><li><a class="tocitem" href="../ch05/p_uc.html">Uc</a></li><li><a class="tocitem" href="../ch05/p_uv.html">Uv</a></li><li><a class="tocitem" href="../ch05/p_jz.html">Jz</a></li><li><a class="tocitem" href="../ch05/p_js.html">Js</a></li><li><a class="tocitem" href="../ch05/p_jp.html">Jp</a></li><li><a class="tocitem" href="../ch05/p_ud.html">Ud</a></li><li><a class="tocitem" href="../ch05/p_jh.html">Jh</a></li><li><a class="tocitem" href="../ch05/p_mune.html">mune</a></li><li><a class="tocitem" href="../ch05/p_lambda.html">lambda</a></li></ul></li></ul></li><li><span class="tocitem">Auxiliary tools</span><ul><li><input class="collapse-toggle" id="menuitem-10-1" type="checkbox"/><label class="tocitem" for="menuitem-10-1"><span class="docs-label">Scripts</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ch06/movie.html">u_movie.py</a></li><li><a class="tocitem" href="../ch06/atomic.html">u_atomic.py</a></li><li><a class="tocitem" href="../ch06/ctqmc.html">u_ctqmc.py</a></li><li><a class="tocitem" href="../ch06/reader.html">u_reader.py</a></li><li><a class="tocitem" href="../ch06/writer.html">u_writer.py</a></li></ul></li></ul></li><li><span class="tocitem">iQIST in action</span><ul><li><a class="tocitem" href="../ch07/story.html">Successful stories</a></li></ul></li><li><span class="tocitem">Inside iQIST</span><ul><li><input class="collapse-toggle" id="menuitem-12-1" type="checkbox"/><label class="tocitem" for="menuitem-12-1"><span class="docs-label">Basic theory and methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="basic.html">Outline</a></li><li><a class="tocitem" href="qim.html">Quantum impurity model</a></li><li><a class="tocitem" href="ct.html">Principles of continuous-time quantum Monte Carlo algorithm</a></li><li><a class="tocitem" href="hyb.html">Hybridization expansion</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-12-2" type="checkbox" checked/><label class="tocitem" for="menuitem-12-2"><span class="docs-label">Algorithms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="sig.html">Improved estimator for the self-energy function</a></li><li><a class="tocitem" href="truncation.html">Truncation approximation</a></li><li><a class="tocitem" href="lazy.html">Lazy trace evaluation</a></li><li><a class="tocitem" href="rng.html">Random number generator</a></li><li><a class="tocitem" href="atomic.html">Atomic eigenvalue solver</a></li><li class="is-active"><a class="tocitem" href="basis.html">Single particle basis</a></li><li><a class="tocitem" href="soc.html">Spin-orbit coupling</a></li><li><a class="tocitem" href="coulomb.html">Coulomb interaction matrix</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-12-3" type="checkbox"/><label class="tocitem" for="menuitem-12-3"><span class="docs-label">Codes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="platform.html">Development platform</a></li></ul></li></ul></li><li><a class="tocitem" href="../glossary.html">Glossary</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Inside iQIST</a></li><li><a class="is-disabled">Algorithms</a></li><li class="is-active"><a href="basis.html">Single particle basis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="basis.html">Single particle basis</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/huangli712/iQIST" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Single-particle-basis"><a class="docs-heading-anchor" href="#Single-particle-basis">Single particle basis</a><a id="Single-particle-basis-1"></a><a class="docs-heading-anchor-permalink" href="#Single-particle-basis" title="Permalink"></a></h1><p>In this section, we define some single particle basis used in the <strong>JASMINE</strong> component to write down the atomic Hamiltonian <span>$\hat{H}_{\text{atom}}$</span>. We set <span>$\hbar=1$</span> in this note.</p><hr/><p><strong>Spherical harmonics</strong></p><p>The complex spherical harmonics <span>$Y_{l}^{m}(\theta,\phi)$</span> are the eigenstates of operators <span>$\hat{l}^{2}$</span> and <span>$\hat{l}_{z}$</span>,</p><p class="math-container">\[\begin{equation}
\hat{l}^{2}Y_{l}^{m}=l(l+1)Y_{l}^{m},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
\hat{l}_{z}Y_{l}^{m}=mY_{l}^{m},
\end{equation}\]</p><p>where <span>$l$</span> is the azimuthal quantum number (<span>$l = 0,~1,~2,~\cdots,~n-1$</span>), and <span>$m$</span> is the magnetic quantum number (<span>$m=-l,~-l+1,~\cdots,~l$</span>)<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup><sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>. They are defined as follows:</p><p class="math-container">\[\begin{equation}
Y^m_l(\theta,\phi) = \sqrt{\frac{2l+1}{4\pi}\frac{(l-m)!}{(l+m)!}}
P^m_l(\cos{\theta}) e^{im\phi},
\end{equation}\]</p><p>where <span>$\theta$</span> is taken as the polar (colatitudinal) coordinate with <span>$\theta \in [0,\pi]$</span>, and <span>$\phi$</span> as the azimuthal (longitudinal) coordinate with <span>$\phi \in [0,2\pi]$</span>, and <span>$P^m_l(z)$</span> is an associated Legendre polynomial.</p><p>The spherical harmonics are orthonormal</p><p class="math-container">\[\begin{equation}
\int^{\pi}_{\theta = 0} \int^{2\pi}_{\phi = 0}
Y^m_l(\theta,\phi) Y^{m&#39;*}_{l&#39;}(\theta,\phi)~d\Omega = \delta_{ll&#39;} \delta_{mm&#39;},
\end{equation}\]</p><p>where <span>$\delta_{ij}$</span> is the Kronecker delta and <span>$d\Omega = \sin(\theta) d\phi d\theta$</span>.</p><hr/><p><strong>Real Spherical Harmonics</strong></p><p>The real spherical harmonics <span>$Y_{lm}$</span> are defined as<sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup></p><p class="math-container">\[\begin{gather}
Y_{lm}=\begin{cases}
  \frac{i}{\sqrt{2}}\left(Y_{l}^{-|m|}-(-1)^{m}Y_{l}^{|m|}\right) &amp; \text{if}\ m&lt;0,\\
  Y_{l}^{0} &amp; \text{if}\ m=0,\\
  \frac{1}{\sqrt{2}}\left(Y_{l}^{-|m|}+(-1)^{m}Y_{l}^{|m|}\right) &amp; \text{if}\ m&gt;0.
\end{cases}
\end{gather}\]</p><p>The corresponding inverse equations defining the complex spherical harmonics <span>$Y^m_l$</span> in terms of the real spherical harmonics <span>$Y_{lm}$</span> read:</p><p class="math-container">\[\begin{gather}
Y_{l}^{m}=\begin{cases}
  \frac{1}{\sqrt{2}}\left(Y_{l|m|}-iY_{l,-|m|}\right) &amp; \text{if}\ m&lt;0,\\
  Y_{l0} &amp; \text{if}\ m=0,\\
  \frac{(-1)^m}{\sqrt{2}}\left(Y_{l|m|}+iY_{l,-|m|}\right) &amp; \text{if}\ m&gt;0.
\end{cases}
\end{gather}\]</p><p>The real spherical harmonics <span>$Y_{lm}$</span> are sometimes known as tesseral spherical harmonics. These functions have the same orthonormality properties as the complex ones <span>$Y_{l}^{m}$</span>.</p><hr/><p><strong>Spinor spherical harmonics</strong></p><p>The spinor spherical harmonics <span>$\Omega^l_{jm_j}(\theta,\phi)$</span> are eigenstates of the operators <span>$\hat{j}^2$</span>, <span>$\hat{j}_z$</span>, <span>$\hat{l}^2$</span>, and <span>$\hat{s}^2$</span>,</p><p class="math-container">\[\begin{equation}
\hat{j}^2 \Omega^l_{jm_j} = j (j + 1) \Omega^l_{jm_j},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
\hat{j}_z \Omega^l_{jm_j} = m_j \Omega^l_{jm_j},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
\hat{l}^2 \Omega^l_{jm_j} = l (l + 1) \Omega^l_{jm_j},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
\hat{s}^2 \Omega^l_{jm_j} = s(s+1) \Omega^l_{jm_j}.
\end{equation}\]</p><p>For given <span>$j$</span> only two values of <span>$l$</span> are possible, <span>$l = j \pm \frac{1}{2}$</span>, while <span>$m_j$</span> assumes <span>$2j + 1$</span> values (<span>$m_j = -j,~-j + 1,~\cdots,~j - 1,~j$</span>) <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup><sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>.</p><p>For <span>$j = l + \frac{1}{2}$</span>, <span>$m_j = m + \frac{1}{2}$</span>,</p><p class="math-container">\[\begin{equation}
\Omega^l_{jm_j} = \sqrt{\frac{l+m+1}{2l+1}} Y^m_l \chi_{\uparrow}
                + \sqrt{\frac{l-m}{2l+1}} Y^{m+1}_l \chi_{\downarrow}.
\end{equation}\]</p><p>For <span>$j = l - \frac{1}{2} (l \neq 0)$</span>, <span>$m_j = m + \frac{1}{2}$</span>,</p><p class="math-container">\[\begin{equation}
\Omega^l_{jm_j} = -\sqrt{\frac{l-m}{2l+1}} Y^m_l \chi_{\uparrow}
                + \sqrt{\frac{l+m+1}{2l+1}} Y^{m+1}_l \chi_{\downarrow}.
\end{equation}\]</p><hr/><p><strong>Real orbital basis</strong></p><p>The basis functions are the real spherical harmonics <span>$Y_{lm}(\theta,\phi)$</span>.</p><p>For <span>$p$</span> system, the basis order is<sup class="footnote-reference"><a id="citeref-4" href="#footnote-4">[4]</a></sup></p><p class="math-container">\[\begin{equation}
\begin{split}
&amp;
|p_y, \uparrow \rangle,~
|p_z, \uparrow \rangle,~
|p_x, \uparrow \rangle,~\\
&amp;
|p_y, \downarrow \rangle,~
|p_z, \downarrow \rangle,~
|p_x, \downarrow \rangle.
\end{split}
\end{equation}\]</p><p class="math-container">\[\begin{equation}
|p_{y}\rangle = Y_{1,-1}=\frac{i}{\sqrt{2}}\left(Y_{1}^{-1}+Y_{1}^{1}\right),
\end{equation}\]</p><p class="math-container">\[\begin{equation}
|p_{z}\rangle =  Y_{10}=Y_{1}^{0},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
|p_{x}\rangle  =  Y_{11}=\frac{1}{\sqrt{2}}\left(Y_{1}^{-1}-Y_{1}^{1}\right).
\end{equation}\]</p><p>For <span>$d$</span> system, the basis order is<sup class="footnote-reference"><a id="citeref-4" href="#footnote-4">[4]</a></sup></p><p class="math-container">\[\begin{equation}
\begin{split}
&amp;
|d_{xy}, \uparrow \rangle,~
|d_{yz}, \uparrow \rangle,~
|d_{z^2}, \uparrow \rangle,~
|d_{xz}, \uparrow \rangle,~
|d_{x^2-y^2}, \uparrow \rangle,~\\
&amp;
|d_{xy}, \downarrow \rangle,~
|d_{yz}, \downarrow \rangle,~
|d_{z^2}, \downarrow \rangle,~
|d_{xz}, \downarrow \rangle,~
|d_{x^2-y^2}, \downarrow \rangle.
\end{split}
\end{equation}\]</p><p class="math-container">\[\begin{equation}
d_{xy} = Y_{2,-2}=\frac{i}{\sqrt{2}}\left(Y_{2}^{-2}-Y_{2}^{2}\right),
\end{equation}\]</p><p class="math-container">\[\begin{equation}
d_{yz} = Y_{2,-1}=\frac{i}{\sqrt{2}}\left(Y_{2}^{-1}+Y_{2}^{1}\right),
\end{equation}\]</p><p class="math-container">\[\begin{equation}
d_{z^{2}} = Y_{20}=Y_{2}^{0},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
d_{xz} = Y_{21}=\frac{1}{\sqrt{2}}\left(Y_{2}^{-1}-Y_{2}^{1}\right),
\end{equation}\]</p><p class="math-container">\[\begin{equation}
d_{x^{2}-y^{2}} = Y_{22}=\frac{1}{\sqrt{2}}\left(Y_{2}^{-2}+Y_{2}^{2}\right).
\end{equation}\]</p><p>For <span>$f$</span> system, the basis order is<sup class="footnote-reference"><a id="citeref-4" href="#footnote-4">[4]</a></sup></p><p class="math-container">\[\begin{equation}
\begin{split}
&amp;
|f_{y(3x^2-y^2)}, \uparrow \rangle,~
|f_{xyz}, \uparrow \rangle,~
|f_{yz^2}, \uparrow \rangle,~
|f_{z^3}, \uparrow \rangle,~
|f_{xz^2}, \uparrow \rangle,~
|f_{z(x^2-y^2)}, \uparrow \rangle,~
|f_{x(x^2-3y^2)}, \uparrow \rangle,\\
&amp;
|f_{y(3x^2-y^2)}, \downarrow \rangle,~
|f_{xyz}, \downarrow \rangle,~
|f_{yz^2}, \downarrow \rangle,~
|f_{z^3}, \downarrow \rangle,~
|f_{xz^2}, \downarrow \rangle,~
|f_{z(x^2-y^2)}, \downarrow \rangle,~
|f_{x(x^2-3y^2)}, \downarrow \rangle.
\end{split}
\end{equation}\]</p><p class="math-container">\[\begin{equation}
f_{y(3x^{2}-y^{2})} = Y_{3,-3}=\frac{i}{\sqrt{2}}\left(Y_{3}^{-3}+Y_{3}^{3}\right),
\end{equation}\]</p><p class="math-container">\[\begin{equation}
f_{xyz} = Y_{3,-2}=\frac{i}{\sqrt{2}}\left(Y_{3}^{-2}-Y_{3}^{2}\right),
\end{equation}\]</p><p class="math-container">\[\begin{equation}
f_{yz^{2}} = Y_{3,-1}=\frac{i}{\sqrt{2}}\left(Y_{3}^{-1}+Y_{3}^{1}\right),
\end{equation}\]</p><p class="math-container">\[\begin{equation}
f_{z^{3}} = Y_{30}=Y_{3}^{0},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
f_{xz^{2}} = Y_{31}=\frac{1}{\sqrt{2}}\left(Y_{3}^{-1}-Y_{3}^{1}\right),
\end{equation}\]</p><p class="math-container">\[\begin{equation}
f_{z(x^{2}-y^{2})} = Y_{32}=\frac{1}{\sqrt{2}}\left(Y_{3}^{-2}+Y_{3}^{2}\right),
\end{equation}\]</p><p class="math-container">\[\begin{equation}
f_{x(x^{2}-3y^{2})} = Y_{33}=\frac{1}{\sqrt{2}}\left(Y_{3}^{-3}-Y_{3}^{3}\right).
\end{equation}\]</p><p>For <span>$t_{2g}$</span> system, we have a <span>$T-P$</span> equivalence,</p><p class="math-container">\[\begin{equation}
d_{xz} \rightarrow p_{y}=\frac{i}{\sqrt{2}}\left(Y_{1}^{-1}+Y_{1}^{1}\right),
\end{equation}\]</p><p class="math-container">\[\begin{equation}
d_{xy} \rightarrow p_{z}=Y_{1}^{0},
\end{equation}\]</p><p class="math-container">\[\begin{equation}
d_{yz} \rightarrow p_{x}=\frac{1}{\sqrt{2}}\left(Y_{1}^{-1}-Y_{1}^{1}\right).
\end{equation}\]</p><hr/><p><strong>Complex orbital basis</strong></p><p>It is also called the <span>$|l^2,l_z\rangle$</span> basis. The basis functions are the complex spherical harmonics <span>$Y^{m}_l(\theta,\phi)$</span>. We just use <span>$l$</span> and <span>$m$</span> to label the basis functions <span>$|l,m\rangle$</span>.</p><p>For <span>$p$</span> system (<span>$l = 1,~m = \pm 1,~0$</span>), the basis order is</p><p class="math-container">\[\begin{equation}
\begin{split}
&amp;| 1,   -1, \uparrow \rangle, \\
&amp;| 1, ~~~0, \uparrow \rangle, \\
&amp;| 1, ~~~1, \uparrow \rangle, \\
&amp;| 1,   -1, \downarrow \rangle, \\
&amp;| 1, ~~~0, \downarrow \rangle, \\
&amp;| 1, ~~~1, \downarrow \rangle.
\end{split}
\end{equation}\]</p><p>For <span>$d$</span> system (<span>$l = 2,~m = \pm 2,~\pm 1,~0$</span>), the basis order is</p><p class="math-container">\[\begin{equation}
\begin{split}
&amp;| 2,   -2, \uparrow \rangle, \\
&amp;| 2,   -1, \uparrow \rangle, \\
&amp;| 2, ~~~0, \uparrow \rangle, \\
&amp;| 2, ~~~1, \uparrow \rangle, \\
&amp;| 2, ~~~2, \uparrow \rangle, \\
&amp;| 2,   -2, \downarrow \rangle, \\
&amp;| 2,   -1, \downarrow \rangle, \\
&amp;| 2, ~~~0, \downarrow \rangle, \\
&amp;| 2, ~~~1, \downarrow \rangle, \\
&amp;| 2, ~~~2, \downarrow \rangle.
\end{split}
\end{equation}\]</p><p>For <span>$f$</span> system (<span>$l = 3,~m = \pm 3,~\pm 2,~\pm 1,~0$</span>), the basis order is</p><p class="math-container">\[\begin{equation}
\begin{split}
&amp;| 3,   -3, \uparrow \rangle, \\
&amp;| 3,   -2, \uparrow \rangle, \\
&amp;| 3,   -1, \uparrow \rangle, \\
&amp;| 3, ~~~0, \uparrow \rangle, \\
&amp;| 3, ~~~1, \uparrow \rangle, \\
&amp;| 3, ~~~2, \uparrow \rangle, \\
&amp;| 3, ~~~3, \uparrow \rangle, \\
&amp;| 3,   -3, \downarrow \rangle, \\
&amp;| 3,   -2, \downarrow \rangle, \\
&amp;| 3,   -1, \downarrow \rangle, \\
&amp;| 3, ~~~0, \downarrow \rangle, \\
&amp;| 3, ~~~1, \downarrow \rangle, \\
&amp;| 3, ~~~2, \downarrow \rangle, \\
&amp;| 3, ~~~3, \downarrow \rangle.
\end{split}
\end{equation}\]</p><hr/><p><strong><span>$\hat{j}^{2}-\hat{j}_{z}-\hat{l}^2-\hat{s}^2$</span> diagonal basis</strong></p><p>We just use <span>$j$</span> and <span>$m_j$</span> to label the eigenfunctions <span>$|j, m_j\rangle$</span>, which are just the spinor spherical harmonics <span>$\Omega^l_{jm_j}(\theta,\phi)$</span>.</p><p>For <span>$p$</span> system, <span>$l = 1$</span>, <span>$j = \frac{1}{2}$</span> or <span>$\frac{3}{2}$</span>, the basis order is</p><p class="math-container">\[\begin{equation}
\begin{split}
&amp;\left|\frac{1}{2}, -\frac{1}{2}\right\rangle   = -\sqrt{\frac{2}{3}}Y^{-1}_{1}\chi_{\uparrow} + \sqrt{\frac{1}{3}}Y^{ 0}_{1}\chi_{\downarrow}, \\
&amp;\left|\frac{1}{2}, ~~~\frac{1}{2}\right\rangle = -\sqrt{\frac{1}{3}}Y^{ 0}_{1}\chi_{\uparrow} + \sqrt{\frac{2}{3}}Y^{ 1}_{1}\chi_{\downarrow}, \\
&amp;\left|\frac{3}{2}, -\frac{3}{2}\right\rangle   =  \sqrt{\frac{0}{3}}Y^{-2}_{1}\chi_{\uparrow} + \sqrt{\frac{3}{3}}Y^{-1}_{1}\chi_{\downarrow} = Y^{-1}_{1} \chi_{\downarrow}, \\
&amp;\left|\frac{3}{2}, -\frac{1}{2}\right\rangle   =  \sqrt{\frac{1}{3}}Y^{-1}_{1}\chi_{\uparrow} + \sqrt{\frac{2}{3}}Y^{ 0}_{1}\chi_{\downarrow}, \\
&amp;\left|\frac{3}{2}, ~~~\frac{1}{2}\right\rangle =  \sqrt{\frac{2}{3}}Y^{ 0}_{1}\chi_{\uparrow} + \sqrt{\frac{1}{3}}Y^{ 1}_{1}\chi_{\downarrow}, \\
&amp;\left|\frac{3}{2}, ~~~\frac{3}{2}\right\rangle =  \sqrt{\frac{3}{3}}Y^{ 1}_{1}\chi_{\uparrow} + \sqrt{\frac{0}{3}}Y^{ 2}_{1}\chi_{\downarrow} = Y^{1}_{1}\chi_{\uparrow}.
\end{split}
\end{equation}\]</p><p>For <span>$d$</span> system, <span>$l = 2$</span>, <span>$j = \frac{3}{2}$</span> or <span>$\frac{5}{2}$</span>, the basis order is</p><p class="math-container">\[\begin{equation}
\begin{split}
&amp;\left|\frac{3}{2}, -\frac{3}{2}\right\rangle   = -\sqrt{\frac{4}{5}}Y^{-2}_{2}\chi_{\uparrow} + \sqrt{\frac{1}{5}}Y^{-1}_{2}\chi_{\downarrow}, \\
&amp;\left|\frac{3}{2}, -\frac{1}{2}\right\rangle   = -\sqrt{\frac{3}{5}}Y^{-1}_{2}\chi_{\uparrow} + \sqrt{\frac{2}{5}}Y^{ 0}_{2}\chi_{\downarrow}, \\
&amp;\left|\frac{3}{2}, ~~~\frac{1}{2}\right\rangle = -\sqrt{\frac{2}{5}}Y^{ 0}_{2}\chi_{\uparrow} + \sqrt{\frac{3}{5}}Y^{ 1}_{2}\chi_{\downarrow}, \\
&amp;\left|\frac{3}{2}, ~~~\frac{3}{2}\right\rangle = -\sqrt{\frac{1}{5}}Y^{ 1}_{2}\chi_{\uparrow} + \sqrt{\frac{4}{5}}Y^{ 2}_{2}\chi_{\downarrow}, \\
&amp;\left|\frac{5}{2}, -\frac{5}{2}\right\rangle   =  \sqrt{\frac{0}{5}}Y^{-3}_{2}\chi_{\uparrow} + \sqrt{\frac{5}{5}}Y^{-2}_{2}\chi_{\downarrow} = Y^{-2}_{2}\chi_{\downarrow}, \\
&amp;\left|\frac{5}{2}, -\frac{3}{2}\right\rangle   =  \sqrt{\frac{1}{5}}Y^{-2}_{2}\chi_{\uparrow} + \sqrt{\frac{4}{5}}Y^{-1}_{2}\chi_{\downarrow}, \\
&amp;\left|\frac{5}{2}, -\frac{1}{2}\right\rangle   =  \sqrt{\frac{2}{5}}Y^{-1}_{2}\chi_{\uparrow} + \sqrt{\frac{3}{5}}Y^{ 0}_{2}\chi_{\downarrow}, \\
&amp;\left|\frac{5}{2}, ~~~\frac{1}{2}\right\rangle =  \sqrt{\frac{3}{5}}Y^{ 0}_{2}\chi_{\uparrow} + \sqrt{\frac{2}{5}}Y^{ 1}_{2}\chi_{\downarrow}, \\
&amp;\left|\frac{5}{2}, ~~~\frac{3}{2}\right\rangle =  \sqrt{\frac{4}{5}}Y^{ 1}_{2}\chi_{\uparrow} + \sqrt{\frac{1}{5}}Y^{ 2}_{2}\chi_{\downarrow}, \\
&amp;\left|\frac{5}{2}, ~~~\frac{5}{2}\right\rangle =  \sqrt{\frac{5}{5}}Y^{ 2}_{2}\chi_{\uparrow} + \sqrt{\frac{0}{5}}Y^{ 3}_{2}\chi_{\downarrow} = Y^{2}_{2}\chi_{\uparrow}.
\end{split}
\end{equation}\]</p><p>For <span>$f$</span> system, <span>$l = 3$</span>, <span>$j = \frac{5}{2}$</span> or <span>$\frac{7}{2}$</span>, the basis order is</p><p class="math-container">\[\begin{equation}
\begin{split}
&amp;\left|\frac{5}{2}, -\frac{5}{2}\right\rangle   = -\sqrt{\frac{6}{7}}Y^{-3}_{3}\chi_{\uparrow} + \sqrt{\frac{1}{7}}Y^{-2}_{3}\chi_{\downarrow}, \\
&amp;\left|\frac{5}{2}, -\frac{3}{2}\right\rangle   = -\sqrt{\frac{5}{7}}Y^{-2}_{3}\chi_{\uparrow} + \sqrt{\frac{2}{7}}Y^{-1}_{3}\chi_{\downarrow}, \\
&amp;\left|\frac{5}{2}, -\frac{1}{2}\right\rangle   = -\sqrt{\frac{4}{7}}Y^{-1}_{3}\chi_{\uparrow} + \sqrt{\frac{3}{7}}Y^{ 0}_{3}\chi_{\downarrow}, \\
&amp;\left|\frac{5}{2}, ~~~\frac{1}{2}\right\rangle = -\sqrt{\frac{3}{7}}Y^{ 0}_{3}\chi_{\uparrow} + \sqrt{\frac{4}{7}}Y^{ 1}_{3}\chi_{\downarrow}, \\
&amp;\left|\frac{5}{2}, ~~~\frac{3}{2}\right\rangle = -\sqrt{\frac{2}{7}}Y^{ 1}_{3}\chi_{\uparrow} + \sqrt{\frac{5}{7}}Y^{ 2}_{3}\chi_{\downarrow}, \\
&amp;\left|\frac{5}{2}, ~~~\frac{5}{2}\right\rangle = -\sqrt{\frac{1}{7}}Y^{ 2}_{3}\chi_{\uparrow} + \sqrt{\frac{6}{7}}Y^{ 3}_{3}\chi_{\downarrow}, \\
&amp;\left|\frac{7}{2}, -\frac{7}{2}\right\rangle   =  \sqrt{\frac{0}{7}}Y^{-4}_{3}\chi_{\uparrow} + \sqrt{\frac{7}{7}}Y^{-3}_{3}\chi_{\downarrow} = Y^{-3}_{3}\chi_{\downarrow}, \\
&amp;\left|\frac{7}{2}, -\frac{5}{2}\right\rangle   =  \sqrt{\frac{1}{7}}Y^{-3}_{3}\chi_{\uparrow} + \sqrt{\frac{6}{7}}Y^{-2}_{3}\chi_{\downarrow}, \\
&amp;\left|\frac{7}{2}, -\frac{3}{2}\right\rangle   =  \sqrt{\frac{2}{7}}Y^{-2}_{3}\chi_{\uparrow} + \sqrt{\frac{5}{7}}Y^{-1}_{3}\chi_{\downarrow}, \\
&amp;\left|\frac{7}{2}, -\frac{1}{2}\right\rangle   =  \sqrt{\frac{3}{7}}Y^{-1}_{3}\chi_{\uparrow} + \sqrt{\frac{4}{7}}Y^{ 0}_{3}\chi_{\downarrow}, \\
&amp;\left|\frac{7}{2}, ~~~\frac{1}{2}\right\rangle =  \sqrt{\frac{4}{7}}Y^{ 0}_{3}\chi_{\uparrow} + \sqrt{\frac{3}{7}}Y^{ 1}_{3}\chi_{\downarrow}, \\
&amp;\left|\frac{7}{2}, ~~~\frac{3}{2}\right\rangle =  \sqrt{\frac{5}{7}}Y^{ 1}_{3}\chi_{\uparrow} + \sqrt{\frac{2}{7}}Y^{ 2}_{3}\chi_{\downarrow}, \\
&amp;\left|\frac{7}{2}, ~~~\frac{5}{2}\right\rangle =  \sqrt{\frac{6}{7}}Y^{ 2}_{3}\chi_{\uparrow} + \sqrt{\frac{1}{7}}Y^{ 3}_{3}\chi_{\downarrow}, \\
&amp;\left|\frac{7}{2}, ~~~\frac{7}{2}\right\rangle =  \sqrt{\frac{7}{7}}Y^{ 3}_{3}\chi_{\uparrow} + \sqrt{\frac{0}{7}}Y^{ 4}_{3}\chi_{\downarrow} = Y^{3}_{3}\chi_{\uparrow}. \\
\end{split}
\end{equation}\]</p><hr/><p><strong>Natural basis</strong></p><p>The natural basis is defined as the diagonal basis of on-site term <span>$E_{\alpha\beta}$</span>.</p><hr/><p><strong>Transformation matrix from complex orbital basis to real orbital basis</strong></p><p>For <em>p</em> system, the transformation matrix reads</p><p class="math-container">\[\begin{equation}
T = \left[
\begin{array}{ccc|ccc}
\frac{i}{\sqrt{2}} &amp; 0 &amp; \frac{1}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\frac{i}{\sqrt{2}} &amp; 0 &amp; -\frac{1}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 \\
\hline
0 &amp; 0 &amp; 0 &amp; \frac{i}{\sqrt{2}} &amp; 0 &amp; \frac{1}{\sqrt{2}} \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \frac{i}{\sqrt{2}} &amp; 0 &amp; -\frac{1}{\sqrt{2}} \\
\end{array}
\right]
\end{equation}\]</p><p>For <em>d</em> system, the transformation matrix reads</p><p class="math-container">\[T = \left[
\begin{array}{ccccc|ccccc}
\frac{i}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; \frac{i}{\sqrt{2}} &amp; 0 &amp; \frac{1}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; \frac{i}{\sqrt{2}} &amp; 0 &amp; -\frac{1}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
-\frac{i}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\hline
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{i}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1}{\sqrt{2}} \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{i}{\sqrt{2}} &amp; 0 &amp; \frac{1}{\sqrt{2}} &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{i}{\sqrt{2}} &amp; 0 &amp; -\frac{1}{\sqrt{2}} &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -\frac{i}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1}{\sqrt{2}} \\
\end{array}
\right]\]</p><p>For <em>f</em> system, the transformation matrix reads</p><p class="math-container">\[T= \left[
\begin{array}{ccccccc|ccccccc}
\frac{i}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1}{\sqrt{2}}     &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; \frac{i}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1}{\sqrt{2}} &amp; 0     &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; \frac{i}{\sqrt{2}} &amp; 0 &amp; \frac{1}{\sqrt{2}} &amp; 0 &amp; 0     &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0     &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; \frac{i}{\sqrt{2}} &amp; 0 &amp; -\frac{1}{\sqrt{2}} &amp; 0 &amp; 0     &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; -\frac{i}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1}{\sqrt{2}} &amp; 0     &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\frac{i}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -\frac{1}{\sqrt{2}}     &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\hline
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0     &amp; \frac{i}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1}{\sqrt{2}} \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0     &amp; 0 &amp; \frac{i}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1}{\sqrt{2}} &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0     &amp; 0 &amp; 0 &amp; \frac{i}{\sqrt{2}} &amp; 0 &amp; \frac{1}{\sqrt{2}} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0     &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0     &amp; 0 &amp; 0 &amp; \frac{i}{\sqrt{2}} &amp; 0 &amp; -\frac{1}{\sqrt{2}} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0     &amp; 0 &amp; -\frac{i}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1}{\sqrt{2}} &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0     &amp; \frac{i}{\sqrt{2}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -\frac{1}{\sqrt{2}} \\
\end{array}
\right]\]</p><p>The following Julia script is used to construct the complex orbital basis and the real orbital basis, and the transformation matrix between them.</p><pre><code class="language-julia hljs"># To calculate the transformation matrix from the complex orbital basis
# to the real orbital basis.
function calc_matrix(l::Int64)
    println(&quot;Construct complex orbital basis for 𝑙 = $l&quot;)
    COB = [] # To save the complex orbital basis
    # m = -l, -l+1, ..., l-1, l
    mlist = collect(-l:1:l)
    for s in (&quot;up&quot;, &quot;down&quot;)
        for m in mlist
            push!(COB, [m, s])
        end
    end
    #
    for i in eachindex(COB)
        m = COB[i][1]
        s = COB[i][2] == &quot;up&quot; ? &quot;↑&quot; : &quot;↓&quot;
        println(&quot;$i -&gt; | $l, $m, $s ⟩&quot;)
    end

    println(&quot;Construct real orbital basis for 𝑙 = $l&quot;)
    RO = [] # To save the real orbital basis basis
    ROB = [] # To save the detailed expressions for the real orbital basis
    for s in (&quot;up&quot;, &quot;down&quot;)
        for m in mlist
            if m &lt; 0
                b = [&quot;i/sqrt(2)&quot;, -abs(m), -(-1)^m, abs(m)]
            elseif m == 0
                b = [0]
            elseif m &gt; 0
                b = [&quot;1/sqrt(2)&quot;, -abs(m),  (-1)^m, abs(m)]
            end
            push!(RO, [m,s])
            push!(ROB, b)
        end
    end
    #
    for i in eachindex(RO)
        m = RO[i][1]
        s = RO[i][2] == &quot;up&quot; ? &quot;↑&quot; : &quot;↓&quot;
        println(&quot;$i -&gt; Y_{$l,$m} χ$s&quot;)        
    end

    println(&quot;Evaluate transformation matrix for 𝑙 = $l&quot;)
    for m in eachindex(COB)
        for n in eachindex(RO)
            if COB[m][2] == RO[n][2] # their spins are the same
                # for Y_{l0} case
                if length(ROB[n]) == 1
                    if COB[m][1] == ROB[n][1]
                        println(&quot;T($m,$n) -&gt; 1&quot;)
                    end
                # for Y_{lm} case where m /= 0
                else
                    if COB[m][1] == ROB[n][2]
                        println(&quot;T($m,$n) -&gt; &quot;, ROB[n][1])
                    end
                    if COB[m][1] == ROB[n][4]
                        s = ROB[n][3] &lt; 0 ? &quot;-&quot; : &quot;&quot;
                        println(&quot;T($m,$n) -&gt; $s&quot;, ROB[n][1])
                    end
                end
            end
        end
    end
end</code></pre><hr/><p><strong>Transformation matrix from complex orbital basis to <span>$\hat{j}^{2}-\hat{j}_{z}-\hat{l}^2-\hat{s}^2$</span> diagonal basis</strong></p><p>For <em>p</em> system, the transformation matrix reads</p><p class="math-container">\[\begin{equation}
T = \left[
\begin{array}{ccc|ccc}
-\sqrt{\frac{2}{3}} &amp; 0 &amp; 0 &amp; \sqrt{\frac{1}{3}} &amp; 0 &amp; 0 \\
0 &amp; -\sqrt{\frac{1}{3}} &amp; 0 &amp; 0 &amp; \sqrt{\frac{2}{3}} &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1.0 \\
\hline
0 &amp; 0 &amp; 1.0 &amp; 0 &amp; 0 &amp; 0 \\
\sqrt{\frac{1}{3}} &amp; 0 &amp; 0 &amp; \sqrt{\frac{2}{3}} &amp; 0 &amp; 0 \\
0 &amp; \sqrt{\frac{2}{3}} &amp; 0 &amp; 0 &amp; \sqrt{\frac{1}{3}} &amp; 0 \\
\end{array}
\right]
\end{equation}\]</p><p>For <em>d</em> system, the transformation matrix reads</p><p class="math-container">\[T = \left[
\begin{array}{ccccc|ccccc}
-\sqrt{\frac{4}{5}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{1}{5}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; -\sqrt{\frac{3}{5}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{2}{5}} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; -\sqrt{\frac{2}{5}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{3}{5}} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; -\sqrt{\frac{1}{5}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{4}{5}} &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1.0 \\
\hline
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1.0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\sqrt{\frac{1}{5}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{4}{5}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; \sqrt{\frac{2}{5}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{3}{5}} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; \sqrt{\frac{3}{5}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{2}{5}} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{4}{5}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{1}{5}} &amp; 0 \\
\end{array}
\right]\]</p><p>For <em>f</em> system, the transformation matrix reads</p><p class="math-container">\[T = \left[
\begin{array}{ccccccc|ccccccc}
-\sqrt{\frac{6}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{1}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; -\sqrt{\frac{5}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{2}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; -\sqrt{\frac{4}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{3}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; -\sqrt{\frac{3}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{4}{7}} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; -\sqrt{\frac{2}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{5}{7}} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -\sqrt{\frac{1}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{6}{7}} &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1.0 \\
\hline
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1.0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\sqrt{\frac{1}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{6}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; \sqrt{\frac{2}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{5}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; \sqrt{\frac{3}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{4}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{4}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{3}{7}} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{5}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{2}{7}} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{6}{7}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{\frac{1}{7}} &amp; 0 \\
\end{array}
\right]\]</p><p>The following Julia script is used to construct the complex orbital basis and the <span>$j^2-j_z$</span> basis, and the transformation matrix between them.</p><pre><code class="language-julia hljs"># To calculate the transformation matrix from the complex orbital basis
# to the j²-jz basis.
function calc_matrix(l::Int64)
    println(&quot;Construct complex orbital basis for 𝑙 = $l&quot;)
    COB = [] # To save the complex orbital basis
    # m = -l, -l+1, ..., l-1, l
    mlist = collect(-l:1:l)
    for s in (&quot;up&quot;, &quot;down&quot;)
        for m in mlist
            push!(COB, [m, s])
        end
    end
    #
    for i in eachindex(COB)
        m = COB[i][1]
        s = COB[i][2] == &quot;up&quot; ? &quot;↑&quot; : &quot;↓&quot;
        println(&quot;$i -&gt; | $l, $m, $s ⟩&quot;)
    end

    println(&quot;Construct j²-jz basis for 𝑙 = $l&quot;)
    JJ = []  # To save the j²-jz basis
    JJB = [] # To save the detailed expressions for the j²-jz basis
    jlist = [l-1//2, l+1//2]
    for j in jlist
        # mⱼ = -j, -j+1, ..., j-1, j
        mⱼlist = collect(-j:2//2:j)
        for mⱼ in mⱼlist
            push!(JJ, [j, mⱼ])
            m = mⱼ-1//2
            if j == l-1//2 # For j = l-1/2
                jj = [&quot;-&quot;, (l-m)/(2*l+1), Int(m), (l+m+1)/(2*l+1), Int(m+1)]
            else           # For j = l+1/2
                jj = [&quot;&quot; , (l+m+1)/(2*l+1), Int(m), (l-m)/(2*l+1), Int(m+1)]
            end
            push!(JJB, jj)
        end
    end
    #
    for i in eachindex(JJ)
        j = JJ[i][1]
        mⱼ = JJ[i][2]
        print(&quot;$i -&gt; | $j, $mⱼ ⟩ = &quot;)

        jj = JJB[i]
        print(jj[1])
        print(&quot;sqrt(&quot;, jj[2], &quot;)Y^{&quot;, jj[3],&quot;}_{$l}χ↑ + &quot;)
        print(&quot;sqrt(&quot;, jj[4], &quot;)Y^{&quot;, jj[5],&quot;}_{$l}χ↓\n&quot;)
    end

    println(&quot;Evaluate transformation matrix for 𝑙 = $l&quot;)
    for m in eachindex(COB)
        for n in eachindex(JJ)
            if COB[m][2] == &quot;up&quot;
                if COB[m][1] == JJB[n][3]
                    println(&quot;T($m,$n) -&gt; &quot;, JJB[n][1], &quot;sqrt(&quot;, JJB[n][2],&quot;)&quot;)
                end
            else
                if COB[m][1] == JJB[n][5]
                    println(&quot;T($m,$n) -&gt; &quot;, &quot;sqrt(&quot;, JJB[n][4],&quot;)&quot;)
                end
            end
        end
    end
end</code></pre><hr/><p><strong>Reference</strong></p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>曾谨言, 量子力学（卷1, 第四版）， 科学出版社， 2007。</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>D. A. Varshalovich, A. N. Moskalev, and V. K. Khersonskii, Quantum Theory of Angular Momentum, World Scientific, 1988.</li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a>See https://handwiki.org/wiki/Physics:Spherical_harmonics.</li><li class="footnote" id="footnote-4"><a class="tag is-link" href="#citeref-4">4</a>The orbital orders are consistent with the definition of local basis used by VASP (see https://www.vasp.at/wiki/index.php/LOCPROJ), and the definition in HandWiki (see https://handwiki.org/wiki/Table_of_spherical_harmonics).</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="atomic.html">« Atomic eigenvalue solver</a><a class="docs-footer-nextpage" href="soc.html">Spin-orbit coupling »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 13 March 2025 16:30">Thursday 13 March 2025</span>. Using Julia version 1.11.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
