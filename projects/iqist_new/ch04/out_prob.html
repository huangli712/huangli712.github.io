<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>solver.prob.dat · iQIST</title><meta name="title" content="solver.prob.dat · iQIST"/><meta property="og:title" content="solver.prob.dat · iQIST"/><meta property="twitter:title" content="solver.prob.dat · iQIST"/><meta name="description" content="Documentation for iQIST."/><meta property="og:description" content="Documentation for iQIST."/><meta property="twitter:description" content="Documentation for iQIST."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">iQIST</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><a class="tocitem" href="../team.html">Team</a></li><li><a class="tocitem" href="../copy.html">Copyright</a></li><li><a class="tocitem" href="../thanks.html">Acknowledgements</a></li><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../ch01/what.html">What&#39;s iQIST?</a></li><li><a class="tocitem" href="../ch01/motivation.html">Motivation</a></li><li><a class="tocitem" href="../ch01/components.html">Components</a></li><li><a class="tocitem" href="../ch01/policy.html">Policy</a></li></ul></li><li><span class="tocitem">Installation</span><ul><li><a class="tocitem" href="../ch02/obtain.html">Obtain</a></li><li><a class="tocitem" href="../ch02/uncompress.html">Uncompress</a></li><li><a class="tocitem" href="../ch02/directory.html">Directory structures</a></li><li><a class="tocitem" href="../ch02/envir.html">Compiling environment</a></li><li><a class="tocitem" href="../ch02/system.html">Compiling system</a></li><li><a class="tocitem" href="../ch02/inc.html">Explanation of make.inc</a></li><li><a class="tocitem" href="../ch02/full.html">Build iQIST at one step</a></li><li><input class="collapse-toggle" id="menuitem-6-8" type="checkbox"/><label class="tocitem" for="menuitem-6-8"><span class="docs-label">Build iQIST at multiple steps</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ch02/multi.html">README</a></li><li><a class="tocitem" href="../ch02/solvers.html">Build quantum impurity solvers</a></li><li><a class="tocitem" href="../ch02/atomic.html">Build atomic eigenvalue problem solver</a></li><li><a class="tocitem" href="../ch02/docs.html">Build documentations</a></li></ul></li></ul></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../ch03/config.html">Configure your system</a></li><li><a class="tocitem" href="../ch03/execute.html">Execute the codes</a></li><li><a class="tocitem" href="../ch03/profile.html">Profile the codes</a></li></ul></li><li><span class="tocitem">Quantum impurity solvers</span><ul><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">Standard input files</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="in_ctqmc.html">solver.ctqmc.in</a></li><li><a class="tocitem" href="in_hyb.html">solver.hyb.in</a></li><li><a class="tocitem" href="in_umat.html">solver.umat.in</a></li><li><a class="tocitem" href="in_eimp.html">solver.eimp.in</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox" checked/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Standard output files</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="out_green.html">solver.green.dat</a></li><li><a class="tocitem" href="out_weiss.html">solver.weiss.dat</a></li><li><a class="tocitem" href="out_hybri.html">solver.hybri.dat</a></li><li><a class="tocitem" href="out_grn.html">solver.grn.dat</a></li><li><a class="tocitem" href="out_wss.html">solver.wss.dat</a></li><li><a class="tocitem" href="out_hyb.html">solver.hyb.dat</a></li><li><a class="tocitem" href="out_sgm.html">solver.sgm.dat</a></li><li><a class="tocitem" href="out_hist.html">solver.hist.dat</a></li><li class="is-active"><a class="tocitem" href="out_prob.html">solver.prob.dat</a></li><li><a class="tocitem" href="out_nmat.html">solver.nmat.dat</a></li><li><a class="tocitem" href="out_diag.html">solver.diag.dat</a></li><li><a class="tocitem" href="out_stat.html">solver.status.dat</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Parameters</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="p_isscf.html">isscf</a></li><li><a class="tocitem" href="p_isbnd.html">isbnd</a></li><li><a class="tocitem" href="p_isspn.html">isspn</a></li><li><a class="tocitem" href="p_nband.html">nband</a></li><li><a class="tocitem" href="p_nspin.html">nspin</a></li><li><a class="tocitem" href="p_norbs.html">norbs</a></li><li><a class="tocitem" href="p_ncfgs.html">ncfgs</a></li><li><a class="tocitem" href="p_niter.html">niter</a></li><li><a class="tocitem" href="p_mkink.html">mkink</a></li><li><a class="tocitem" href="p_mfreq.html">mfreq</a></li><li><a class="tocitem" href="p_nffrq.html">nffrq</a></li><li><a class="tocitem" href="p_nbfrq.html">nbfrq</a></li><li><a class="tocitem" href="p_nfreq.html">nfreq</a></li><li><a class="tocitem" href="p_ntime.html">ntime</a></li><li><a class="tocitem" href="p_nflip.html">nflip</a></li><li><a class="tocitem" href="p_ntherm.html">ntherm</a></li><li><a class="tocitem" href="p_nsweep.html">nsweep</a></li><li><a class="tocitem" href="p_nwrite.html">nwrite</a></li><li><a class="tocitem" href="p_nclean.html">nclean</a></li><li><a class="tocitem" href="p_nmonte.html">nmonte</a></li><li><a class="tocitem" href="p_ncarlo.html">ncarlo</a></li><li><a class="tocitem" href="p_u.html">U</a></li><li><a class="tocitem" href="p_uc.html">Uc</a></li><li><a class="tocitem" href="p_uv.html">Uv</a></li><li><a class="tocitem" href="p_jz.html">Jz</a></li><li><a class="tocitem" href="p_js.html">Js</a></li><li><a class="tocitem" href="p_jp.html">Jp</a></li><li><a class="tocitem" href="p_mune.html">mune</a></li><li><a class="tocitem" href="p_beta.html">beta</a></li><li><a class="tocitem" href="p_part.html">part</a></li><li><a class="tocitem" href="p_alpha.html">alpha</a></li></ul></li></ul></li><li><span class="tocitem">Atomic eigenvalue problem solver</span><ul><li><input class="collapse-toggle" id="menuitem-9-1" type="checkbox"/><label class="tocitem" for="menuitem-9-1"><span class="docs-label">Standard input files</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ch05/input.html">README</a></li><li><a class="tocitem" href="../ch05/in_atom.html">atom.config.in</a></li><li><a class="tocitem" href="../ch05/in_cmat.html">atom.cmat.in</a></li><li><a class="tocitem" href="../ch05/in_emat.html">atom.emat.in</a></li><li><a class="tocitem" href="../ch05/in_tmat.html">atom.tmat.in</a></li></ul></li><li><span class="tocitem">Standard output files</span></li><li><input class="collapse-toggle" id="menuitem-9-3" type="checkbox"/><label class="tocitem" for="menuitem-9-3"><span class="docs-label">Parameters</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ch05/parameters.html">README</a></li><li><a class="tocitem" href="../ch05/p_ibasis.html">ibasis</a></li><li><a class="tocitem" href="../ch05/p_ictqmc.html">ictqmc</a></li><li><a class="tocitem" href="../ch05/p_icu.html">icu</a></li><li><a class="tocitem" href="../ch05/p_icf.html">icf</a></li><li><a class="tocitem" href="../ch05/p_isoc.html">isoc</a></li><li><a class="tocitem" href="../ch05/p_nband.html">nband</a></li><li><a class="tocitem" href="../ch05/p_nspin.html">nspin</a></li><li><a class="tocitem" href="../ch05/p_norbs.html">norbs</a></li><li><a class="tocitem" href="../ch05/p_ncfgs.html">ncfgs</a></li><li><a class="tocitem" href="../ch05/p_nmini.html">nmini</a></li><li><a class="tocitem" href="../ch05/p_nmaxi.html">nmaxi</a></li><li><a class="tocitem" href="../ch05/p_uc.html">Uc</a></li><li><a class="tocitem" href="../ch05/p_uv.html">Uv</a></li><li><a class="tocitem" href="../ch05/p_jz.html">Jz</a></li><li><a class="tocitem" href="../ch05/p_js.html">Js</a></li><li><a class="tocitem" href="../ch05/p_jp.html">Jp</a></li><li><a class="tocitem" href="../ch05/p_ud.html">Ud</a></li><li><a class="tocitem" href="../ch05/p_jh.html">Jh</a></li><li><a class="tocitem" href="../ch05/p_mune.html">mune</a></li><li><a class="tocitem" href="../ch05/p_lambda.html">lambda</a></li></ul></li></ul></li><li><span class="tocitem">Auxiliary tools</span><ul><li><input class="collapse-toggle" id="menuitem-10-1" type="checkbox"/><label class="tocitem" for="menuitem-10-1"><span class="docs-label">Scripts</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ch06/movie.html">u_movie.py</a></li><li><a class="tocitem" href="../ch06/atomic.html">u_atomic.py</a></li><li><a class="tocitem" href="../ch06/ctqmc.html">u_ctqmc.py</a></li><li><a class="tocitem" href="../ch06/reader.html">u_reader.py</a></li><li><a class="tocitem" href="../ch06/writer.html">u_writer.py</a></li></ul></li></ul></li><li><span class="tocitem">iQIST in action</span><ul><li><a class="tocitem" href="../ch07/story.html">Successful stories</a></li></ul></li><li><span class="tocitem">Inside iQIST</span><ul><li><input class="collapse-toggle" id="menuitem-12-1" type="checkbox"/><label class="tocitem" for="menuitem-12-1"><span class="docs-label">Basic theory and methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ch08/basic.html">Outline</a></li><li><a class="tocitem" href="../ch08/qim.html">Quantum impurity model</a></li><li><a class="tocitem" href="../ch08/ct.html">Principles of continuous-time quantum Monte Carlo algorithm</a></li><li><a class="tocitem" href="../ch08/hyb.html">Hybridization expansion</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-12-2" type="checkbox"/><label class="tocitem" for="menuitem-12-2"><span class="docs-label">Algorithms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ch08/sig.html">Improved estimator for the self-energy function</a></li><li><a class="tocitem" href="../ch08/truncation.html">Truncation approximation</a></li><li><a class="tocitem" href="../ch08/lazy.html">Lazy trace evaluation</a></li><li><a class="tocitem" href="../ch08/rng.html">Random number generator</a></li><li><a class="tocitem" href="../ch08/atomic.html">Atomic eigenvalue solver</a></li><li><a class="tocitem" href="../ch08/basis.html">Single particle basis</a></li><li><a class="tocitem" href="../ch08/soc.html">Spin-orbit coupling</a></li><li><a class="tocitem" href="../ch08/coulomb.html">Coulomb interaction matrix</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-12-3" type="checkbox"/><label class="tocitem" for="menuitem-12-3"><span class="docs-label">Codes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ch08/platform.html">Development platform</a></li></ul></li></ul></li><li><a class="tocitem" href="../glossary.html">Glossary</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quantum impurity solvers</a></li><li><a class="is-disabled">Standard output files</a></li><li class="is-active"><a href="out_prob.html">solver.prob.dat</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="out_prob.html">solver.prob.dat</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/huangli712/iQIST" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="solver.prob.dat"><a class="docs-heading-anchor" href="#solver.prob.dat">solver.prob.dat</a><a id="solver.prob.dat-1"></a><a class="docs-heading-anchor-permalink" href="#solver.prob.dat" title="Permalink"></a></h1><p><strong>Introduction</strong></p><p>The <em>solver.prob.dat</em> file is used to store the atomic state probability and related information about the quantum impurity solvers. It will be output by the quantum impurity solvers when they are <strong>shut down</strong>. We can use the data in it to analyze the valence fluctuation.</p><p><strong>Format</strong></p><p>The format of the <em>solver.prob.dat</em> file is somewhat complex. It contains three blocks. They show the probabilities for atomic states, orbitals, and spins, respectively. In the first block, the fifth column is used to represent the error bar.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For the <strong>MANJUSHAKA</strong> component, there is an additional block for showing the probabilities for sectors/superstates.</p></div></div><p><strong>Code</strong></p><p>The corresponding Fortran code block for the writing of <em>solver.prob.dat</em> file is as follows:</p><pre><code class="language-fortran hljs">! open data file: solver.prob.dat
open(mytmp, file=&#39;solver.prob.dat&#39;, form=&#39;formatted&#39;, status=&#39;unknown&#39;)

! write it
write(mytmp,&#39;(a)&#39;) &#39;# state probability: index | prob | occupy | spin&#39;
do i=1,ncfgs
    write(mytmp,&#39;(i6,4f12.6)&#39;) i, prob(i), noccs(i), soccs(i) * half, perr(i)
enddo ! over i={1,ncfgs} loop

write(mytmp,&#39;(a)&#39;) &#39;# orbital probability: index | occupy | prob&#39;
do i=0,norbs
    write(mytmp,&#39;(i6,3f12.6)&#39;) i + 1, real(i), oprob(i), operr(i)
enddo ! over i={0,norbs} loop
write(mytmp,&#39;(a6,12X,f12.6)&#39;) &#39;sum&#39;, sum(oprob)

write(mytmp,&#39;(a)&#39;) &#39;# spin probability: index | spin | prob&#39;
do i=-nband,nband
    write(mytmp,&#39;(i6,3f12.6)&#39;) i + nband + 1, i * half, sprob(i), sperr(i)
enddo ! over i={-nband,nband} loop
write(mytmp,&#39;(a6,12X,f12.6)&#39;) &#39;sum&#39;, sum(sprob)

! close data file
close(mytmp)</code></pre><p>Now we provide a Python module to read the output files of quantum impurity solvers. You can use it to read the <em>solver.prob.dat</em> file. See <a href="../ch06/reader.html">script/u_reader.py</a> for more details.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="out_hist.html">« solver.hist.dat</a><a class="docs-footer-nextpage" href="out_nmat.html">solver.nmat.dat »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.0 on <span class="colophon-date" title="Friday 21 June 2024 16:31">Friday 21 June 2024</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
