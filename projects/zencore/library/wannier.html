<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Wannier Function · ZenCore</title><meta name="title" content="Wannier Function · ZenCore"/><meta property="og:title" content="Wannier Function · ZenCore"/><meta property="twitter:title" content="Wannier Function · ZenCore"/><meta name="description" content="Documentation for ZenCore."/><meta property="og:description" content="Documentation for ZenCore."/><meta property="twitter:description" content="Documentation for ZenCore."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/zencore.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">ZenCore</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><a class="tocitem" href="../intro.html">Introduction</a></li><li><a class="tocitem" href="../install.html">Installation</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Inside The Library</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="outline.html">Outline</a></li><li><a class="tocitem" href="zencore.html">ZenCore</a></li><li><a class="tocitem" href="global.html">Global Constants</a></li><li><a class="tocitem" href="util.html">Utilities</a></li><li><a class="tocitem" href="tetra.html">Tetrahedron Integration</a></li><li><a class="tocitem" href="types.html">Types</a></li><li><a class="tocitem" href="config.html">Configuration</a></li><li><a class="tocitem" href="base.html">Workflow</a></li><li><a class="tocitem" href="vasp.html">Vienna Ab initio Simulation Package</a></li><li><a class="tocitem" href="qe.html">Quantum ESPRESSO</a></li><li><a class="tocitem" href="plo.html">Projected Local Orbital</a></li><li class="is-active"><a class="tocitem" href="wannier.html">Wannier Function</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li></ul></li><li><a class="tocitem" href="ir.html">Intermediate Representation</a></li><li><a class="tocitem" href="dmft.html">Dynamical Mean-Field Theory</a></li><li><a class="tocitem" href="solver.html">Quantum Impurity Solver</a></li><li><a class="tocitem" href="sigma.html">Self-Energy Function</a></li><li><a class="tocitem" href="mixing.html">Mixing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Inside The Library</a></li><li class="is-active"><a href="wannier.html">Wannier Function</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="wannier.html">Wannier Function</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/huangli712/ZenCore" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Wannier-Functions"><a class="docs-heading-anchor" href="#Wannier-Functions">Wannier Functions</a><a id="Wannier-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Wannier-Functions" title="Permalink"></a></h1><p><em>Tools for the projection on wannier functions scheme (adaptor).</em></p><p><em>Source: wannier.jl</em></p><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="wannier.html#Wannier-Functions">Wannier Functions</a></li><li class="no-marker"><ul><li><a href="wannier.html#Contents">Contents</a></li><li><a href="wannier.html#Index">Index</a></li><li><a href="wannier.html#Functions">Functions</a></li></ul></li></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="wannier.html#ZenCore.adaptor_call-Tuple{WANNIERAdaptor, Dict{Symbol, Any}, Vector{Impurity}}"><code>ZenCore.adaptor_call</code></a></li><li><a href="wannier.html#ZenCore.pw2wan_exec"><code>ZenCore.pw2wan_exec</code></a></li><li><a href="wannier.html#ZenCore.pw2wan_init"><code>ZenCore.pw2wan_init</code></a></li><li><a href="wannier.html#ZenCore.pw2wan_save"><code>ZenCore.pw2wan_save</code></a></li><li><a href="wannier.html#ZenCore.w90_diag_hamk"><code>ZenCore.w90_diag_hamk</code></a></li><li><a href="wannier.html#ZenCore.w90_find_bwin"><code>ZenCore.w90_find_bwin</code></a></li><li><a href="wannier.html#ZenCore.w90_make_chipsi"><code>ZenCore.w90_make_chipsi</code></a></li><li><a href="wannier.html#ZenCore.w90_make_ctrl"><code>ZenCore.w90_make_ctrl</code></a></li><li><a href="wannier.html#ZenCore.w90_make_group"><code>ZenCore.w90_make_group</code></a></li><li><a href="wannier.html#ZenCore.w90_make_hamk"><code>ZenCore.w90_make_hamk</code></a></li><li><a href="wannier.html#ZenCore.w90_make_hamr"><code>ZenCore.w90_make_hamr</code></a></li><li><a href="wannier.html#ZenCore.w90_make_kpath"><code>ZenCore.w90_make_kpath</code></a></li><li><a href="wannier.html#ZenCore.w90_make_map"><code>ZenCore.w90_make_map</code></a></li><li><a href="wannier.html#ZenCore.w90_make_proj"><code>ZenCore.w90_make_proj</code></a></li><li><a href="wannier.html#ZenCore.w90_make_rcell"><code>ZenCore.w90_make_rcell</code></a></li><li><a href="wannier.html#ZenCore.w90_make_window"><code>ZenCore.w90_make_window</code></a></li><li><a href="wannier.html#ZenCore.w90_read_amat"><code>ZenCore.w90_read_amat</code></a></li><li><a href="wannier.html#ZenCore.w90_read_eigs"><code>ZenCore.w90_read_eigs</code></a></li><li><a href="wannier.html#ZenCore.w90_read_hamr"><code>ZenCore.w90_read_hamr</code></a></li><li><a href="wannier.html#ZenCore.w90_read_udis"><code>ZenCore.w90_read_udis</code></a></li><li><a href="wannier.html#ZenCore.w90_read_umat"><code>ZenCore.w90_read_umat</code></a></li><li><a href="wannier.html#ZenCore.w90_read_wout"><code>ZenCore.w90_read_wout</code></a></li><li><a href="wannier.html#ZenCore.w90_write_win"><code>ZenCore.w90_write_win</code></a></li><li><a href="wannier.html#ZenCore.wannier_adaptor"><code>ZenCore.wannier_adaptor</code></a></li><li><a href="wannier.html#ZenCore.wannier_exec"><code>ZenCore.wannier_exec</code></a></li><li><a href="wannier.html#ZenCore.wannier_init"><code>ZenCore.wannier_init</code></a></li><li><a href="wannier.html#ZenCore.wannier_save"><code>ZenCore.wannier_save</code></a></li></ul><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.adaptor_call-Tuple{WANNIERAdaptor, Dict{Symbol, Any}, Vector{Impurity}}" href="#ZenCore.adaptor_call-Tuple{WANNIERAdaptor, Dict{Symbol, Any}, Vector{Impurity}}"><code>ZenCore.adaptor_call</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">adaptor_call(::WANNIERAdaptor,
             D::Dict{Symbol,Any},
             ai::Array{Impurity,1})</code></pre><p>It is a dispatcher for the DFT-DMFT adaptor. It calls <code>wannier_adaptor()</code> function to deal with the outputs of <code>wannier90</code> code and generate key dataset for the IR adaptor. Note that similar functions are also defined in <code>vasp.jl</code>, <code>qe.jl</code>, and <code>plo.jl</code>.</p><p>See also: <a href="wannier.html#ZenCore.wannier_adaptor"><code>wannier_adaptor</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.wannier_adaptor" href="#ZenCore.wannier_adaptor"><code>ZenCore.wannier_adaptor</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wannier_adaptor(D::Dict{Symbol,Any}, ai::Array{Impurity,1})</code></pre><p>Adaptor support. It will read and parse the outputs of the <code>wannier90</code> code, convert the data into IR format. The data contained in <code>D</code> dict will be updated.</p><p>Be careful, now this adaptor only supports <code>quantum espresso</code> (<code>pwscf</code>).</p><p>See also: <a href="qe.html#ZenCore.qe_adaptor"><code>qe_adaptor</code></a>, <a href="ir.html#ZenCore.ir_adaptor"><code>ir_adaptor</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.wannier_init" href="#ZenCore.wannier_init"><code>ZenCore.wannier_init</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wannier_init(D::Dict{Symbol,Any}, sp::String = &quot;&quot;)</code></pre><p>Try to generate the <code>w90.win</code> file, which is the essential input for the <code>wannier90</code> code. Here, we always use <code>w90</code> as the seedname. If the system is spin polarized (the argument <code>sp</code> is <code>up</code> or <code>dn</code>), then the seednames will be <code>w90up</code> and <code>w90dn</code>, respectively.</p><p>See also: <a href="wannier.html#ZenCore.wannier_exec"><code>wannier_exec</code></a>, <a href="wannier.html#ZenCore.wannier_save"><code>wannier_save</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.wannier_exec" href="#ZenCore.wannier_exec"><code>ZenCore.wannier_exec</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wannier_exec(sp::String = &quot;&quot;; op::String = &quot;&quot;)</code></pre><p>Execute the wannier90 program, monitor the convergence progress, and output the relevant information. The argument <code>sp</code> denotes the spin component, while <code>op</code> specifies the running mode for wannier90. If <code>op == -pp</code>, the wannier90 code will try to generate the <code>w90.nnkp</code>.</p><p>See also: <a href="wannier.html#ZenCore.wannier_init"><code>wannier_init</code></a>, <a href="wannier.html#ZenCore.wannier_save"><code>wannier_save</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.wannier_save" href="#ZenCore.wannier_save"><code>ZenCore.wannier_save</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wannier_save(sp::String = &quot;&quot;; op::String = &quot;&quot;)</code></pre><p>Backup and check the output files of wannier90 if necessary. Actually, there are no files that need to be stored. We just check whether they have been created correctly.</p><p>See also: <a href="wannier.html#ZenCore.wannier_init"><code>wannier_init</code></a>, <a href="wannier.html#ZenCore.wannier_exec"><code>wannier_exec</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_make_ctrl" href="#ZenCore.w90_make_ctrl"><code>ZenCore.w90_make_ctrl</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_make_ctrl(latt:Lattice, nband::I64, fermi::F64)</code></pre><p>Try to make the control parameters for the <code>w90.win</code> file. The <code>latt</code> object represent the crystallography information, and <code>nband</code> is the total number of Kohn-Sham states outputed by the DFT code, <code>fermi</code> is the fermi level. This function is called by <code>wannier_init()</code>.</p><p>See also: <a href="wannier.html#ZenCore.w90_make_proj"><code>w90_make_proj</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_make_proj" href="#ZenCore.w90_make_proj"><code>ZenCore.w90_make_proj</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_make_proj()</code></pre><p>Try to make the projection block for the <code>w90.win</code> file. We will not check the validness of these projections here. This function is called by the <code>wannier_init()</code> function.</p><p>See also: <a href="wannier.html#ZenCore.w90_make_ctrl"><code>w90_make_ctrl</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_make_map" href="#ZenCore.w90_make_map"><code>ZenCore.w90_make_map</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_make_map(PG::Array{PrGroup,1}, ai::Array{Impurity,1})</code></pre><p>Create connections / mappings between projectors (or band windows) and quantum impurity problems. Return a <code>Mapping</code> struct. This function is just a copy of the <code>plo_map()</code> function.</p><p>See also: <a href="types.html#ZenCore.PrGroup"><code>PrGroup</code></a>, <a href="types.html#ZenCore.PrWindow"><code>PrWindow</code></a>, <a href="types.html#ZenCore.Mapping"><code>Mapping</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_make_group" href="#ZenCore.w90_make_group"><code>ZenCore.w90_make_group</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_make_group(latt::Lattice, sp::String = &quot;&quot;)</code></pre><p>Try to read the <code>w90.nnkp</code> file, parse the <code>projections</code> block. Finally, it will return arrays of PrTrait and PrGroup objects, which contain the definitions of projectors. The argument <code>latt</code> is essential. It includes the atomic coordinates for all lattice sites, which are quite useful to distinguish these projectors. And the argument <code>sp</code> is optional. It is used when the system is spin-polarized.</p><p>See also: <a href="types.html#ZenCore.PrTrait"><code>PrTrait</code></a>, <a href="types.html#ZenCore.PrGroup"><code>PrGroup</code></a>.</p></div></section><section><div><pre><code class="language-julia hljs">w90_make_group(MAP::Mapping, PG::Array{PrGroup,1})</code></pre><p>Use the information contained in the <code>Mapping</code> struct to further setup the <code>PrGroup</code> struct. This function is just a copy of the <code>plo_group()</code> function.</p><p>See also: <a href="types.html#ZenCore.PIMP"><code>PIMP</code></a>, <a href="types.html#ZenCore.Mapping"><code>Mapping</code></a>, <a href="types.html#ZenCore.PrGroup"><code>PrGroup</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_make_window" href="#ZenCore.w90_make_window"><code>ZenCore.w90_make_window</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_make_window(PG::Array{PrGroup,1}, enk::Array{F64,3})</code></pre><p>Make band window to filter the projections. Actually, all of the Kohn-Sham eigenvalues are retained, so the band window is always <code>[1, nband]</code>. This function will return an array of <code>PrWindow</code> struct.</p><p>See also: <a href="types.html#ZenCore.PrWindow"><code>PrWindow</code></a>.</p></div></section><section><div><pre><code class="language-julia hljs">w90_make_window(PG::Array{PrGroup,1},
                ewin::Tuple{F64,F64},
                bwin::Array{I64,2})</code></pre><p>Make band window to filter the projections. Actually, only those relevant bands (which are restricted by the energy window <code>ewin</code> or the band window <code>bwin</code>) are retained. This function will return an array of <code>PrWindow</code> struct. Be careful, <code>ewin</code> must be consistent with <code>bwin</code> (please check <code>w90_find_bwin()</code> for more details).</p><p>See also: <a href="types.html#ZenCore.PrWindow"><code>PrWindow</code></a>.</p></div></section><section><div><pre><code class="language-julia hljs">w90_make_window(PWup::Array{PrWindow,1}, PWdn::Array{PrWindow,1})</code></pre><p>Try to merge two arrays of <code>PrWindow</code> struct and generate a new one. Actually, the new array is similar to the olds. We only modify one of its members, <code>kwin</code>.</p><p>See also: <a href="types.html#ZenCore.PrWindow"><code>PrWindow</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_make_chipsi" href="#ZenCore.w90_make_chipsi"><code>ZenCore.w90_make_chipsi</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_make_chipsi(umat::Array{C64,3}, udis::Array{C64,3})</code></pre><p>Try to merge the transform matrix <code>umat</code> with the disentanglement matrix <code>udis</code> to construct the final projection matrix <code>chipsi</code>, which actually is the overlap matrix between the wannier functions and the Kohn-Sham wave functions.</p><p>See also: <a href="wannier.html#ZenCore.w90_read_umat"><code>w90_read_umat</code></a>, <a href="wannier.html#ZenCore.w90_read_udis"><code>w90_read_udis</code></a>.</p></div></section><section><div><pre><code class="language-julia hljs">w90_make_chipsi(PG::Array{PrGroup,1}, chipsi::Array{C64,4})</code></pre><p>Perform global rotations or transformations for the projectors. In this function, the projectors will be classified into different groups, and then they will be rotated group by group. This function is just a copy of the <code>plo_rotate()</code> function.</p><p>See also: <a href="types.html#ZenCore.PrGroup"><code>PrGroup</code></a>, <a href="plo.html#ZenCore.plo_rotate"><code>plo_rotate</code></a>.</p></div></section><section><div><pre><code class="language-julia hljs">w90_make_chipsi(PW::Array{PrWindow,1}, chipsi::Array{Array{C64,4},1}}</code></pre><p>Filter the projector matrix according to band window. This function is just a copy of the <code>plo_filter()</code> function.</p><p>See also: <a href="types.html#ZenCore.PrWindow"><code>PrWindow</code></a>, <a href="plo.html#ZenCore.plo_filter"><code>plo_filter</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_make_kpath" href="#ZenCore.w90_make_kpath"><code>ZenCore.w90_make_kpath</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_make_kpath(ndiv::I64,
               kstart::Array{F64,2},
               kend::Array{F64,2})</code></pre><p>Try to generate 𝑘-path along the selected high-symmetry directions in the Brillouin zone. The argument <code>ndiv</code> means the number of divisions for each 𝑘-path. While <code>kstart</code> and <code>kend</code> denote the 𝑘 coordinates for the starting and ending points of the 𝑘-path, respectively. Note that this function is used to perform wannier band interpolation.</p><p>See also: <a href="wannier.html#ZenCore.w90_make_rcell"><code>w90_make_rcell</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_make_rcell" href="#ZenCore.w90_make_rcell"><code>ZenCore.w90_make_rcell</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_make_rcell(latt::Lattice)</code></pre><p>Calculates a grid of points that fall inside of (and eventually on the surface of) the Wigner-Seitz supercell centered on the origin of the given lattice (<code>latt</code>).</p><p>See also: <a href="wannier.html#ZenCore.w90_make_kpath"><code>w90_make_kpath</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_make_hamr" href="#ZenCore.w90_make_hamr"><code>ZenCore.w90_make_hamr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_make_hamr(kvec::Array{F64,2},
              rvec::Array{I64,2},
              hamk::Array{C64,3})</code></pre><p>Convert the hamiltonian from 𝑘-space to 𝑟-space via the fast fourier transformation. The arguments <code>kvec</code> and <code>rvec</code> define the 𝑘-mesh and 𝑟-mesh, respectively. <code>hamk</code> means <span>$H(K)$</span> which should be defined in a uniform 𝑘-mesh.</p><p>See also: <a href="wannier.html#ZenCore.w90_make_hamk"><code>w90_make_hamk</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_make_hamk" href="#ZenCore.w90_make_hamk"><code>ZenCore.w90_make_hamk</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_make_hamk(kvec::Array{F64,2},
              rdeg::Array{I64,1},
              rvec::Array{I64,2},
              hamr::Array{C64,3})</code></pre><p>Convert the hamiltonian from 𝑟-space to 𝑘-space via the fast fourier transformation. The arguments <code>kvec</code> and <code>rvec</code> define the 𝑘-mesh and 𝑟-mesh, respectively. <code>hamr</code> means <span>$H(R)$</span> which should be defined in a Wigner-Seitz cell.</p><p>See also: <a href="wannier.html#ZenCore.w90_make_hamr"><code>w90_make_hamr</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_diag_hamk" href="#ZenCore.w90_diag_hamk"><code>ZenCore.w90_diag_hamk</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_diag_hamk(hamk::Array{C64,3})</code></pre><p>Diagonalize the hamiltonian to give band structure.</p><p>See also: <a href="wannier.html#ZenCore.w90_make_hamk"><code>w90_make_hamk</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_find_bwin" href="#ZenCore.w90_find_bwin"><code>ZenCore.w90_find_bwin</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_find_bwin(ewin::Tuple{F64,F64}, enk::Array{F64,3})</code></pre><p>During the disentanglement procedure, we can define an outer energy window to restrict the Kohn-Sham eigenvalues. This function will return the corresponding band window, which will be used to displace the disentanglement matrix. Here, <code>ewin</code> is the outer energy window which is extracted from <code>w90.wout</code>, and <code>enk</code> is the Kohn-Sham eigenvalues.</p><p>This function works for spin-unpolarized case only.</p><p>See also: <a href="wannier.html#ZenCore.w90_read_udis"><code>w90_read_udis</code></a>, <a href="wannier.html#ZenCore.w90_read_wout"><code>w90_read_wout</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_read_amat" href="#ZenCore.w90_read_amat"><code>ZenCore.w90_read_amat</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_read_amat(sp::String = &quot;&quot;)</code></pre><p>Try to read and parse the <code>w90.amn</code> file to get the <span>$A_{mn}$</span> matrix, which represents the projection of the Bloch states onto trail localized orbitals. The argument <code>sp</code> denotes the spin component.</p><p>Note that this function has not been used so far.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_read_eigs" href="#ZenCore.w90_read_eigs"><code>ZenCore.w90_read_eigs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_read_eigs(sp::String = &quot;&quot;)</code></pre><p>Try to read and parse the <code>w90.eig</code> file to get the band eigenvalues. Note that the eigenvalues from <code>nscf.out</code> are not accurate enough. We will use the data extracted from <code>w90.eig</code> to update them. The argument <code>sp</code> denotes the spin component.</p><p>See also: <a href="qe.html#ZenCore.qeio_eigen"><code>qeio_eigen</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_read_hamr" href="#ZenCore.w90_read_hamr"><code>ZenCore.w90_read_hamr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_read_hamr(f::String, sp::String = &quot;&quot;)</code></pre><p>Try to read and parse the <code>w90_hr.dat</code> file, return the hamiltonian matrix in WF representation, the Wigner-Seitz grid points, and their weights (degeneracies). The argument <code>sp</code> denotes the spin component. The data return by this function can be used to validate the projection matrix further.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_read_umat" href="#ZenCore.w90_read_umat"><code>ZenCore.w90_read_umat</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_read_umat(sp::String = &quot;&quot;)</code></pre><p>Try to read and parse the <code>w90_u.mat</code> file, return the u-matrix, which gives the unitary rotations from the optimal subspace to the optimally smooth states. The argument <code>sp</code> denotes the spin component.</p><p>See also: <a href="wannier.html#ZenCore.w90_read_udis"><code>w90_read_udis</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_read_udis" href="#ZenCore.w90_read_udis"><code>ZenCore.w90_read_udis</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_read_udis(bwin::Array{I64,2}, sp::String = &quot;&quot;)</code></pre><p>Try to read and parse the <code>w90_u_dis.mat</code> file. Return the udis-matrix, which gives the <code>nproj</code> dimension optimal subspace from the original bloch states. Actually, it is the transform matrix for disentanglement. The argument <code>sp</code> denotes the spin component, the band window <code>bwin</code> is from <code>w90_make_window()</code> and <code>w90_read_wout()</code>.</p><p>See also: <a href="wannier.html#ZenCore.w90_read_umat"><code>w90_read_umat</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_read_wout" href="#ZenCore.w90_read_wout"><code>ZenCore.w90_read_wout</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_read_wout(sp::String = &quot;&quot;)</code></pre><p>Try to read and parse the <code>w90.wout</code> file. Return the energy window for disentanglement procedure. The argument <code>sp</code> denotes the spin component.</p><p>See also: <a href="wannier.html#ZenCore.w90_make_window"><code>w90_make_window</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.w90_write_win" href="#ZenCore.w90_write_win"><code>ZenCore.w90_write_win</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">w90_write_win(io::IOStream, w90c::Dict{String,Any})</code></pre><p>Write control parameters into <code>w90.win</code>.</p><p>See also: <a href="wannier.html#ZenCore.wannier_init"><code>wannier_init</code></a>.</p></div></section><section><div><pre><code class="language-julia hljs">w90_write_win(io::IOStream, proj::Array{String,1})</code></pre><p>Write projection block into <code>w90.win</code>.</p><p>See also: <a href="wannier.html#ZenCore.wannier_init"><code>wannier_init</code></a>.</p></div></section><section><div><pre><code class="language-julia hljs">w90_write_win(io::IOStream, latt::Lattice)</code></pre><p>Write crystallography information into <code>w90.win</code>.</p><p>See also: <a href="types.html#ZenCore.Lattice"><code>Lattice</code></a>, <a href="wannier.html#ZenCore.wannier_init"><code>wannier_init</code></a>.</p></div></section><section><div><pre><code class="language-julia hljs">w90_write_win(io::IOStream, kmesh::Array{F64,2})</code></pre><p>Write 𝑘-mesh block into <code>w90.win</code>.</p><p>See also: <a href="wannier.html#ZenCore.wannier_init"><code>wannier_init</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.pw2wan_init" href="#ZenCore.pw2wan_init"><code>ZenCore.pw2wan_init</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pw2wan_init(case::String, sp::String = &quot;&quot;)</code></pre><p>Check the runtime environment of <code>pw2wannier90</code>, prepare necessary input files (it is <code>case.pw2wan</code>). The argument <code>case</code> means the prefix for <code>quantum espresso</code>, and <code>sp</code> determines the spin component which can be empty string, <code>up</code>, or <code>dn</code>.</p><p>See also: <a href="wannier.html#ZenCore.pw2wan_exec"><code>pw2wan_exec</code></a>, <a href="wannier.html#ZenCore.pw2wan_save"><code>pw2wan_save</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.pw2wan_exec" href="#ZenCore.pw2wan_exec"><code>ZenCore.pw2wan_exec</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pw2wan_exec(case::String, sp::String = &quot;&quot;)</code></pre><p>Execute the pw2wannier90 program, monitor the convergence progress, and output the relevant information. Here, <code>case</code> means the prefix for input files, and <code>sp</code> is <code>up</code> or <code>dn</code>.</p><p>See also: <a href="wannier.html#ZenCore.pw2wan_init"><code>pw2wan_init</code></a>, <a href="wannier.html#ZenCore.pw2wan_save"><code>pw2wan_save</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ZenCore.pw2wan_save" href="#ZenCore.pw2wan_save"><code>ZenCore.pw2wan_save</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pw2wan_save(sp::String = &quot;&quot;)</code></pre><p>Backup and check the output files of the <code>pw2wannier90</code> code if necessary. The argument <code>sp</code> specifies the spin component. It could be empty string, <code>up</code>, or <code>dn</code>.</p><p>See also: <a href="wannier.html#ZenCore.pw2wan_init"><code>pw2wan_init</code></a>, <a href="wannier.html#ZenCore.pw2wan_exec"><code>pw2wan_exec</code></a>.</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="plo.html">« Projected Local Orbital</a><a class="docs-footer-nextpage" href="ir.html">Intermediate Representation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Saturday 10 May 2025 00:50">Saturday 10 May 2025</span>. Using Julia version 1.11.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
