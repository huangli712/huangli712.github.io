<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Stochastic Optimization Method · ACFlow: The User Guide</title><meta name="title" content="Stochastic Optimization Method · ACFlow: The User Guide"/><meta property="og:title" content="Stochastic Optimization Method · ACFlow: The User Guide"/><meta property="twitter:title" content="Stochastic Optimization Method · ACFlow: The User Guide"/><meta name="description" content="Documentation for ACFlow: The User Guide."/><meta property="og:description" content="Documentation for ACFlow: The User Guide."/><meta property="twitter:description" content="Documentation for ACFlow: The User Guide."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/acflow.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="ACFlow: The User Guide logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">ACFlow: The User Guide</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Welcome</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Introduction</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro/acp.html">Analytic Continuation</a></li><li><a class="tocitem" href="../intro/motivation.html">Motivation</a></li><li><a class="tocitem" href="../intro/ack.html">Acknowledgements</a></li><li><a class="tocitem" href="../intro/cite.html">Citation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../man/feature.html">Main Features</a></li><li><a class="tocitem" href="../man/impl.html">Implementations</a></li><li><a class="tocitem" href="../man/install.html">Installation</a></li><li><a class="tocitem" href="../man/run.html">Running Modes</a></li><li><a class="tocitem" href="../man/input.html">Input Files</a></li><li><a class="tocitem" href="../man/output.html">Output Files</a></li><li><a class="tocitem" href="../man/param.html">Parameters</a></li><li><a class="tocitem" href="../man/tricks.html">Tricks and Tips</a></li><li><a class="tocitem" href="../man/gui.html">Graphic User Interface</a></li><li><a class="tocitem" href="../man/test.html">Benchmark Tools</a></li><li><a class="tocitem" href="../man/performance.html">Performance</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/sigma.html">Matsubara Self-Energy Function</a></li><li><a class="tocitem" href="../examples/green1.html">Matsubara Green&#39;s Function</a></li><li><a class="tocitem" href="../examples/green2.html">Imaginary Time Green&#39;s Function</a></li><li><a class="tocitem" href="../examples/current.html">Current-Current Correlation Function</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">Theory</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="basic.html">Basic Principles</a></li><li><a class="tocitem" href="maxent.html">Maximum Entropy Method</a></li><li><a class="tocitem" href="rfa.html">Barycentric Rational Function</a></li><li><a class="tocitem" href="nac.html">Nevanlinna Analytical Continuation</a></li><li><a class="tocitem" href="sac1.html">Stochastic Analytic Continuation 1</a></li><li><a class="tocitem" href="sac2.html">Stochastic Analytic Continuation 2</a></li><li class="is-active"><a class="tocitem" href="som.html">Stochastic Optimization Method</a><ul class="internal"><li><a class="tocitem" href="#som"><span>Deviation Function</span></a></li><li><a class="tocitem" href="#Spectral-Density"><span>Spectral Density</span></a></li><li><a class="tocitem" href="#Rectangle-Representation"><span>Rectangle Representation</span></a></li><li><a class="tocitem" href="#Monte-Carlo-Sampling"><span>Monte Carlo Sampling</span></a></li><li><a class="tocitem" href="#Relevant-Parameters"><span>Relevant Parameters</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="spx.html">Stochastic Pole Expansion</a></li><li><a class="tocitem" href="reference.html">References</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Library</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../library/outline.html">Outline</a></li><li><a class="tocitem" href="../library/acflow.html">ACFlow</a></li><li><a class="tocitem" href="../library/global.html">Constants</a></li><li><a class="tocitem" href="../library/type.html">Types</a></li><li><a class="tocitem" href="../library/base.html">Core</a></li><li><a class="tocitem" href="../library/solver.html">Solvers</a></li><li><a class="tocitem" href="../library/grid.html">Grids</a></li><li><a class="tocitem" href="../library/mesh.html">Meshes</a></li><li><a class="tocitem" href="../library/model.html">Models</a></li><li><a class="tocitem" href="../library/kernel.html">Kernels</a></li><li><a class="tocitem" href="../library/config.html">Configuration</a></li><li><a class="tocitem" href="../library/inout.html">Input and Output</a></li><li><a class="tocitem" href="../library/math.html">Math</a></li><li><a class="tocitem" href="../library/util.html">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory</a></li><li class="is-active"><a href="som.html">Stochastic Optimization Method</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="som.html">Stochastic Optimization Method</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/huangli712/ACFlow" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p>A. O. Mishchenko <em>et al.</em> proposed the stochastic optimization method. Though it looks like the stochastic analytic continuation, their differences are quite apparent. The stochastic optimization method does not need any likelihood function or Boltzmann distribution to weight the candidate spectral functions. It generates a lot of spectral functions through Monte Carlo samplings. For each candidate spectral function, the deviation <span>$D$</span> between the reconstructed Green&#39;s function <span>$\tilde{G}$</span> and original Green&#39;s function <span>$\bar{G}$</span> is measured. Those spectral functions with small deviations <span>$D$</span> are selected and averaged. Such that the desired spectral function is obtained.</p><h2 id="som"><a class="docs-heading-anchor" href="#som">Deviation Function</a><a id="som-1"></a><a class="docs-heading-anchor-permalink" href="#som" title="Permalink"></a></h2><p>In the stochastic optimization method, the deviation between reconstructed data <span>$\tilde{G}$</span> and input data <span>$\bar{G}$</span> is described by:</p><p class="math-container">\[D[A] = \sum^{M}_{m=1} |\Delta(m)|,\]</p><p>where <span>$M$</span> is the number of input data, and <span>$\Delta(m)$</span> is the deviation function,</p><p class="math-container">\[\Delta(m) = \frac{\bar{G}(m) - \tilde{G}(m)}{S(m)}.\]</p><p>Here, <span>$S(m) = |G(m)|^{d}$</span> (where <span>$0 \le d \le 1$</span>). Recently, Krivenko <em>et al.</em> suggested that it would be better to use the goodness-of-fit functional <span>$\chi^2[A]$</span> to replace <span>$D[A]$</span>.</p><h2 id="Spectral-Density"><a class="docs-heading-anchor" href="#Spectral-Density">Spectral Density</a><a id="Spectral-Density-1"></a><a class="docs-heading-anchor-permalink" href="#Spectral-Density" title="Permalink"></a></h2><p>The stochastic optimization method will try to accumulate the candidate spectral functions that manifest small <span>$D[A]$</span>. Supposed the Monte Carlo simulations are repeated for <span>$L$</span> times. For the <span>$i$</span>-th Monte Carlo simulation, the spectral density <span>$A_i(\omega)$</span> and deviation <span>$D[A_i]$</span> are recorded. The minimum value of deviation is <span>$\min\{D[A_i]\}$</span>. Thus, the final spectral density reads:</p><p class="math-container">\[A(\omega) = \frac{1}{L_{\text{good}}} \sum^{L}_{i = 1}
\theta(\alpha_{\text{good}} \min\{D[A_i]\} - D[A_i]) A_{i}(\omega).\]</p><p>Here, <span>$\theta(x)$</span> is the Heaviside step function, and <span>$\alpha_{\text{good}}$</span> is a adjustable parameter. <span>$L_{\text{good}}$</span> denotes the number of <code>good</code> spectral functions:</p><p class="math-container">\[L_{\text{good}} = \sum^{L}_{i = 1}
\theta(\alpha_{\text{good}} \min\{D[A_i]\} - D[A_i]).\]</p><p>That is to say, only those spectral functions who satisfy the following condition will be selected:</p><p class="math-container">\[D[A_i] \le \alpha_{\text{good}} \min\{D[A_i]\}.\]</p><p>Clearly, the larger <span>$\alpha_{\text{good}}$</span> is, the more spectral functions are included. It is usually set to 2.</p><h2 id="Rectangle-Representation"><a class="docs-heading-anchor" href="#Rectangle-Representation">Rectangle Representation</a><a id="Rectangle-Representation-1"></a><a class="docs-heading-anchor-permalink" href="#Rectangle-Representation" title="Permalink"></a></h2><p>Similar to the stochastic analytic continuation, the stochastic optimization method usually employs a few rectangle functions to parameterize the spectral function:</p><p class="math-container">\[A(\omega) = \sum_i R_{\{c_i, w_i, h_i\}} (\omega),\]</p><p>where <span>$i$</span> is the index of rectangle function. The definition of rectangle function <span>$R_{\{c_i, w_i, h_i\}} (\omega)$</span> reads:</p><p class="math-container">\[R_{\{c_i, w_i, h_i\}} (\omega) =
h_i
\theta[\omega - (c_i - w_i/2)]
\theta[(c_i + w_i/2) - \omega],\]</p><p>where <span>$c_i$</span>, <span>$w_i$</span>, <span>$h_i$</span> denote the center, width, and height of the <span>$i$</span>-th rectangle, respectively. Pay attention to that the area of all rectangles must be normalized to 1:</p><p class="math-container">\[\sum_i h_i w_i = 1.\]</p><p><img src="../assets/som.png" alt="som.png"/></p><p><strong>Figure 1 |</strong> Typical Monte Carlo field configurations for stochastic optimization method. The spectral function is parameterized by multiple rectangle functions. Here, <span>$c_i$</span>, <span>$w_i$</span>, and <span>$h_i$</span> denote the center, width, and height of the <span>$i$</span>-th rectangle, respectively.</p><h2 id="Monte-Carlo-Sampling"><a class="docs-heading-anchor" href="#Monte-Carlo-Sampling">Monte Carlo Sampling</a><a id="Monte-Carlo-Sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Monte-Carlo-Sampling" title="Permalink"></a></h2><p>The parameters of all rectangle functions create a configuration space:</p><p class="math-container">\[\mathcal{C} = \{c_i, w_i, h_i\}.\]</p><p>Then the Metropolis algorithm is utilized to sample this configuration space. Mishchenko <em>et al.</em> introduces seven Monte Carlo updates, including: (a) Insert a new rectangle, change width and height of another rectangle; (b) Remove an existing rectangle, change width and height of another rectangle; (c) Shift position of any rectangles; (d) Change widths of any two rectangles; (e) Change heights of any two rectangles; (f) Split a rectangle into two new rectangles; (g) Merge two adjacent rectangles into a new rectangle. The transition probability of these Monte Carlo updates is:</p><p class="math-container">\[p(\mathcal{C} \to \mathcal{C}&#39;) = \left(\frac{D[A_{\mathcal{C}}]}{D[A_{\mathcal{C}&#39;}]}\right)^{1+d}.\]</p><p>As compared to the maximum entropy method, the likelihood function, entropic term, and model function are absent in the stochastic optimization method. As compared to the stochastic analytic continuation, there are no adjustable parameters, such as <span>$\Theta$</span> in Sandvik&#39;s algorithm and <span>$\alpha$</span> in Beach&#39;s algorithm. Thus, the simulated results of the stochastic optimization method are less affected by artificial parameters.</p><h2 id="Relevant-Parameters"><a class="docs-heading-anchor" href="#Relevant-Parameters">Relevant Parameters</a><a id="Relevant-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Relevant-Parameters" title="Permalink"></a></h2><p>See <a href="../man/param.html#stochom_block">[StochOM] Block</a></p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>[1] A. S. Mishchenko, N. V. Prokof’ev, A. Sakamoto, B. V. Svistunov, Diagrammatic quantum Monte Carlo study of the frohlich polaron, <em>Phys. Rev. B</em> <strong>62</strong>, 6317 (2000).</p><p>[2] I. Krivenko, M. Harland, TRIQS/SOM: Implementation of the stochastic optimization method for analytic continuation, <em>Comput. Phys. Commun.</em> <strong>239</strong>, 166 (2019).</p><p>[3] I. Krivenko, A. S. Mishchenko, TRIQS/SOM 2.0: Implementation of the stochastic optimization with consistent constraints for analytic continuation, <em>Comput. Phys. Commun.</em> <strong>280</strong>, 108491 (2022).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="sac2.html">« Stochastic Analytic Continuation 2</a><a class="docs-footer-nextpage" href="spx.html">Stochastic Pole Expansion »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 22 September 2025 17:35">Monday 22 September 2025</span>. Using Julia version 1.12.0-rc1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
