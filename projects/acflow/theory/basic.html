<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basic Principles · ACFlow</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">ACFlow</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../intro/background.html">Background</a></li><li><a class="tocitem" href="../intro/ack.html">Acknowledgements</a></li><li><a class="tocitem" href="../intro/cite.html">Citation</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../man/feature.html">Main Features</a></li><li><a class="tocitem" href="../man/impl.html">Implementations</a></li><li><a class="tocitem" href="../man/install.html">Installation</a></li><li><a class="tocitem" href="../man/run.html">Running Modes</a></li><li><a class="tocitem" href="../man/input.html">Input Files</a></li><li><a class="tocitem" href="../man/output.html">Output Files</a></li><li><a class="tocitem" href="../man/param.html">Parameters</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/sigma.html">Matsubara Self-Energy Function</a></li><li><a class="tocitem" href="../examples/green1.html">Matsubara Green&#39;s Function</a></li><li><a class="tocitem" href="../examples/green2.html">Imaginary Time Green&#39;s Function</a></li><li><a class="tocitem" href="../examples/current.html">Current-Current Correlation Function</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li class="is-active"><a class="tocitem" href="basic.html">Basic Principles</a><ul class="internal"><li><a class="tocitem" href="#Finite-Temperature-Green&#39;s-Functions"><span>Finite Temperature Green&#39;s Functions</span></a></li><li><a class="tocitem" href="#spectrum"><span>Spectral Density</span></a></li><li><a class="tocitem" href="#Kernel-functions"><span>Kernel functions</span></a></li></ul></li><li><a class="tocitem" href="maxent.html">Maximum Entropy Method</a></li><li><a class="tocitem" href="sac1.html">Stochastic Analytical Continuation 1</a></li><li><a class="tocitem" href="sac2.html">Stochastic Analytical Continuation 2</a></li><li><a class="tocitem" href="som.html">Stochastic Optimization Method</a></li><li><a class="tocitem" href="reference.html">References</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../library/outline.html">Outline</a></li><li><a class="tocitem" href="../library/acflow.html">ACFlow</a></li><li><a class="tocitem" href="../library/global.html">Constants</a></li><li><a class="tocitem" href="../library/type.html">Types</a></li><li><a class="tocitem" href="../library/base.html">Core</a></li><li><a class="tocitem" href="../library/solver.html">Solvers</a></li><li><a class="tocitem" href="../library/grid.html">Grids</a></li><li><a class="tocitem" href="../library/mesh.html">Meshes</a></li><li><a class="tocitem" href="../library/model.html">Models</a></li><li><a class="tocitem" href="../library/kernel.html">Kernels</a></li><li><a class="tocitem" href="../library/config.html">Configuration</a></li><li><a class="tocitem" href="../library/inout.html">Input and output</a></li><li><a class="tocitem" href="../library/math.html">Math</a></li><li><a class="tocitem" href="../library/util.html">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory</a></li><li class="is-active"><a href="basic.html">Basic Principles</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="basic.html">Basic Principles</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/huangli712/ACFlow/blob/master/docs/src/theory/basic.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Basic-Principles"><a class="docs-heading-anchor" href="#Basic-Principles">Basic Principles</a><a id="Basic-Principles-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Principles" title="Permalink"></a></h1><h2 id="Finite-Temperature-Green&#39;s-Functions"><a class="docs-heading-anchor" href="#Finite-Temperature-Green&#39;s-Functions">Finite Temperature Green&#39;s Functions</a><a id="Finite-Temperature-Green&#39;s-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Finite-Temperature-Green&#39;s-Functions" title="Permalink"></a></h2><p>Under the Wick&#39;s rotation <span>$t \to i\tau$</span>, the time evolution operator in the Heisenberg picture <span>$e^{itH}$</span> will be replaced by <span>$e^{-\tau H}$</span>. Such a transformation will increase efficiency of QMC random walking and suppress numerical oscillation (when <span>$t$</span> is large, the periodic oscillation of <span>$e^{itH}$</span> is quite obvious). This is an important reason why most of the finite temperature QMC algorithms are formulated in imaginary time axis. The outputs of finite temperature QMC simulations are usually single-particle or two-particle correlation functions. For example, the imaginary time Green&#39;s function <span>$G(\tau)$</span> is defined as follows: </p><p class="math-container">\[\begin{equation}
G(\tau) = \langle \mathcal{T}_{\tau} d(\tau) d^{\dagger}(0) \rangle,
\end{equation}\]</p><p>where <span>$\tau$</span> denotes imaginary time, <span>$\mathcal{T}_{\tau}$</span> denotes time-ordered operator, and <span>$d$</span> and <span>$d^{\dagger}$</span> are annihilation and creation operators, respectively. The Matsubara Green&#39;s function <span>$G(i\omega_n)$</span> can be measured by QMC simulations or constructed from <span>$G(\tau)$</span> via direct Fourier transformation:</p><p class="math-container">\[\begin{equation}
G(i\omega_n) = \int^{\beta}_0 d\tau~e^{-i\omega_n \tau} G(\tau),
\end{equation}\]</p><p class="math-container">\[\begin{equation}
G(\tau) = \frac{1}{\beta} \sum_n e^{i\omega_n \tau} G(i\omega_n).
\end{equation}\]</p><p>Here, <span>$\beta$</span> means the inverse temperature (<span>$\beta \equiv 1/T$</span>) and <span>$\omega_n$</span> is the Matsubara frequency. Note that <span>$\omega_n$</span> is equal to <span>$(2n + 1) \pi / \beta$</span> for fermions and <span>$2n\pi/ \beta$</span> for bosons (<span>$n$</span> is an integer).</p><h2 id="spectrum"><a class="docs-heading-anchor" href="#spectrum">Spectral Density</a><a id="spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#spectrum" title="Permalink"></a></h2><p>Clearly, neither <span>$G(\tau)$</span> nor <span>$G(i\omega_n)$</span> can be observed experimentally. We have to extract dynamical response function, i.e., the spectral density <span>$A(\omega)$</span>, from them. <span>$A(\omega)$</span> is indeed an observable quantity. It is related to <span>$G(\tau)$</span> via the following Laplace transformation:</p><p class="math-container">\[\begin{equation}
G(\tau) = \int^{+\infty}_{-\infty} d\omega \frac{e^{-\tau\omega}}{1 \pm e^{-\beta\omega}} A(\omega),
\end{equation}\]</p><p>where +(-) in the denominator is for fermionic (bosonic) system. <span>$G(i\omega_n)$</span> and <span>$A(\omega)$</span> manifest similar relation:</p><p class="math-container">\[\begin{equation}
G(i\omega_n) = \int^{+\infty}_{-\infty} d\omega&#39; \frac{A(\omega&#39;)}{i\omega_n - \omega&#39;}.
\end{equation}\]</p><p>It is obvious that Eq.(4) and Eq.(5) are indeed special forms of the Fredholm integral equation of the first kind. So, the central problem of analytical continuation is to search optimal <span>$A(\omega)$</span> for given <span>$G(\tau)$</span> or <span>$G(i\omega_n)$</span>.</p><p>Sometimes the spectral density <span>$A(\omega)$</span> is called as spectral function in the references. It is tied to the imaginary part of real frequency Green&#39;s function <span>$G(\omega)$</span>:</p><p class="math-container">\[\begin{equation}
A(\omega) = -\frac{1}{\pi} \rm{Im}G(\omega).
\end{equation}\]</p><p>From Im<span>$G(\omega)$</span>, Re<span>$G(\omega)$</span> could be calculated via the Kramers-Kronig transformation:</p><p class="math-container">\[\begin{equation}
\mathrm{Re} G(\omega) = \frac{1}{\pi} \mathcal{P}
  \int_{-\infty}^{\infty} d\omega&#39;~
  \frac{\mathrm{Im} G(\omega&#39;)}{\omega&#39;-\omega},
\end{equation}\]</p><p>where <span>$\mathcal{P}$</span> means Cauchy principal value. Besides Eq.(4) and Eq.(5), <span>$A(\omega)$</span> has to obey some additional constraints or sum-rules. For fermionic systems, the spectral functions must be positive:</p><p class="math-container">\[\begin{equation}
A(\omega) \ge 0.
\end{equation}\]</p><p>While for bosonic systems, the above condition turns into:</p><p class="math-container">\[\begin{equation}
\text{sign}(\omega) A(\omega) \ge 0.
\end{equation}\]</p><p>In addition, the spectral function <span>$A(\omega)$</span> is always bounded,</p><p class="math-container">\[\begin{equation}
\int^{+\infty}_{-\infty} d\omega~A(\omega) &lt; \infty.
\end{equation}\]</p><p>It can be utilized to normalize the final spectral function.</p><h2 id="Kernel-functions"><a class="docs-heading-anchor" href="#Kernel-functions">Kernel functions</a><a id="Kernel-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Kernel-functions" title="Permalink"></a></h2><p>Eq.(4) and Eq.(5) can be reformulated as follows:</p><p class="math-container">\[\begin{equation}
G(\tau) = \int^{+\infty}_{-\infty} d\omega~K(\tau,\omega) A(\omega),
\end{equation}\]</p><p>and</p><p class="math-container">\[\begin{equation}
G(i\omega_n) = \int^{+\infty}_{-\infty} d\omega~K(\omega_n,\omega) A(\omega),
\end{equation}\]</p><p>where <span>$K(\tau,\omega)$</span> and <span>$K(\omega_n, \omega)$</span> are the so-called kernel functions. Their definitions are as follows:</p><p class="math-container">\[\begin{equation}
K(\tau,\omega) = \frac{e^{-\tau\omega}}{1 \pm e^{-\beta\omega}},
\end{equation}\]</p><p>and</p><p class="math-container">\[\begin{equation}
K(\omega_n,\omega) = \frac{1}{i\omega_n - \omega},
\end{equation}\]</p><p>where +(-) in the denominator of Eq.(13) stands for fermions (bosons).</p><p>As mentioned above, the kernel function is quite strange. The values of <span>$K(\tau,\omega)$</span> could change by tens of orders of magnitude. Especially, at large positive and negative frequencies, <span>$K(\tau,\omega)$</span> is exponentially small. It implies that at large <span>$|\omega|$</span> the features of <span>$A(\omega)$</span> depend upon the fine structures of <span>$G(\tau)$</span>. However, the <span>$G(\tau)$</span> data provided by QMC simulations are always fluctuant and noisy. Tiny deviations in <span>$G(\tau)$</span> from its expected values can lead to enormous changes in <span>$A(\omega)$</span>. Thus, analytical continuation is often characterized as an ill-posed problem.</p><p>In principle, for incomplete and noise <span>$G(\tau)$</span> or <span>$G(i\omega_n)$</span>, the number of spectral functions <span>$A(\omega)$</span> that satisfy Eq.(11) and Eq.(12) is infinite. So the question becomes which <span>$A(\omega)$</span> should be chosen. Now there are two different strategies to solve this problem. The first one is to choose the most likely <span>$A(\omega)$</span>. The second one is to evaluate the average of all the candidate spectral functions. In next section, we will introduce three primary analytical continuation methods that follow the two strategies and have been implemented in the ACFlow toolkit. We will concentrate on analytical continuation of imaginary time Green&#39;s functions in main text.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/current.html">« Current-Current Correlation Function</a><a class="docs-footer-nextpage" href="maxent.html">Maximum Entropy Method »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Monday 28 November 2022 17:42">Monday 28 November 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
