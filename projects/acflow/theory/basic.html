<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basic Principles · ACFlow</title><meta name="title" content="Basic Principles · ACFlow"/><meta property="og:title" content="Basic Principles · ACFlow"/><meta property="twitter:title" content="Basic Principles · ACFlow"/><meta name="description" content="Documentation for ACFlow."/><meta property="og:description" content="Documentation for ACFlow."/><meta property="twitter:description" content="Documentation for ACFlow."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="ACFlow logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">ACFlow</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../intro/acp.html">Analytic Continuation</a></li><li><a class="tocitem" href="../intro/motivation.html">Motivation</a></li><li><a class="tocitem" href="../intro/ack.html">Acknowledgements</a></li><li><a class="tocitem" href="../intro/cite.html">Citation</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../man/feature.html">Main Features</a></li><li><a class="tocitem" href="../man/impl.html">Implementations</a></li><li><a class="tocitem" href="../man/install.html">Installation</a></li><li><a class="tocitem" href="../man/run.html">Running Modes</a></li><li><a class="tocitem" href="../man/input.html">Input Files</a></li><li><a class="tocitem" href="../man/output.html">Output Files</a></li><li><a class="tocitem" href="../man/param.html">Parameters</a></li><li><a class="tocitem" href="../man/tricks.html">Tricks and tips</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/sigma.html">Matsubara Self-Energy Function</a></li><li><a class="tocitem" href="../examples/green1.html">Matsubara Green&#39;s Function</a></li><li><a class="tocitem" href="../examples/green2.html">Imaginary Time Green&#39;s Function</a></li><li><a class="tocitem" href="../examples/current.html">Current-Current Correlation Function</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li class="is-active"><a class="tocitem" href="basic.html">Basic Principles</a><ul class="internal"><li><a class="tocitem" href="#Finite-Temperature-Green&#39;s-Functions"><span>Finite Temperature Green&#39;s Functions</span></a></li><li><a class="tocitem" href="#spectrum"><span>Spectral representation</span></a></li><li><a class="tocitem" href="#Pole-representation"><span>Pole representation</span></a></li><li><a class="tocitem" href="#Relevant-parameters"><span>Relevant parameters</span></a></li></ul></li><li><a class="tocitem" href="maxent.html">Maximum Entropy Method</a></li><li><a class="tocitem" href="rfa.html">Barycentric Rational Function</a></li><li><a class="tocitem" href="nac.html">Nevanlinna Analytical Continuation</a></li><li><a class="tocitem" href="sac1.html">Stochastic Analytic Continuation 1</a></li><li><a class="tocitem" href="sac2.html">Stochastic Analytic Continuation 2</a></li><li><a class="tocitem" href="som.html">Stochastic Optimization Method</a></li><li><a class="tocitem" href="spx.html">Stochastic Pole Expansion</a></li><li><a class="tocitem" href="reference.html">References</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../library/outline.html">Outline</a></li><li><a class="tocitem" href="../library/acflow.html">ACFlow</a></li><li><a class="tocitem" href="../library/global.html">Constants</a></li><li><a class="tocitem" href="../library/type.html">Types</a></li><li><a class="tocitem" href="../library/base.html">Core</a></li><li><a class="tocitem" href="../library/solver.html">Solvers</a></li><li><a class="tocitem" href="../library/grid.html">Grids</a></li><li><a class="tocitem" href="../library/mesh.html">Meshes</a></li><li><a class="tocitem" href="../library/model.html">Models</a></li><li><a class="tocitem" href="../library/kernel.html">Kernels</a></li><li><a class="tocitem" href="../library/config.html">Configuration</a></li><li><a class="tocitem" href="../library/inout.html">Input and output</a></li><li><a class="tocitem" href="../library/math.html">Math</a></li><li><a class="tocitem" href="../library/util.html">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory</a></li><li class="is-active"><a href="basic.html">Basic Principles</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="basic.html">Basic Principles</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/huangli712/ACFlow" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Basic-Principles"><a class="docs-heading-anchor" href="#Basic-Principles">Basic Principles</a><a id="Basic-Principles-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Principles" title="Permalink"></a></h1><h2 id="Finite-Temperature-Green&#39;s-Functions"><a class="docs-heading-anchor" href="#Finite-Temperature-Green&#39;s-Functions">Finite Temperature Green&#39;s Functions</a><a id="Finite-Temperature-Green&#39;s-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Finite-Temperature-Green&#39;s-Functions" title="Permalink"></a></h2><p>Under the Wick&#39;s rotation <span>$t \to i\tau$</span>, the time evolution operator in the Heisenberg picture <span>$e^{itH}$</span> will be replaced by <span>$e^{-\tau H}$</span>. Such a transformation will increase efficiency of QMC random walking and suppress numerical oscillation (when <span>$t$</span> is large, the periodic oscillation of <span>$e^{itH}$</span> is quite obvious). This is an important reason why most of the finite temperature QMC algorithms are formulated in imaginary time axis. The outputs of finite temperature QMC simulations are usually single-particle or two-particle correlation functions. For example, the imaginary time Green&#39;s function <span>$G(\tau)$</span> is defined as follows:</p><p class="math-container">\[\begin{equation}
G(\tau) = \langle \mathcal{T}_{\tau} d(\tau) d^{\dagger}(0) \rangle,
\end{equation}\]</p><p>where <span>$\tau$</span> denotes imaginary time, <span>$\mathcal{T}_{\tau}$</span> denotes time-ordered operator, and <span>$d$</span> and <span>$d^{\dagger}$</span> are annihilation and creation operators, respectively. The Matsubara Green&#39;s function <span>$G(i\omega_n)$</span> can be measured by QMC simulations or constructed from <span>$G(\tau)$</span> via direct Fourier transformation:</p><p class="math-container">\[\begin{equation}
G(i\omega_n) = \int^{\beta}_0 d\tau~e^{-i\omega_n \tau} G(\tau),
\end{equation}\]</p><p class="math-container">\[\begin{equation}
G(\tau) = \frac{1}{\beta} \sum_n e^{i\omega_n \tau} G(i\omega_n).
\end{equation}\]</p><p>Here, <span>$\beta$</span> means the inverse temperature (<span>$\beta \equiv 1/T$</span>) and <span>$\omega_n$</span> is the Matsubara frequency. Note that <span>$\omega_n$</span> is equal to <span>$(2n + 1) \pi / \beta$</span> for fermions and <span>$2n\pi/ \beta$</span> for bosons (<span>$n$</span> is an integer).</p><hr/><h2 id="spectrum"><a class="docs-heading-anchor" href="#spectrum">Spectral representation</a><a id="spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#spectrum" title="Permalink"></a></h2><p>Supposed that the spectral density of the single-particle Green&#39;s function is <span>$A(\omega)$</span>, then we have:</p><p class="math-container">\[\begin{equation}
G(\tau) = \int^{+\infty}_{-\infty} d\omega
          \frac{e^{-\tau\omega}}{1 \pm e^{-\beta\omega}}
          A(\omega),
\end{equation}\]</p><p>with the positive (negative) sign for fermionic (bosonic) operators. Similarly,</p><p class="math-container">\[\begin{equation}
G(i\omega_n) = \int^{+\infty}_{-\infty} d\omega
               \frac{1}{i\omega_n - \omega} A(\omega).
\end{equation}\]</p><p>The two equations denote the spectral representation of Green&#39;s function. We notice that the SPX method, as well as the other analytic continuation methods that are classified as ASM, are closely related to the spectral representation. Next we would like to make further discussions about this representation for the fermionic and bosonic correlators.</p><h3 id="Fermionic-correlators"><a class="docs-heading-anchor" href="#Fermionic-correlators">Fermionic correlators</a><a id="Fermionic-correlators-1"></a><a class="docs-heading-anchor-permalink" href="#Fermionic-correlators" title="Permalink"></a></h3><p>The spectral density <span>$A(\omega)$</span> is defined on <span>$(-\infty,\infty)$</span>. It is positive definite, i.e., <span>$A(\omega) \ge 0$</span>. Eq.(4) and Eq.(5) can be reformulated as:</p><p class="math-container">\[\begin{equation}
G(\tau) = \int^{+\infty}_{-\infty} d\omega~K(\tau,\omega) A(\omega),
\end{equation}\]</p><p>and</p><p class="math-container">\[\begin{equation}
G(i\omega_n) = \int^{+\infty}_{-\infty} d\omega~K(\omega_n,\omega) A(\omega),
\end{equation}\]</p><p>respectively. The kernel functions <span>$K(\tau,\omega)$</span> and <span>$K(\omega_n,\omega)$</span> are defined as follows:</p><p class="math-container">\[\begin{equation}
K(\tau,\omega) = \frac{e^{-\tau\omega}}{1 + e^{-\beta\omega}},
\end{equation}\]</p><p>and</p><p class="math-container">\[\begin{equation}
K(\omega_n,\omega) = \frac{1}{i\omega_n - \omega}.
\end{equation}\]</p><h3 id="Bosonic-correlators"><a class="docs-heading-anchor" href="#Bosonic-correlators">Bosonic correlators</a><a id="Bosonic-correlators-1"></a><a class="docs-heading-anchor-permalink" href="#Bosonic-correlators" title="Permalink"></a></h3><p>The spectral density <span>$A(\omega)$</span> obeys the following constraint: <span>$\text{sign}(\omega) A(\omega) \ge 0$</span>. Thus, it is more convenient to define a new function <span>$\tilde{A}(\omega)$</span> where <span>$\tilde{A}(\omega) = A(\omega)/\omega$</span>. Clearly, <span>$\tilde{A}(\omega)$</span> is always positive definite. As a result Eq.(4) and Eq.(5) can be rewritten as:</p><p class="math-container">\[\begin{equation}
G(\tau) = \int^{+\infty}_{-\infty} d\omega~
    K(\tau,\omega)\tilde{A}(\omega),
\end{equation}\]</p><p>and</p><p class="math-container">\[\begin{equation}
G(i\omega_n) = \int^{+\infty}_{-\infty} d\omega~
    K(\omega_n,\omega) \tilde{A}(\omega),
\end{equation}\]</p><p>respectively. Now the bosonic kernel <span>$K(\tau,\omega)$</span> becomes:</p><p class="math-container">\[\begin{equation}
K(\tau,\omega) = \frac{\omega e^{-\tau\omega}}{1 - e^{-\beta\omega}}.
\end{equation}\]</p><p>Especially, <span>$K(\tau,0) = 1/\beta$</span>. As for <span>$K(\omega_n,\omega)$</span>, its expression is:</p><p class="math-container">\[\begin{equation}
K(\omega_n,\omega) = \frac{\omega}{i\omega_n - \omega}.
\end{equation}\]</p><p>Especially, <span>$K(0,0) = -1$</span>. Besides the bosonic Green&#39;s function, typical correlator of this kind includes the transverse spin susceptibility <span>$\chi_{+-}(\tau) = \langle S_{+}(\tau) S_{-}(0) \rangle$</span>, where <span>$S_{+} = S_x + iS_y$</span> and <span>$S_{-} = S_x - i S_y$</span>.</p><h3 id="Bosonic-correlators-of-Hermitian-operators"><a class="docs-heading-anchor" href="#Bosonic-correlators-of-Hermitian-operators">Bosonic correlators of Hermitian operators</a><a id="Bosonic-correlators-of-Hermitian-operators-1"></a><a class="docs-heading-anchor-permalink" href="#Bosonic-correlators-of-Hermitian-operators" title="Permalink"></a></h3><p>There is a special case of the previous observable kind with <span>$d = d^{\dagger}$</span>. Here, <span>$A(\omega)$</span> becomes an odd function, and equivalently, <span>$\tilde{A}(\omega)$</span> is an even function [i.e., <span>$\tilde{A}(\omega) = \tilde{A}(-\omega)$</span>]. Therefore the limits of integrations in Eq.(4) and Eq.(5) are reduced from <span>$(-\infty,\infty)$</span> to <span>$(0,\infty)$</span>. So the two equations can be transformed into:</p><p class="math-container">\[\begin{equation}
G(\tau) = \int^{+\infty}_{0} d\omega~
    K(\tau,\omega)\tilde{A}(\omega),
\end{equation}\]</p><p>and</p><p class="math-container">\[\begin{equation}
G(i\omega_n) = \int^{+\infty}_{0} d\omega~
    K(\omega_n,\omega) \tilde{A}(\omega),
\end{equation}\]</p><p>respectively. The corresponding <span>$K(\tau,\omega)$</span> reads:</p><p class="math-container">\[\begin{equation}
K(\tau,\omega) = \frac{\omega \left[e^{-\tau\omega} + e^{-(\beta - \tau)\omega}\right]}
                      {1 - e^{-\beta\omega}}.
\end{equation}\]</p><p>Especially, <span>$K(\tau,0) = 2 / \beta$</span>. And <span>$K(\omega_n,\omega)$</span> becomes:</p><p class="math-container">\[\begin{equation}
K(\omega_n, \omega) = \frac{-2\omega^2}{\omega_n^2 + \omega^2}.
\end{equation}\]</p><p>Especially, <span>$K(0,0) = -2$</span>. Perhaps the longitudinal spin susceptibility <span>$\chi_{zz}(\tau) = \langle S_z(\tau) S_z(0) \rangle$</span> and the charge susceptibility <span>$\chi_{ch}(\tau) = \langle N(\tau) N(0) \rangle$</span> are the most widely used observables of this kind.</p><p>As mentioned above, the kernel function is quite strange. The values of <span>$K(\tau,\omega)$</span> could change by tens of orders of magnitude. Especially, at large positive and negative frequencies, <span>$K(\tau,\omega)$</span> is exponentially small. It implies that at large <span>$|\omega|$</span> the features of <span>$A(\omega)$</span> depend upon the fine structures of <span>$G(\tau)$</span>. However, the <span>$G(\tau)$</span> data provided by QMC simulations are always fluctuant and noisy. Tiny deviations in <span>$G(\tau)$</span> from its expected values can lead to enormous changes in <span>$A(\omega)$</span>. Thus, analytic continuation is often characterized as an ill-posed problem.</p><p>In principle, for incomplete and noise <span>$G(\tau)$</span> or <span>$G(i\omega_n)$</span>, the number of spectral functions <span>$A(\omega)$</span> that satisfy Eq.(4) and Eq.(5) is infinite. So the question becomes which <span>$A(\omega)$</span> should be chosen. Now there are two different strategies to solve this problem. The first one is to choose the most likely <span>$A(\omega)$</span>. The second one is to evaluate the average of all the candidate spectral functions.</p><hr/><h2 id="Pole-representation"><a class="docs-heading-anchor" href="#Pole-representation">Pole representation</a><a id="Pole-representation-1"></a><a class="docs-heading-anchor-permalink" href="#Pole-representation" title="Permalink"></a></h2><p>It is well known that the finite temperature many-body Green&#39;s functions can be expressed within the Lehmann representation:</p><p class="math-container">\[\begin{equation}
G_{ab}(z) = \frac{1}{Z} \sum_{m,n}
\frac{\langle n | d_a | m \rangle \langle m | d_b^{\dagger} | n \rangle}{z + E_n - E_m}
\left(e^{-\beta E_n} \pm e^{-\beta E_m}\right),
\end{equation}\]</p><p>where <span>$a$</span> and <span>$b$</span> are the band indices, <span>$d$</span> (<span>$d^{\dagger}$</span>) denote the annihilation (creation) operators, <span>$|n \rangle$</span> and <span>$|m \rangle$</span> are eigenstates of the Hamiltonian <span>$\hat{H}$</span>, and <span>$E_n$</span> and <span>$E_m$</span> are the corresponding eigenvalues, <span>$Z$</span> is the partition function (<span>$Z = \sum_n e^{-\beta E_n}$</span>). The positive sign corresponds to fermions, while the negative sign corresponds to bosons. The domain of this function is on the complex plane, but the real axis is excluded (<span>$z \in \{0\} \bigcup \mathbb{C}~\backslash~\mathbb{R}$</span>). If <span>$z = i\omega_n \in i\mathbb{R}$</span>, <span>$G_{ab}(i\omega_n)$</span> is the Matsubara Green&#39;s function. If <span>$z = \omega + i0^{+}$</span>, <span>$G_{ab}(\omega + i0^{+}) = G_{ab}^{R}(\omega)$</span> is called the retarded Green&#39;s function.</p><p>At first we focus on the diagonal cases (<span>$a = b$</span>). For the sake of simplicity, the band indices are ignored in the following discussions. Let <span>$A_{mn} = \langle n | d | m \rangle \langle m | d^{\dagger} | n \rangle \left(e^{-\beta E_n} + e^{-\beta E_m}\right) / Z$</span> and <span>$P_{mn} = E_m - E_n$</span>, then <span>$G(z) = \sum_{m,n} A_{mn} / (z - P_{mn})$</span>. Clearly, only those nonzero elements of <span>$A_{mn}$</span> contribute to the Green&#39;s function. If the indices <span>$m$</span> and <span>$n$</span> are further compressed into <span>$\gamma$</span> (i.e, <span>$\gamma = \{m,n\}$</span>), then Eq.(18) is simplified to:</p><p class="math-container">\[\begin{equation}
G(z) = \sum^{N_p}_{\gamma = 1} \frac{A_{\gamma}}{z - P_{\gamma}}.
\end{equation}\]</p><p>Here, <span>$A_{\gamma}$</span> and <span>$P_{\gamma}$</span> mean the amplitude and location of the <span>$\gamma$</span>-th pole, respectively. <span>$N_p$</span> means the number of poles, which is equal to the total number of nonzero <span>$A_{mn}$</span>. Such an analytic expression of Green&#39;s function is called the <code>pole expansion</code>. It is valid for both fermionic and bosonic correlators.</p><h3 id="Fermionic-correlators-2"><a class="docs-heading-anchor" href="#Fermionic-correlators-2">Fermionic correlators</a><a class="docs-heading-anchor-permalink" href="#Fermionic-correlators-2" title="Permalink"></a></h3><p>For fermionic systems, the pole representation for Matsubara Green&#39;s function can be recast as:</p><p class="math-container">\[\begin{equation}
G(i\omega_n) = \sum^{N_p}_{\gamma = 1} \Xi(\omega_n, P_{\gamma}) A_{\gamma}.
\end{equation}\]</p><p>Here, <span>$\Xi$</span> is the kernel matrix. It is evaluated by:</p><p class="math-container">\[\begin{equation}
\Xi(\omega_n, \omega) = \frac{1}{i\omega_n - \omega}.
\end{equation}\]</p><p>Note that <span>$A_{\gamma}$</span> and <span>$P_{\gamma}$</span> should satisfy the following constraints:</p><p class="math-container">\[\begin{equation}
\forall \gamma, 0 \le A_{\gamma} \le 1, \sum_{\gamma} A_{\gamma} = 1, P_{\gamma} \in \mathbb{R}.
\end{equation}\]</p><h3 id="Bosonic-correlators-2"><a class="docs-heading-anchor" href="#Bosonic-correlators-2">Bosonic correlators</a><a class="docs-heading-anchor-permalink" href="#Bosonic-correlators-2" title="Permalink"></a></h3><p>For bosonic systems, the pole representation for Matsubara Green&#39;s function can be defined as follows:</p><p class="math-container">\[\begin{equation}
G(i\omega_n) = \sum^{N_p}_{\gamma=1} \Xi(\omega_n, P_{\gamma}) \tilde{A}_{\gamma}.
\end{equation}\]</p><p>Here, <span>$\Xi$</span> is evaluated by:</p><p class="math-container">\[\begin{equation}
\Xi(\omega_n, \omega) = \frac{G_0 \omega}{i\omega_n - \omega},
\end{equation}\]</p><p>where <span>$G_{0} = -G(i\omega_n = 0)$</span>, which should be a positive real number. Be careful, <span>$\Xi(0,\omega) = -G_0$</span>. <span>$\tilde{A}_{\gamma}$</span> is the renormalized amplitude of the <span>$\gamma$</span>-th pole:</p><p class="math-container">\[\begin{equation}
\tilde{A}_{\gamma} = \frac{A_{\gamma}}{G_0 P_{\gamma}}.
\end{equation}\]</p><p>Note that <span>$\tilde{A}_{\gamma}$</span> and <span>$P_{\gamma}$</span> should satisfy the following constraints:</p><p class="math-container">\[\begin{equation}
\forall \gamma, 0 \le \tilde{A}_{\gamma} \le 1, \sum_{\gamma} \tilde{A}_{\gamma} = 1, P_{\gamma} \in \mathbb{R}.
\end{equation}\]</p><h3 id="Bosonic-correlators-of-Hermitian-operators-2"><a class="docs-heading-anchor" href="#Bosonic-correlators-of-Hermitian-operators-2">Bosonic correlators of Hermitian operators</a><a class="docs-heading-anchor-permalink" href="#Bosonic-correlators-of-Hermitian-operators-2" title="Permalink"></a></h3><p>Its pole representation can be defined as follows (<span>$\forall \gamma$</span>, <span>$A_{\gamma} &gt; 0$</span> and <span>$P_{\gamma} &gt; 0$</span>):</p><p class="math-container">\[\begin{align}
G(i\omega_n) &amp;= \sum^{N_p}_{\gamma = 1}
\left(
    \frac{A_{\gamma}}{i\omega_n - P_{\gamma}} -
    \frac{A_{\gamma}}{i\omega_n + P_{\gamma}}
\right) \\
&amp;= \sum^{N_p}_{\gamma = 1}
\Xi(\omega_n, P_{\gamma}) \tilde{A}_{\gamma}.
\end{align}\]</p><p>Thus, the kernel matrix <span>$\Xi$</span> reads:</p><p class="math-container">\[\begin{equation}
\Xi(\omega_n, \omega) = \frac{-G_0 \omega^2}{\omega^2_n + \omega^2}.
\end{equation}\]</p><p>Especially, <span>$\Xi(0,0) = -G_0$</span>. The renormalized weight <span>$\tilde{A}_{\gamma}$</span> reads:</p><p class="math-container">\[\begin{equation}
\tilde{A}_{\gamma} = \frac{2A_{\gamma}}{G_0 P_{\gamma}}.
\end{equation}\]</p><p>The constraints for <span>$\tilde{A}_{\gamma}$</span> and <span>$P_{\gamma}$</span> are also defined in Eq.(26).</p><h3 id="Matrix-valued-Green&#39;s-functions"><a class="docs-heading-anchor" href="#Matrix-valued-Green&#39;s-functions">Matrix-valued Green&#39;s functions</a><a id="Matrix-valued-Green&#39;s-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Matrix-valued-Green&#39;s-functions" title="Permalink"></a></h3><p>As for the off-diagonal cases (<span>$a \neq b$</span>), it is lightly to prove that <span>$\sum_{\gamma} A_{\gamma} = 0$</span>. It implies that there exist poles with negative weights. Hence we can split the poles into two groups according to the signs of their amplitudes. The Matsubara Green&#39;s function can be expressed as follows:</p><p class="math-container">\[\begin{align}
G(i\omega_n) &amp;= \sum^{N^{+}_p}_{\gamma = 1}
               \frac{A^{+}_{\gamma}}{i\omega_n - P^{+}_{\gamma}} -
               \sum^{N^{-}_p}_{\gamma = 1}
               \frac{A^{-}_{\gamma}}{i\omega_n - P^{-}_{\gamma}} \\
             &amp;= \sum^{N^{+}_p}_{\gamma = 1}
               \Xi(\omega_n, P^{+}_{\gamma}) A^{+}_{\gamma} -
               \sum^{N^{-}_p}_{\gamma = 1}
               \Xi(\omega_n, P^{-}_{\gamma}) A^{-}_{\gamma}
.
\end{align}\]</p><p>Here, <span>$\Xi(\omega_n, \omega)$</span> is already defined in Eq.(21). The <span>$A^{\pm}_{\gamma}$</span> and <span>$P^{\pm}_{\gamma}$</span> are restricted by Eq.(22). In addition,</p><p class="math-container">\[\begin{equation}
N_p = N^{+}_p + N^{-}_p,
\end{equation}\]</p><p>and</p><p class="math-container">\[\begin{equation}
\sum^{N^{+}_p}_{\gamma = 1} A^{+}_{\gamma} -
\sum^{N^{-}_p}_{\gamma = 1} A^{-}_{\gamma} = 0.
\end{equation}\]</p><hr/><h2 id="Relevant-parameters"><a class="docs-heading-anchor" href="#Relevant-parameters">Relevant parameters</a><a id="Relevant-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Relevant-parameters" title="Permalink"></a></h2><p>See <a href="../man/param.html#base_block">[BASE] Block</a></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/current.html">« Current-Current Correlation Function</a><a class="docs-footer-nextpage" href="maxent.html">Maximum Entropy Method »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 23 September 2024 21:02">Monday 23 September 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
