<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Stochastic Analytical Continuation 1 · ACFlow</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">ACFlow</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../intro/background.html">Background</a></li><li><a class="tocitem" href="../intro/ack.html">Acknowledgements</a></li><li><a class="tocitem" href="../intro/cite.html">Citation</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../man/feature.html">Main Features</a></li><li><a class="tocitem" href="../man/impl.html">Implementations</a></li><li><a class="tocitem" href="../man/install.html">Installation</a></li><li><a class="tocitem" href="../man/run.html">Running Modes</a></li><li><a class="tocitem" href="../man/input.html">Input Files</a></li><li><a class="tocitem" href="../man/output.html">Output Files</a></li><li><a class="tocitem" href="../man/param.html">Parameters</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/sigma.html">Matsubara Self-Energy Function</a></li><li><a class="tocitem" href="../examples/green1.html">Matsubara Green&#39;s Function</a></li><li><a class="tocitem" href="../examples/green2.html">Imaginary Time Green&#39;s Function</a></li><li><a class="tocitem" href="../examples/current.html">Current-Current Correlation Function</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="basic.html">Basic Principles</a></li><li><a class="tocitem" href="maxent.html">Maximum Entropy Method</a></li><li class="is-active"><a class="tocitem" href="sac1.html">Stochastic Analytical Continuation 1</a><ul class="internal"><li><a class="tocitem" href="#Sandvik&#39;s-Algorithm"><span>Sandvik&#39;s Algorithm</span></a></li></ul></li><li><a class="tocitem" href="sac2.html">Stochastic Analytical Continuation 2</a></li><li><a class="tocitem" href="som.html">Stochastic Optimization Method</a></li><li><a class="tocitem" href="reference.html">References</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../library/outline.html">Outline</a></li><li><a class="tocitem" href="../library/acflow.html">ACFlow</a></li><li><a class="tocitem" href="../library/global.html">Constants</a></li><li><a class="tocitem" href="../library/type.html">Types</a></li><li><a class="tocitem" href="../library/base.html">Core</a></li><li><a class="tocitem" href="../library/solver.html">Solvers</a></li><li><a class="tocitem" href="../library/grid.html">Grids</a></li><li><a class="tocitem" href="../library/mesh.html">Meshes</a></li><li><a class="tocitem" href="../library/model.html">Models</a></li><li><a class="tocitem" href="../library/kernel.html">Kernels</a></li><li><a class="tocitem" href="../library/config.html">Configuration</a></li><li><a class="tocitem" href="../library/inout.html">Input and output</a></li><li><a class="tocitem" href="../library/math.html">Math</a></li><li><a class="tocitem" href="../library/util.html">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory</a></li><li class="is-active"><a href="sac1.html">Stochastic Analytical Continuation 1</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="sac1.html">Stochastic Analytical Continuation 1</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/huangli712/ACFlow/blob/main/docs/src/theory/sac1.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="san"><a class="docs-heading-anchor" href="#san">Stochastic Analytical Continuation 1</a><a id="san-1"></a><a class="docs-heading-anchor-permalink" href="#san" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>In principle, for given Green&#39;s function <span>$G$</span>, there exists infinitely many spectral densities <span>$A(\omega)$</span> that can be used to reproduce <span>$G$</span> via <span>$\mathbf{G} = \mathbf{KA}$</span>. The maximum entropy method tries to pick up the most likely spectral function which maximizes <span>$P[A|\bar{G}]$</span> (It actually maximizes <span>$Q$</span>). Here, we would like to introduce an alternative approach, namely the stochastic analytical continuation. It is argued that the weights for all the possible spectral densities are the same if they can give rise to the same <span>$\chi^2$</span>. At first, a sequence of spectral densities will be generated by stochastic method. Then an unbiased thermal average of all possible spectra, Boltzmann weighted according to goodness-of-fit function <span>$\chi^{2}$</span>, produces an average spectrum. Thus sometimes the method was named as average spectrum method or stochastic sampling method in the references. There are several variants for the stochastic analytical continuation. Next we will introduce two representative algorithms as proposed by A. W. Sandvik and K. S. D. Beach, respectively.</p></div></div><h2 id="Sandvik&#39;s-Algorithm"><a class="docs-heading-anchor" href="#Sandvik&#39;s-Algorithm">Sandvik&#39;s Algorithm</a><a id="Sandvik&#39;s-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Sandvik&#39;s-Algorithm" title="Permalink"></a></h2><p>It was early on realized that a different way to achieve a smooth spectrum is to average over many solutions with reasonable <span>$\chi^2$</span> values. Several years later, A. W. Sandvik introduced the stochastic analytical continuation in a slightly different form. He suggested that the spectral function <span>$A(\omega)$</span> can be parameterized using <span>$N$</span> <span>$\delta$</span> functions (Please see Fig.1 for schematic diagram):</p><p class="math-container">\[\begin{equation}
A(\omega) = \sum^{N}_{i = 1} \gamma_i \delta(\omega - \omega_i),
\end{equation}\]</p><p>where <span>$\gamma_i$</span> and <span>$\omega_i$</span> denote the amplitude and position of the <span>$i$</span>-th <span>$\delta$</span> function, respectively. Next, the Metropolis important sampling algorithm is employed to sample the configuration space <span>$\mathcal{C} = \{\omega_i, \gamma_i\}$</span>. In practice, there are two elementary Monte Carlo updates. One is to change the amplitudes of a pair of <span>$\delta$</span> functions under the constraint <span>$\sum_i \gamma_i = 1$</span>. Another one is to shift position of a randomly chosen <span>$\delta$</span> function. Of course, block or global updates can be implemented to improve ergodicity and sampling efficiency.</p><p><img src="../assets/san.png" alt="san.png"/></p><p><strong>Figure 1 |</strong> Typical Monte Carlo field configurations for stochastic analytical continuation (A. W. Sandvik&#39;s version). Here, the <span>$\delta$</span> functions reside at unrestricted frequencies <span>$\{\omega_i\}$</span>, but their amplitudes <span>$\{\gamma_i\}$</span> are equal and fixed. Note that different parameterizations are also possible.</p><p>The transition probability of Monte Carlo updates reads:</p><p class="math-container">\[\begin{equation}
p(\mathcal{C} \to \mathcal{C}&#39;) = \exp\left(-\frac{\Delta\chi^2}{2\Theta}\right),
\end{equation}\]</p><p>where <span>$\chi^2$</span> is the goodness-of-fit function, <span>$\Theta$</span> is a regulation parameter which is similar to the <span>$\alpha$</span> parameter appeared in the maximum entropy method. Well, the remaining problem is how to fix <span>$\Theta$</span>. Sandvik suggested to measure the following entropic term for some <span>$\Theta$</span>:</p><p class="math-container">\[\begin{equation}
S(\Theta) = - \sum^{N}_{i = 1} \gamma_i \log(\gamma_i) K(0,\omega_i),
\end{equation}\]</p><p>where <span>$K$</span> is the kernel function as defined above. Then make a plot of <span>$S$</span> with respect to <span>$\log(\Theta^{-1})$</span>. Overall, when <span>$\Theta$</span> is large, <span>$S$</span> exhibits large fluctuations. When <span>$\Theta$</span> is small, <span>$S$</span> will approach its global minimum steadily. A sharp drop in <span>$S$</span> before the approach to a constant value has been observed, and there is a local maximum at some <span>$\Theta = \hat{\Theta}$</span> preceding the drop. Thus, Sandvik postulated that <span>$\hat{\Theta}$</span> was the optimum value at which to accumulate and average the spectral function. Syljuasen <em>et al.</em> suggested that let <span>$\Theta = 1$</span>. Fuchs <em>et al.</em> tried to fix <span>$\Theta$</span> by using Bayesian inference. Such that their approach was named as stochastic analytical inference. Very recently, Shao and Sandvik <em>et al.</em> proposed a smart method to determine the optimal value of <span>$\Theta$</span>. <span>$\Theta$</span> is adjusted so that</p><p class="math-container">\[\begin{equation}
\langle \chi^2(\Theta) \rangle \approx \chi^{2}_{\text{min}} + c \sqrt{2\chi^2_{\text{min}}},
\end{equation}\]</p><p>where <span>$c$</span> is a constant of order 1, <span>$\chi^{2}_{\text{min}}$</span> is the minimum value of <span>$\chi^{2}$</span> at given <span>$\Theta$</span>. Note that <span>$\chi^{2}_{\text{min}}$</span> can be obtained in a simulated annealing process to very low <span>$\Theta$</span>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="maxent.html">« Maximum Entropy Method</a><a class="docs-footer-nextpage" href="sac2.html">Stochastic Analytical Continuation 2 »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 30 November 2022 01:13">Wednesday 30 November 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
