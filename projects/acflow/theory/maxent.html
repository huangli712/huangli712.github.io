<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Maximum Entropy Method · ACFlow</title><meta name="title" content="Maximum Entropy Method · ACFlow"/><meta property="og:title" content="Maximum Entropy Method · ACFlow"/><meta property="twitter:title" content="Maximum Entropy Method · ACFlow"/><meta name="description" content="Documentation for ACFlow."/><meta property="og:description" content="Documentation for ACFlow."/><meta property="twitter:description" content="Documentation for ACFlow."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/acflow.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="ACFlow logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">ACFlow</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Introduction</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro/acp.html">Analytic Continuation</a></li><li><a class="tocitem" href="../intro/motivation.html">Motivation</a></li><li><a class="tocitem" href="../intro/ack.html">Acknowledgements</a></li><li><a class="tocitem" href="../intro/cite.html">Citation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../man/feature.html">Main Features</a></li><li><a class="tocitem" href="../man/impl.html">Implementations</a></li><li><a class="tocitem" href="../man/install.html">Installation</a></li><li><a class="tocitem" href="../man/run.html">Running Modes</a></li><li><a class="tocitem" href="../man/input.html">Input Files</a></li><li><a class="tocitem" href="../man/output.html">Output Files</a></li><li><a class="tocitem" href="../man/param.html">Parameters</a></li><li><a class="tocitem" href="../man/tricks.html">Tricks and Tips</a></li><li><a class="tocitem" href="../man/gui.html">Graphic User Interface</a></li><li><a class="tocitem" href="../man/test.html">Benchmark Tools</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/sigma.html">Matsubara Self-Energy Function</a></li><li><a class="tocitem" href="../examples/green1.html">Matsubara Green&#39;s Function</a></li><li><a class="tocitem" href="../examples/green2.html">Imaginary Time Green&#39;s Function</a></li><li><a class="tocitem" href="../examples/current.html">Current-Current Correlation Function</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">Theory</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="basic.html">Basic Principles</a></li><li class="is-active"><a class="tocitem" href="maxent.html">Maximum Entropy Method</a><ul class="internal"><li><a class="tocitem" href="#Bayesian-Inference"><span>Bayesian Inference</span></a></li><li><a class="tocitem" href="#Posterior-Probability"><span>Posterior Probability</span></a></li><li><a class="tocitem" href="#Various-Algorithms"><span>Various Algorithms</span></a></li><li><a class="tocitem" href="#Relevant-parameters"><span>Relevant parameters</span></a></li></ul></li><li><a class="tocitem" href="rfa.html">Barycentric Rational Function</a></li><li><a class="tocitem" href="nac.html">Nevanlinna Analytical Continuation</a></li><li><a class="tocitem" href="sac1.html">Stochastic Analytic Continuation 1</a></li><li><a class="tocitem" href="sac2.html">Stochastic Analytic Continuation 2</a></li><li><a class="tocitem" href="som.html">Stochastic Optimization Method</a></li><li><a class="tocitem" href="spx.html">Stochastic Pole Expansion</a></li><li><a class="tocitem" href="reference.html">References</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Library</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../library/outline.html">Outline</a></li><li><a class="tocitem" href="../library/acflow.html">ACFlow</a></li><li><a class="tocitem" href="../library/global.html">Constants</a></li><li><a class="tocitem" href="../library/type.html">Types</a></li><li><a class="tocitem" href="../library/base.html">Core</a></li><li><a class="tocitem" href="../library/solver.html">Solvers</a></li><li><a class="tocitem" href="../library/grid.html">Grids</a></li><li><a class="tocitem" href="../library/mesh.html">Meshes</a></li><li><a class="tocitem" href="../library/model.html">Models</a></li><li><a class="tocitem" href="../library/kernel.html">Kernels</a></li><li><a class="tocitem" href="../library/config.html">Configuration</a></li><li><a class="tocitem" href="../library/inout.html">Input and Output</a></li><li><a class="tocitem" href="../library/math.html">Math</a></li><li><a class="tocitem" href="../library/util.html">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory</a></li><li class="is-active"><a href="maxent.html">Maximum Entropy Method</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="maxent.html">Maximum Entropy Method</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/huangli712/ACFlow" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="mem"><a class="docs-heading-anchor" href="#mem">Maximum Entropy Method</a><a id="mem-1"></a><a class="docs-heading-anchor-permalink" href="#mem" title="Permalink"></a></h1><p>Perhaps the maximum entropy method is the most frequently used approach for analytic continuation problems because of its high computational efficiency. Next, we will discuss the basic principles and several variants of it.</p><h2 id="Bayesian-Inference"><a class="docs-heading-anchor" href="#Bayesian-Inference">Bayesian Inference</a><a id="Bayesian-Inference-1"></a><a class="docs-heading-anchor-permalink" href="#Bayesian-Inference" title="Permalink"></a></h2><p>Bayes&#39;s theorem is the cornerstone of the maximum entropy method. Given two events <span>$a$</span> and <span>$b$</span>, Bayes&#39;s theorem says:</p><p class="math-container">\[\begin{equation}
P[a|b]P[b] = P[b|a]P[a],
\end{equation}\]</p><p>where <span>$P[a]$</span> is the probability of event <span>$a$</span>, <span>$P[a|b]$</span> is the conditional probability of event <span>$a$</span> with given event <span>$b$</span>. In the scenario of analytic continuation problem, <span>$\bar{G}(\tau)$</span> and <span>$A(\omega)$</span> are treated as two events, where <span>$\bar{G}(\tau)$</span> denotes the measured value of <span>$G(\tau)$</span>. So the best solution for <span>$A(\omega)$</span> is of course the one that maximizes <span>$P[A|\bar{G}]$</span>, which is called the posterior probability. According to the Bayes&#39;s theorem, we get</p><p class="math-container">\[\begin{equation}
P[A|\bar{G}] = \frac{P[\bar{G}|A]P[A]}{P[\bar{G}]},
\end{equation}\]</p><p>where <span>$P[\bar{G}|A]$</span> is the likelihood function, <span>$P[A]$</span> is the prior probability, and <span>$P[\bar{G}]$</span> is the evidence. Since the evidence is a normalization constant depending on the prior probability and the likelihood function only, it is ignored in the following discussions. Thus,</p><p class="math-container">\[\begin{equation}
P[A|\bar{G}] \propto P[\bar{G}|A]P[A].
\end{equation}\]</p><h2 id="Posterior-Probability"><a class="docs-heading-anchor" href="#Posterior-Probability">Posterior Probability</a><a id="Posterior-Probability-1"></a><a class="docs-heading-anchor-permalink" href="#Posterior-Probability" title="Permalink"></a></h2><p>In the maximum entropy method, the likelihood function <span>$P[\bar{G}|A]$</span> is assumed to be in direct proportion to <span>$e^{-\chi^2/2}$</span>. <span>$\chi^2$</span> is named as goodness-of-fit function, which measures distance between <span>$\bar{G}(\tau)$</span> and reconstructed imaginary time Green&#39;s function <span>$\tilde{G}(\tau)$</span>:</p><p class="math-container">\[\begin{equation}
\chi^2 = \sum^{L}_{i = 1} \left[\frac{\bar{G}_i(\tau) - \tilde{G}_i(\tau)}{\sigma_i}\right]^2,
\end{equation}\]</p><p class="math-container">\[\begin{equation}
\tilde{G}_i = \sum_j K_{ij} A_j.
\end{equation}\]</p><p>Here, <span>$L$</span> is number of imaginary time points, <span>$\sigma$</span> denotes the error bar (standard deviation) of <span>$\bar{G}(\tau)$</span>. <span>$K_{ij}$</span> and <span>$A_j$</span> are discrete kernel and spectral functions, respectively. On the other hand, the prior probability <span>$P[A]$</span> is supposed to be in direct proportion to <span>$e^{\alpha S}$</span>, where <span>$\alpha$</span> is a regulation parameter and <span>$S$</span> means entropy. Sometimes <span>$S$</span> is also known as the Kullback-Leibler distance (or the Shannon-Jaynes entropy). Its formula is as follows:</p><p class="math-container">\[\begin{equation}
S= \int d\omega \left(A(\omega) - m(\omega) - A(\omega)\log\left[\frac{A(\omega)}{m(\omega)}\right]\right),
\end{equation}\]</p><p>where <span>$m(\omega)$</span> is the default model function. The ACFlow toolkit also supports another kind of entropy, i.e., the Bayesian Reconstruction entropy. It reads:</p><p class="math-container">\[\begin{equation}
S = \int d\omega \left(1 - \frac{A(\omega)}{m(\omega)} + \log \left[\frac{A(\omega)}{m(\omega)}\right]\right).
\end{equation}\]</p><p>According to the Bayes&#39;s theorem, the posterior probability <span>$P[A|\bar{G}] \propto e^{Q}$</span> and</p><p class="math-container">\[\begin{equation}
Q = \alpha S - \frac{\chi^2}{2}.
\end{equation}\]</p><h2 id="Various-Algorithms"><a class="docs-heading-anchor" href="#Various-Algorithms">Various Algorithms</a><a id="Various-Algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Various-Algorithms" title="Permalink"></a></h2><p>Now the original analytic continuation problem becomes how to figure out the optimal <span>$A(\omega)$</span> that maximizes <span>$Q$</span>. In other words, we have to solve the following equation:</p><p class="math-container">\[\begin{equation}
\frac{\partial Q}{\partial A} \bigg|_{A = \hat{A}} = 0,
\end{equation}\]</p><p>where <span>$\hat{A}(\omega)$</span> is the optimal <span>$A(\omega)$</span>. Eq.(9) can be easily solved by using standard Newton method. However, the obtained <span>$\hat{A}(\omega)$</span> is <span>$\alpha$</span>-dependent. That is to say, for a given <span>$\alpha$</span>, there is always a <span>$\hat{A}(\omega)$</span> that satisfies Eq.(9). So, new problem arises because we have to find out a way to generate the final spectral function from these <span>$\alpha$</span>-resolved <span>$\hat{A}(\omega)$</span>. Now there exist four algorithms, namely <code>historic</code>, <code>classic</code>, <code>bryan</code>, and <code>chi2kink</code>. Next we will introduce them one by one.</p><h3 id="Historic-Algorithm"><a class="docs-heading-anchor" href="#Historic-Algorithm">Historic Algorithm</a><a id="Historic-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Historic-Algorithm" title="Permalink"></a></h3><p>The historic algorithm is quite simple. The <span>$\alpha$</span> parameter will be adjusted iteratively to meet the following criterion:</p><p class="math-container">\[\begin{equation}
\chi^2 = N,
\end{equation}\]</p><p>where <span>$N$</span> is the number of mesh points for spectral density <span>$A(\omega)$</span>.</p><h3 id="Classic-Algorithm"><a class="docs-heading-anchor" href="#Classic-Algorithm">Classic Algorithm</a><a id="Classic-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Classic-Algorithm" title="Permalink"></a></h3><p>The basic equation for the classic algorithm reads</p><p class="math-container">\[\begin{equation}
-2 \alpha S(A_{\alpha}) = \text{Tr}
\left[
\frac{\Lambda(A_{\alpha})}{\alpha I + \Lambda(A_{\alpha})}
\right],
\end{equation}\]</p><p>where <span>$I$</span> is an identity matrix. The elements of <span>$\Lambda$</span> matrix are calculated as follows:</p><p class="math-container">\[\begin{equation}
\Lambda_{ij} = \sqrt{A_i} \left(\sum_{kl} K_{ki} [C^{-1}]_{kl} K_{lj}\right) \sqrt{A_j},
\end{equation}\]</p><p>where <span>$C$</span> is the covariance matrix. Eq.(10) will be iteratively solved until the optimal <span>$\alpha$</span> and <span>$\hat{A}(\omega)$</span> are figured out.</p><h3 id="Bryan-Algorithm"><a class="docs-heading-anchor" href="#Bryan-Algorithm">Bryan Algorithm</a><a id="Bryan-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Bryan-Algorithm" title="Permalink"></a></h3><p>In both historic and classic algorithms, the spectral function <span>$\hat{A}(\omega)$</span> is always related to an optimal <span>$\alpha$</span> parameter. However, the spirit of the bryan algorithm is completely different. It tries to yield a series of <span>$\alpha$</span> parameters and calculate the corresponding <span>$A_{\alpha}(\omega)$</span>. Then the final spectral function <span>$A(\omega)$</span> is obtained by evaluating the following integration:</p><p class="math-container">\[\begin{equation}
\overline{A(\omega)} = \int d\alpha~A_{\alpha}(\omega) P[\alpha | \bar{G}].
\end{equation}\]</p><h3 id="Chi2kink-Algorithm"><a class="docs-heading-anchor" href="#Chi2kink-Algorithm">Chi2kink Algorithm</a><a id="Chi2kink-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Chi2kink-Algorithm" title="Permalink"></a></h3><p>This algorithm was proposed by Bergeron and Tremblay recently. The first step is to generate a series of <span>$\alpha$</span> parameters and evaluate the corresponding spectral functions <span>$A_{\alpha}(\omega)$</span> and goodness-of-fit functions <span>$\chi^{2}[A_{\alpha}]$</span>. Then we plot <span>$\log_{10}(\chi^{2})$</span> as a function of <span>$\log_{10}(\alpha)$</span>. Usually this plot is split into three different regions: (1) <em>Default model region</em>. In the limit of <span>$\alpha \to \infty$</span>, <span>$\chi^{2}$</span> goes to a constant high value. It means that the likelihood function <span>$e^{-\chi^2/2}$</span> has negligible weight, such that the prior probability <span>$e^{\alpha S}$</span> becomes dominant and minimizes <span>$Q[A]$</span>. At that time, the calculated <span>$A(\omega)$</span> resembles the default model function <span>$m(\omega)$</span>. (2) <em>Noise-fitting region</em>. In the limit of <span>$\alpha \to 0$</span>, <span>$\chi^2$</span> is relatively flat and approaches its global minimum. In this region, the minimization algorithm tends to fit the noise in <span>$G(\tau)$</span>. (3) <em>Information-fitting region</em>. <span>$\alpha S$</span> is comparable with <span>$\chi^2/2$</span>, so that <span>$\chi^{2}$</span> is strongly dependent on <span>$\alpha$</span>. Bergeron <em>et al.</em> suggested that the optimal <span>$\alpha$</span> parameter situates in the crossover between noise-fitting region and information-fitting region. So the second derivative of <span>$\chi^{2}$</span> with respect to <span>$\alpha$</span> is calculated, and the maximum value in the resulting curve indicates the optimal value of <span>$\alpha$</span>. Quite recently, Kaufmann and Held proposed a more numerically stable and flexible approach to compute the optimal <span>$\alpha$</span>. They use the following function to fit <span>$\log_{10}[\chi^{2}(\alpha)]-\log_{10}(\alpha)$</span>:</p><p class="math-container">\[\begin{equation}
\phi(x;a,b,c,d) = a + \frac{b}{1 + e^{-d(x-c)}},
\end{equation}\]</p><p>where <span>$a$</span>, <span>$b$</span>, <span>$c$</span>, and <span>$d$</span> are fitting parameters. Then the optimal <span>$\alpha$</span> is approximated by <span>$10^{c-f/d}$</span>, where <span>$f$</span> is an empirical constant (The favorite value of <span>$f$</span> lies in <span>$[2,2.5]$</span>).</p><h2 id="Relevant-parameters"><a class="docs-heading-anchor" href="#Relevant-parameters">Relevant parameters</a><a id="Relevant-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Relevant-parameters" title="Permalink"></a></h2><p>See <a href="../man/param.html#maxent_block">[MaxEnt] Block</a></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="basic.html">« Basic Principles</a><a class="docs-footer-nextpage" href="rfa.html">Barycentric Rational Function »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 3 April 2025 00:55">Thursday 3 April 2025</span>. Using Julia version 1.11.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
