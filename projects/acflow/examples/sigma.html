<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Matsubara Self-Energy Function · ACFlow</title><meta name="title" content="Matsubara Self-Energy Function · ACFlow"/><meta property="og:title" content="Matsubara Self-Energy Function · ACFlow"/><meta property="twitter:title" content="Matsubara Self-Energy Function · ACFlow"/><meta name="description" content="Documentation for ACFlow."/><meta property="og:description" content="Documentation for ACFlow."/><meta property="twitter:description" content="Documentation for ACFlow."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="ACFlow logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">ACFlow</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../intro/acp.html">Analytic Continuation</a></li><li><a class="tocitem" href="../intro/motivation.html">Motivation</a></li><li><a class="tocitem" href="../intro/ack.html">Acknowledgements</a></li><li><a class="tocitem" href="../intro/cite.html">Citation</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../man/feature.html">Main Features</a></li><li><a class="tocitem" href="../man/impl.html">Implementations</a></li><li><a class="tocitem" href="../man/install.html">Installation</a></li><li><a class="tocitem" href="../man/run.html">Running Modes</a></li><li><a class="tocitem" href="../man/input.html">Input Files</a></li><li><a class="tocitem" href="../man/output.html">Output Files</a></li><li><a class="tocitem" href="../man/param.html">Parameters</a></li><li><a class="tocitem" href="../man/tricks.html">Tricks and tips</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href="sigma.html">Matsubara Self-Energy Function</a></li><li><a class="tocitem" href="green1.html">Matsubara Green&#39;s Function</a></li><li><a class="tocitem" href="green2.html">Imaginary Time Green&#39;s Function</a></li><li><a class="tocitem" href="current.html">Current-Current Correlation Function</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../theory/basic.html">Basic Principles</a></li><li><a class="tocitem" href="../theory/maxent.html">Maximum Entropy Method</a></li><li><a class="tocitem" href="../theory/rfa.html">Barycentric Rational Function</a></li><li><a class="tocitem" href="../theory/nac.html">Nevanlinna Analytical Continuation</a></li><li><a class="tocitem" href="../theory/sac1.html">Stochastic Analytic Continuation 1</a></li><li><a class="tocitem" href="../theory/sac2.html">Stochastic Analytic Continuation 2</a></li><li><a class="tocitem" href="../theory/som.html">Stochastic Optimization Method</a></li><li><a class="tocitem" href="../theory/spx.html">Stochastic Pole Expansion</a></li><li><a class="tocitem" href="../theory/reference.html">References</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../library/outline.html">Outline</a></li><li><a class="tocitem" href="../library/acflow.html">ACFlow</a></li><li><a class="tocitem" href="../library/global.html">Constants</a></li><li><a class="tocitem" href="../library/type.html">Types</a></li><li><a class="tocitem" href="../library/base.html">Core</a></li><li><a class="tocitem" href="../library/solver.html">Solvers</a></li><li><a class="tocitem" href="../library/grid.html">Grids</a></li><li><a class="tocitem" href="../library/mesh.html">Meshes</a></li><li><a class="tocitem" href="../library/model.html">Models</a></li><li><a class="tocitem" href="../library/kernel.html">Kernels</a></li><li><a class="tocitem" href="../library/config.html">Configuration</a></li><li><a class="tocitem" href="../library/inout.html">Input and output</a></li><li><a class="tocitem" href="../library/math.html">Math</a></li><li><a class="tocitem" href="../library/util.html">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="sigma.html">Matsubara Self-Energy Function</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="sigma.html">Matsubara Self-Energy Function</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/huangli712/ACFlow" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>In order to demonstrate usefulness of the ACFlow toolkit, four examples are illustrated in this section. These examples cover typical application scenarios of the ACFlow toolkit, including analytic continuations of</p><ul><li>Matsubara self-energy function</li><li>Matsubara Green&#39;s function</li><li>Imaginary time Green&#39;s function</li><li>Current-current correlation function</li></ul><p>within the script mode or standard mode. All of the necessary source codes and data files, which can be used to reproduce the results as shown in this section, are placed in the <code>/home/your_home/acflow/tutor/T*</code> folders.</p></div></div><h1 id="ex_sigma"><a class="docs-heading-anchor" href="#ex_sigma">Matsubara Self-Energy Function</a><a id="ex_sigma-1"></a><a class="docs-heading-anchor-permalink" href="#ex_sigma" title="Permalink"></a></h1><p>Now let us consider the following single-band Hubbard model on a Bethe lattice at first:</p><p class="math-container">\[H = -t \sum_{\langle ij \rangle \sigma} c^{\dagger}_{i\sigma}c_{j\sigma}
 - \mu \sum_i n_i + U \sum_i n_{i\uparrow} n_{i\downarrow},\]</p><p>where <span>$t$</span> is the hopping parameter, <span>$\mu$</span> is the chemical potential, <span>$U$</span> is the Coulomb interaction, <span>$n$</span> is the occupation number, <span>$\sigma$</span> denotes the spin, <span>$i$</span> and <span>$j$</span> are site indices. This model is solved by using the dynamical mean-field theory (dubbed DMFT) with the hybridization expansion continuous-time quantum Monte Carlo solver (dubbed CT-HYB) as implemented in the <span>$i$</span>QIST package. The parameters used in the DMFT + CT-HYB calculation are <span>$t = 0.5$</span>, <span>$U = 2.0$</span>, <span>$\mu = 1.0$</span>, and <span>$\beta = 10.0$</span>. Once the DMFT self-consistent calculation is finished, the Matsubara self-energy function <span>$\Sigma(i\omega_n)$</span> is obtained. We are going to convert it to real frequency self-energy function <span>$\Sigma(\omega)$</span>. The data of Matsubara self-energy function <span>$\Sigma(i\omega_n)$</span> have been preprocessed and stored in <code>siw.data</code>. This file contains five columns, which are used to record the Matsubara frequency <span>$\omega_n$</span>, Re<span>$\Sigma(i\omega_n)$</span>, Im<span>$\Sigma(i\omega_n)$</span>, error bar of Re<span>$\Sigma(i\omega_n)$</span>, error bar of Im<span>$\Sigma(i\omega_n)$</span>, respectively. Only the first twenty Matsubara frequency points are kept, because the high-frequency data are somewhat noisy.</p><p>The purpose of this example is to demonstrate usage of the <code>MaxEnt</code> solver and the script mode of the ACFlow toolkit. Next we will explain the key steps in detail. As for the complete Julia script, please refer to <code>sigma.jl</code> and <code>gendata.jl</code> in the <code>/home/your_home/acflow/tutor/T01/</code> folder.</p><p>First, we have to load the essential Julia packages. Both the <code>DelimitedFiles</code> and <code>Printf</code> packages belong to Julia&#39;s standard library. They are used to read input data and write calculated results, respectively.</p><pre><code class="language-julia hljs">#!/usr/bin/env julia

using DelimitedFiles
using Printf
using ACFlow

welcome() # Print welcome message only</code></pre><p>Next, the data of Matsubara self-energy function are read from <code>siw.data</code>. The Hartree term <span>$\Sigma_{H}$</span> should be subtracted from its real part:</p><p class="math-container">\[\Sigma(i\omega_n) \to \Sigma(i\omega_n) - \Sigma_{H}.\]</p><p>Note that <span>$\Sigma_{H}$</span> is approximately equal to the asymptotic value of real part of <span>$\Sigma(i\omega_n)$</span> when <span>$n$</span> goes to infinite.</p><pre><code class="language-julia hljs"># Deal with self-energy function
#
# Read self-energy function
dlm = readdlm(&quot;siw.data&quot;)
#
# Get grid
grid = dlm[:,1]
#
# Get self-energy function
Sinp = dlm[:,2] + im * dlm[:,3] # Value
Serr = dlm[:,4] + im * dlm[:,5] # Error bar
#
# Subtract hartree term
Sh = 1.0
@. Sinp = Sinp - Sh</code></pre><p>Next, the computational parameters are encapsulated into two dictionaries. The dict <code>B</code> is for the <code>[BASE]</code> block, while the dict <code>S</code> is for the <code>MaxEnt</code> solver. Then the <code>setup_param()</code> function is called, so that these parameters take effect. Here, the <code>MatEnt</code> solver is employed to tackle the analytic continuation problem. But the other stochastic sampling solvers are also applicable. The default model function is gaussian. The mesh for spectral density is non-uniform (A tangent mesh). The number of used <span>$\alpha$</span> parameters is 15, and the optimal <span>$\alpha$</span> parameter is determined by the <span>$\chi^2$</span>kink algorithm.</p><pre><code class="language-julia hljs"># Setup parameters
#
# For [BASE] block
# See types.jl/_PBASE for default setup
B = Dict{String,Any}(
    &quot;solver&quot; =&gt; &quot;MaxEnt&quot;,  # Choose MaxEnt solver
    &quot;mtype&quot;  =&gt; &quot;gauss&quot;,   # Default model function
    &quot;mesh&quot;   =&gt; &quot;tangent&quot;, # Mesh for spectral density
    &quot;ngrid&quot;  =&gt; 20,        # Number of input points
    &quot;nmesh&quot;  =&gt; 801,       # Number of output points
    &quot;wmax&quot;   =&gt; 8.0,       # Right boundary of mesh
    &quot;wmin&quot;   =&gt; -8.0,      # Left boundary of mesh
    &quot;beta&quot;   =&gt; 10.0,      # Inverse temperature
)
#
# For [MaxEnt] block
# See types.jl/_PMaxEnt for default setup
S = Dict{String,Any}(
    &quot;nalph&quot;  =&gt; 15,        # Number of alpha
    &quot;alpha&quot;  =&gt; 1e12,      # Starting value of alpha
    &quot;blur&quot;   =&gt; -1.0,      # Enable preblur or not
)
#
# Let the parameters take effect
setup_param(B, S)</code></pre><p>It is quite easy to start the analytic continuation calculation. Just call the <code>solve()</code> function and pass the grid, input data, and error bar data to it. The return values of this function call are real frequency mesh, spectral density, and reconstructed Matsubara self-energy function.</p><pre><code class="language-julia hljs"># Call the solver
mesh, Aout, Sout = solve(grid, Sinp, Serr)</code></pre><p>Finally, the real frequency self-energy function must be supplemented with the Hartree term. Then the final results are written into <code>sigma.data</code>.</p><pre><code class="language-julia hljs"># Calculate final self-energy function on real axis
#
# Add hartree term
@. Sout = Sout + Sh
#
# Write self-energy function to sigma.data
open(&quot;sigma.data&quot;, &quot;w&quot;) do fout
    for i in eachindex(mesh)
        z = Sout[i]
        @printf(fout, &quot;%20.16f %20.16f %20.16f\n&quot;,
                mesh[i], real(z), imag(z))
    end
end</code></pre><p>The calculated results are displayed in <strong>Fig.1</strong>. <strong>Fig.1(a)</strong> and <strong>(b)</strong> show the real and imaginary parts of the real frequency self-energy function, respectively. Near the Fermi level, Re<span>$\Sigma(\omega)$</span> exhibits quasi-linear behavior, with which the quasiparticle weight <span>$Z$</span> and effective mass of electron <span>$m^*$</span> can be easily evaluated. As for the imaginary part, Im<span>$\Sigma(0)$</span> is finite, which indicates that the electron-electron scattering is not trivial. <strong>Fig.1(c)</strong> shows the <span>$\alpha$</span>-dependent <span>$\chi^{2}$</span>. The vertical bar in this figure indicates the optimal <span>$\alpha$</span> is around <span>$10^{2.154}$</span>. In <strong>Fig.(d)</strong>, the reproduced and raw self-energy functions are compared. It is apparent that they are consistent with each other.</p><p><img src="../assets/T_E1.png" alt="T_E1.png"/></p><p><strong>Figure 1 |</strong> Analytic continuation of Matsubara self-energy function by using the maximum entropy method. (a) Real part of real frequency self-energy function. (b) Imaginary part of real frequency self-energy function. (c) <span>$\chi^{2}$</span> as a function of <span>$\alpha$</span>. The vertical bar indicates the optimal <span>$\alpha$</span> parameter chosen by the <code>chi2kink</code> algorithm. (d) Reproduced and original data for imaginary part of the Matsubara self-energy functions.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../man/tricks.html">« Tricks and tips</a><a class="docs-footer-nextpage" href="green1.html">Matsubara Green&#39;s Function »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 23 September 2024 21:02">Monday 23 September 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
