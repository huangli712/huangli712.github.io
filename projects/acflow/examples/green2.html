<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Imaginary Time Green&#39;s Function · ACFlow</title><meta name="title" content="Imaginary Time Green&#39;s Function · ACFlow"/><meta property="og:title" content="Imaginary Time Green&#39;s Function · ACFlow"/><meta property="twitter:title" content="Imaginary Time Green&#39;s Function · ACFlow"/><meta name="description" content="Documentation for ACFlow."/><meta property="og:description" content="Documentation for ACFlow."/><meta property="twitter:description" content="Documentation for ACFlow."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="ACFlow logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">ACFlow</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../intro/acp.html">Analytic Continuation</a></li><li><a class="tocitem" href="../intro/motivation.html">Motivation</a></li><li><a class="tocitem" href="../intro/ack.html">Acknowledgements</a></li><li><a class="tocitem" href="../intro/cite.html">Citation</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../man/feature.html">Main Features</a></li><li><a class="tocitem" href="../man/impl.html">Implementations</a></li><li><a class="tocitem" href="../man/install.html">Installation</a></li><li><a class="tocitem" href="../man/run.html">Running Modes</a></li><li><a class="tocitem" href="../man/input.html">Input Files</a></li><li><a class="tocitem" href="../man/output.html">Output Files</a></li><li><a class="tocitem" href="../man/param.html">Parameters</a></li><li><a class="tocitem" href="../man/tricks.html">Tricks and tips</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="sigma.html">Matsubara Self-Energy Function</a></li><li><a class="tocitem" href="green1.html">Matsubara Green&#39;s Function</a></li><li class="is-active"><a class="tocitem" href="green2.html">Imaginary Time Green&#39;s Function</a></li><li><a class="tocitem" href="current.html">Current-Current Correlation Function</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../theory/basic.html">Basic Principles</a></li><li><a class="tocitem" href="../theory/maxent.html">Maximum Entropy Method</a></li><li><a class="tocitem" href="../theory/rfa.html">Barycentric Rational Function</a></li><li><a class="tocitem" href="../theory/nac.html">Nevanlinna Analytical Continuation</a></li><li><a class="tocitem" href="../theory/sac1.html">Stochastic Analytic Continuation 1</a></li><li><a class="tocitem" href="../theory/sac2.html">Stochastic Analytic Continuation 2</a></li><li><a class="tocitem" href="../theory/som.html">Stochastic Optimization Method</a></li><li><a class="tocitem" href="../theory/spx.html">Stochastic Pole Expansion</a></li><li><a class="tocitem" href="../theory/reference.html">References</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../library/outline.html">Outline</a></li><li><a class="tocitem" href="../library/acflow.html">ACFlow</a></li><li><a class="tocitem" href="../library/global.html">Constants</a></li><li><a class="tocitem" href="../library/type.html">Types</a></li><li><a class="tocitem" href="../library/base.html">Core</a></li><li><a class="tocitem" href="../library/solver.html">Solvers</a></li><li><a class="tocitem" href="../library/grid.html">Grids</a></li><li><a class="tocitem" href="../library/mesh.html">Meshes</a></li><li><a class="tocitem" href="../library/model.html">Models</a></li><li><a class="tocitem" href="../library/kernel.html">Kernels</a></li><li><a class="tocitem" href="../library/config.html">Configuration</a></li><li><a class="tocitem" href="../library/inout.html">Input and output</a></li><li><a class="tocitem" href="../library/math.html">Math</a></li><li><a class="tocitem" href="../library/util.html">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="green2.html">Imaginary Time Green&#39;s Function</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="green2.html">Imaginary Time Green&#39;s Function</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/huangli712/ACFlow" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>In order to demonstrate usefulness of the ACFlow toolkit, four examples are illustrated in this section. These examples cover typical application scenarios of the ACFlow toolkit, including analytic continuations of</p><ul><li>Matsubara self-energy function</li><li>Matsubara Green&#39;s function</li><li>Imaginary time Green&#39;s function</li><li>Current-current correlation function</li></ul><p>within the script mode or standard mode. All of the necessary source codes and data files, which can be used to reproduce the results as shown in this section, are placed in the <code>/home/your_home/acflow/tutor/T*</code> folders.</p></div></div><h1 id="Imaginary-Time-Green&#39;s-Function"><a class="docs-heading-anchor" href="#Imaginary-Time-Green&#39;s-Function">Imaginary Time Green&#39;s Function</a><a id="Imaginary-Time-Green&#39;s-Function-1"></a><a class="docs-heading-anchor-permalink" href="#Imaginary-Time-Green&#39;s-Function" title="Permalink"></a></h1><p>In this example, analytic continuation of imaginary time Green&#39;s function will be tested. Note that this example is borrowed from <em>arXiv:0403055</em> directly.</p><p>The exact spectral function reads:</p><p class="math-container">\[A(\omega) =
\begin{cases}
\frac{1}{W} \frac{|\omega|}{\sqrt{\omega^2 - \Delta^2}},~\quad &amp; \text{if}~\Delta &lt; |\omega| &lt; W/2. \\
0, &amp; \text{otherwise}.
\end{cases}\]</p><p>Here, <span>$W$</span> denotes bandwidth, and <span>$\Delta$</span> is used to control size of the energy gap. Let <span>$W = 6$</span> and <span>$2\Delta = 1$</span>. This spectrum should exhibit flat shoulders, steep peaks, and sharp gap edges. Actually, it is the spectrum of a BCS superconductor.</p><p>First, the imaginary time Green&#39;s function <span>$G(\tau)$</span> is generated using <span>$\mathbf{G} = \mathbf{KA}$</span>. Then a normally-distributed random noise is add to <span>$G(\tau)$</span>. Maximum amplitude of the noise is 1e-4. The error bar of <span>$G(\tau)$</span> is fixed to 1e-3. The data are written in <code>gtau.data</code>.</p><p>Next, we try to prepare the configure file (<code>ac.toml</code>). In this case, we would like to benchmark the <code>StochAC</code> solver, so the <code>solver</code> parameter is set to &#39;&#39;StochAC&#39;&#39; and the <code>grid</code> parameter is set to &#39;&#39;ftime&#39;&#39;. Furthermore, the <code>exclude</code> parameter is enabled to impose some <em>a priori</em> constraints to the spectrum. The full <code>ac.toml</code> is listed as follows:</p><pre><code class="language-toml hljs">[BASE]
finput = &quot;giw.data&quot;
solver = &quot;MaxEnt&quot;
ktype  = &quot;fermi&quot;
mtype  = &quot;flat&quot;
grid   = &quot;ffreq&quot;
mesh   = &quot;linear&quot;
ngrid  = 10
nmesh  = 501
wmax   = 5.0
wmin   = -5.0
beta   = 10.0
offdiag = false
exclude = [[-5.0,-3.0], [-0.5,0.5], [3.0,5.0]]

[StochAC]
nfine = 10000
ngamm = 512
nwarm = 4000
nstep = 10000000
ndump = 40000
nalph = 40
alpha = 1.00
ratio = 1.20</code></pre><p>We perform analytic continuation simulation by running the <code>acrun.jl</code> or <code>Pacrun.jl</code> script. In order to obtain smooth spectral density, it is useful to increase number of <span>$\delta$</span> functions (See <code>ngamm</code> parameter) and number of Monte Carlo sampling steps (See <code>nstep</code> parameter).</p><p><strong>Figure 1</strong> shows the calculated results. In <strong>Fig.1(a)</strong>, the exact spectral function is compared with the simulated spectrum. Note that besides the <code>StochAC</code> solver, the other three solvers are also tested. Their results are also plotted in this figure for a direct comparison. It is remarkable that the <code>StochAC</code> and <code>StochSK</code> solvers do a superior job of modelling the spectrum. The major characteristics of the spectrum, including flat regions, steep peaks, and sharp gap edges, are well captured by the two solvers. Especially, we have finished more tests without any constraints on the spectral density. The gap in the spectrum can be reproduced as well. On the other hand, the spectra obtained by the <code>MaxEnt</code> and <code>StochOM</code> solvers are much too smooth, and show extra shoulder peaks around <span>$\pm$</span> 2.0. <strong>Figure 1(b)</strong> shows <span>$\alpha$</span>-resolved spectral functions <span>$A_{\alpha}(\omega)$</span> for selected <span>$\alpha$</span> parameters. Fluctuation in the flat regions of the calculated spectral density grows when <span>$\alpha$</span> increases. <strong>Figure 1(c)</strong> shows internal energy <span>$U$</span> as a function of <span>$\alpha$</span>. From this figure, the critical <span>$\alpha$</span> is estimated, which is indicated by the vertical bar. Finally, the reproduced Green&#39;s function <span>$\tilde{G}(\tau)$</span> agrees quite well with the raw input data, which is shown in <strong>Fig.1(d)</strong>.</p><p><img src="../assets/T_E3.png" alt="T_E3.png"/></p><p><strong>Figure 1 |</strong> Analytic continuation of imaginary time Green&#39;s function by using the stochastic analytic continuation (Beach&#39;s algorithm). (a) Simulated and exact spectral functions. (b) <span>$\alpha$</span>-dependent spectral functions. (c) Internal energy <span>$U$</span> as a function of <span>$\alpha$</span>. The vertical bar indicates the optimal <span>$\alpha$</span> parameter. (d) Simulated and exact imaginary time Green&#39;s functions.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="green1.html">« Matsubara Green&#39;s Function</a><a class="docs-footer-nextpage" href="current.html">Current-Current Correlation Function »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 12 September 2024 19:27">Thursday 12 September 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
