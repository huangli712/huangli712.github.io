<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Math · ACFlow</title><meta name="title" content="Math · ACFlow"/><meta property="og:title" content="Math · ACFlow"/><meta property="twitter:title" content="Math · ACFlow"/><meta name="description" content="Documentation for ACFlow."/><meta property="og:description" content="Documentation for ACFlow."/><meta property="twitter:description" content="Documentation for ACFlow."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/acflow.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="ACFlow logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">ACFlow</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Introduction</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro/acp.html">Analytic Continuation</a></li><li><a class="tocitem" href="../intro/motivation.html">Motivation</a></li><li><a class="tocitem" href="../intro/ack.html">Acknowledgements</a></li><li><a class="tocitem" href="../intro/cite.html">Citation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../man/feature.html">Main Features</a></li><li><a class="tocitem" href="../man/impl.html">Implementations</a></li><li><a class="tocitem" href="../man/install.html">Installation</a></li><li><a class="tocitem" href="../man/run.html">Running Modes</a></li><li><a class="tocitem" href="../man/input.html">Input Files</a></li><li><a class="tocitem" href="../man/output.html">Output Files</a></li><li><a class="tocitem" href="../man/param.html">Parameters</a></li><li><a class="tocitem" href="../man/tricks.html">Tricks and Tips</a></li><li><a class="tocitem" href="../man/gui.html">Graphic User Interface</a></li><li><a class="tocitem" href="../man/test.html">Benchmark Tools</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/sigma.html">Matsubara Self-Energy Function</a></li><li><a class="tocitem" href="../examples/green1.html">Matsubara Green&#39;s Function</a></li><li><a class="tocitem" href="../examples/green2.html">Imaginary Time Green&#39;s Function</a></li><li><a class="tocitem" href="../examples/current.html">Current-Current Correlation Function</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Theory</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../theory/basic.html">Basic Principles</a></li><li><a class="tocitem" href="../theory/maxent.html">Maximum Entropy Method</a></li><li><a class="tocitem" href="../theory/rfa.html">Barycentric Rational Function</a></li><li><a class="tocitem" href="../theory/nac.html">Nevanlinna Analytical Continuation</a></li><li><a class="tocitem" href="../theory/sac1.html">Stochastic Analytic Continuation 1</a></li><li><a class="tocitem" href="../theory/sac2.html">Stochastic Analytic Continuation 2</a></li><li><a class="tocitem" href="../theory/som.html">Stochastic Optimization Method</a></li><li><a class="tocitem" href="../theory/spx.html">Stochastic Pole Expansion</a></li><li><a class="tocitem" href="../theory/reference.html">References</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">Library</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="outline.html">Outline</a></li><li><a class="tocitem" href="acflow.html">ACFlow</a></li><li><a class="tocitem" href="global.html">Constants</a></li><li><a class="tocitem" href="type.html">Types</a></li><li><a class="tocitem" href="base.html">Core</a></li><li><a class="tocitem" href="solver.html">Solvers</a></li><li><a class="tocitem" href="grid.html">Grids</a></li><li><a class="tocitem" href="mesh.html">Meshes</a></li><li><a class="tocitem" href="model.html">Models</a></li><li><a class="tocitem" href="kernel.html">Kernels</a></li><li><a class="tocitem" href="config.html">Configuration</a></li><li><a class="tocitem" href="inout.html">Input and Output</a></li><li class="is-active"><a class="tocitem" href="math.html">Math</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Root-Finding"><span>Root Finding</span></a></li><li><a class="tocitem" href="#Numerical-Integrations"><span>Numerical Integrations</span></a></li><li><a class="tocitem" href="#Numerical-Derivatives"><span>Numerical Derivatives</span></a></li><li><a class="tocitem" href="#Interpolations"><span>Interpolations</span></a></li><li><a class="tocitem" href="#Einstein-Summation-Convention"><span>Einstein Summation Convention</span></a></li><li><a class="tocitem" href="#Curve-Fitting"><span>Curve Fitting</span></a></li><li><a class="tocitem" href="#Numerical-Optimization"><span>Numerical Optimization</span></a></li><li><a class="tocitem" href="#Line-Search"><span>Line Search</span></a></li></ul></li><li><a class="tocitem" href="util.html">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Library</a></li><li class="is-active"><a href="math.html">Math</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="math.html">Math</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/huangli712/ACFlow" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Math"><a class="docs-heading-anchor" href="#Math">Math</a><a id="Math-1"></a><a class="docs-heading-anchor-permalink" href="#Math" title="Permalink"></a></h1><p><em>Define some essential mathematical functions.</em></p><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="math.html#Math">Math</a></li><li class="no-marker"><ul><li><a href="math.html#Contents">Contents</a></li><li><a href="math.html#Index">Index</a></li><li><a href="math.html#Root-Finding">Root Finding</a></li><li><a href="math.html#Numerical-Integrations">Numerical Integrations</a></li><li><a href="math.html#Numerical-Derivatives">Numerical Derivatives</a></li><li><a href="math.html#Interpolations">Interpolations</a></li><li class="no-marker"><ul><li><a href="math.html#Structs">Structs</a></li><li><a href="math.html#Constructors">Constructors</a></li><li><a href="math.html#Functions">Functions</a></li></ul></li><li><a href="math.html#Einstein-Summation-Convention">Einstein Summation Convention</a></li><li><a href="math.html#Curve-Fitting">Curve Fitting</a></li><li class="no-marker"><ul><li><a href="math.html#Structs-2">Structs</a></li><li><a href="math.html#Constructors-2">Constructors</a></li><li><a href="math.html#Functions-2">Functions</a></li></ul></li><li><a href="math.html#Numerical-Optimization">Numerical Optimization</a></li><li class="no-marker"><ul><li><a href="math.html#Structs-3">Structs</a></li><li><a href="math.html#Constructors-3">Constructors</a></li><li><a href="math.html#Functions-3">Functions</a></li></ul></li><li><a href="math.html#Line-Search">Line Search</a></li><li class="no-marker"><ul><li><a href="math.html#Structs-4">Structs</a></li><li><a href="math.html#Functions-4">Functions</a></li></ul></li></ul></li></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="math.html#ACFlow.AbstractInterpolation"><code>ACFlow.AbstractInterpolation</code></a></li><li><a href="math.html#ACFlow.BFGSDifferentiable-Tuple{Any, Any, AbstractArray}"><code>ACFlow.BFGSDifferentiable</code></a></li><li><a href="math.html#ACFlow.BFGSDifferentiable"><code>ACFlow.BFGSDifferentiable</code></a></li><li><a href="math.html#ACFlow.BFGSOptimizationResults"><code>ACFlow.BFGSOptimizationResults</code></a></li><li><a href="math.html#ACFlow.BFGSState"><code>ACFlow.BFGSState</code></a></li><li><a href="math.html#ACFlow.CubicSplineInterpolation-Tuple{AbstractVector, AbstractVector}"><code>ACFlow.CubicSplineInterpolation</code></a></li><li><a href="math.html#ACFlow.CubicSplineInterpolation"><code>ACFlow.CubicSplineInterpolation</code></a></li><li><a href="math.html#ACFlow.LMOptimizationResults"><code>ACFlow.LMOptimizationResults</code></a></li><li><a href="math.html#ACFlow.LineSearchException"><code>ACFlow.LineSearchException</code></a></li><li><a href="math.html#ACFlow.LinearInterpolation-Tuple{AbstractVector, AbstractVector}"><code>ACFlow.LinearInterpolation</code></a></li><li><a href="math.html#ACFlow.LinearInterpolation"><code>ACFlow.LinearInterpolation</code></a></li><li><a href="math.html#ACFlow.LsqFitResult"><code>ACFlow.LsqFitResult</code></a></li><li><a href="math.html#ACFlow.OnceDifferentiable"><code>ACFlow.OnceDifferentiable</code></a></li><li><a href="math.html#ACFlow.OnceDifferentiable-Tuple{Any, AbstractArray, AbstractArray}"><code>ACFlow.OnceDifferentiable</code></a></li><li><a href="math.html#ACFlow.QuadraticInterpolation"><code>ACFlow.QuadraticInterpolation</code></a></li><li><a href="math.html#ACFlow.QuadraticInterpolation-Tuple{AbstractVector, AbstractVector}"><code>ACFlow.QuadraticInterpolation</code></a></li><li><a href="math.html#ACFlow.LS"><code>ACFlow.LS</code></a></li><li><a href="math.html#ACFlow._interp"><code>ACFlow._interp</code></a></li><li><a href="math.html#ACFlow.converged"><code>ACFlow.converged</code></a></li><li><a href="math.html#ACFlow.curve_fit"><code>ACFlow.curve_fit</code></a></li><li><a href="math.html#ACFlow.eval_resid"><code>ACFlow.eval_resid</code></a></li><li><a href="math.html#ACFlow.eval_Δf"><code>ACFlow.eval_Δf</code></a></li><li><a href="math.html#ACFlow.eval_Δx"><code>ACFlow.eval_Δx</code></a></li><li><a href="math.html#ACFlow.eval_δf"><code>ACFlow.eval_δf</code></a></li><li><a href="math.html#ACFlow.eval_δx"><code>ACFlow.eval_δx</code></a></li><li><a href="math.html#ACFlow.gradient"><code>ACFlow.gradient</code></a></li><li><a href="math.html#ACFlow.gradient_via_fd"><code>ACFlow.gradient_via_fd</code></a></li><li><a href="math.html#ACFlow.init_state"><code>ACFlow.init_state</code></a></li><li><a href="math.html#ACFlow.jacobian"><code>ACFlow.jacobian</code></a></li><li><a href="math.html#ACFlow.jacobian!"><code>ACFlow.jacobian!</code></a></li><li><a href="math.html#ACFlow.levenberg_marquardt"><code>ACFlow.levenberg_marquardt</code></a></li><li><a href="math.html#ACFlow.linesearch!"><code>ACFlow.linesearch!</code></a></li><li><a href="math.html#ACFlow.maxdiff"><code>ACFlow.maxdiff</code></a></li><li><a href="math.html#ACFlow.munge_data"><code>ACFlow.munge_data</code></a></li><li><a href="math.html#ACFlow.newton"><code>ACFlow.newton</code></a></li><li><a href="math.html#ACFlow.optimize"><code>ACFlow.optimize</code></a></li><li><a href="math.html#ACFlow.secant"><code>ACFlow.secant</code></a></li><li><a href="math.html#ACFlow.second_derivative"><code>ACFlow.second_derivative</code></a></li><li><a href="math.html#ACFlow.simpson"><code>ACFlow.simpson</code></a></li><li><a href="math.html#ACFlow.trace"><code>ACFlow.trace</code></a></li><li><a href="math.html#ACFlow.trapz"><code>ACFlow.trapz</code></a></li><li><a href="math.html#ACFlow.update_g!"><code>ACFlow.update_g!</code></a></li><li><a href="math.html#ACFlow.update_h!"><code>ACFlow.update_h!</code></a></li><li><a href="math.html#ACFlow.update_state!"><code>ACFlow.update_state!</code></a></li><li><a href="math.html#ACFlow.value"><code>ACFlow.value</code></a></li><li><a href="math.html#ACFlow.value-Tuple{BFGSDifferentiable}"><code>ACFlow.value</code></a></li><li><a href="math.html#ACFlow.value!"><code>ACFlow.value!</code></a></li><li><a href="math.html#ACFlow.value_gradient!"><code>ACFlow.value_gradient!</code></a></li><li><a href="math.html#ACFlow.@einsum"><code>ACFlow.@einsum</code></a></li></ul><h2 id="Root-Finding"><a class="docs-heading-anchor" href="#Root-Finding">Root Finding</a><a id="Root-Finding-1"></a><a class="docs-heading-anchor-permalink" href="#Root-Finding" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.secant" href="#ACFlow.secant"><code>ACFlow.secant</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">secant(func, x0, args...)</code></pre><p>It implements the well-known secant algorithm to locate root of a given polynomial function. Here, <code>func</code> means the function, <code>x0</code> is the initial guess, and <code>args...</code> denotes the required arguments for function call to <code>func</code>. In addition, the maximum iterations and tolerance are controled by <code>maxiter</code> and <code>tol</code>, respectively. Be careful, <code>func</code> must be a single variable function.</p><p><strong>Arguments</strong></p><p>See above explanations.</p><p><strong>Returns</strong></p><ul><li>𝑝 -&gt; The solution.</li></ul><p>See also: <a href="math.html#ACFlow.newton"><code>newton</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.newton" href="#ACFlow.newton"><code>ACFlow.newton</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">newton(
    fun::Function,
    guess,
    kwargs...;
    maxiter::I64 = 20000,
    mixing::F64 = 0.5
)</code></pre><p>It implements the well-known newton algorithm to locate root of a given polynomial function. Here, <code>fun</code> means the function, <code>guess</code> is the initial solution, and <code>kwargs...</code> denotes the required arguments for <code>fun</code>. Please be careful, <code>func</code> is a multiple variable function. It not only returns the value, but also the jacobian matrix of the function.</p><p><strong>Arguments</strong></p><p>See above explanations.</p><p><strong>Returns</strong></p><ul><li>sol -&gt; Solution.</li><li>call -&gt; Counter for function call to <code>fun()</code>.</li></ul><p>See also: <a href="math.html#ACFlow.secant"><code>secant</code></a>.</p></div></section></article><h2 id="Numerical-Integrations"><a class="docs-heading-anchor" href="#Numerical-Integrations">Numerical Integrations</a><a id="Numerical-Integrations-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Integrations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.trapz" href="#ACFlow.trapz"><code>ACFlow.trapz</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trapz(x::AbstractMesh, y::AbstractVector{T}) where {T&lt;:N64}</code></pre><p>Perform numerical integration by using the composite trapezoidal rule.</p><p><strong>Arguments</strong></p><ul><li>x -&gt; Real frequency mesh.</li><li>y -&gt; Function values at real axis.</li></ul><p><strong>Returns</strong></p><ul><li>ℐ -&gt; The final value.</li></ul><p>See also: <a href="math.html#ACFlow.simpson"><code>simpson</code></a>.</p></div></section><section><div><pre><code class="language-julia hljs">trapz(
    x::AbstractVector{S},
    y::AbstractVector{T},
    linear::Bool = false
) where {S&lt;:Number, T&lt;:Number}</code></pre><p>Perform numerical integration by using the composite trapezoidal rule. Note that it supports arbitrary precision via BigFloat.</p><p><strong>Arguments</strong></p><ul><li>x      -&gt; Real frequency mesh.</li><li>y      -&gt; Function values at real axis.</li><li>linear -&gt; Whether the given mesh is linear?</li></ul><p><strong>Returns</strong></p><ul><li>ℐ -&gt; The final value.</li></ul><p>See also: <a href="math.html#ACFlow.simpson"><code>simpson</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.simpson" href="#ACFlow.simpson"><code>ACFlow.simpson</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simpson(
    x::AbstractVector{S},
    y::AbstractVector{T}
) where {S&lt;:Number, T&lt;:Number}</code></pre><p>Perform numerical integration by using the simpson rule. Note that the length of <code>x</code> and <code>y</code> must be odd numbers. And <code>x</code> must be a linear and uniform mesh.</p><p><strong>Arguments</strong></p><ul><li>x -&gt; Real frequency mesh.</li><li>y -&gt; Function values at real axis.</li></ul><p><strong>Returns</strong></p><ul><li>ℐ -&gt; The final value.</li></ul><p>See also: <a href="math.html#ACFlow.trapz"><code>trapz</code></a>.</p></div></section></article><h2 id="Numerical-Derivatives"><a class="docs-heading-anchor" href="#Numerical-Derivatives">Numerical Derivatives</a><a id="Numerical-Derivatives-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Derivatives" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.second_derivative" href="#ACFlow.second_derivative"><code>ACFlow.second_derivative</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">second_derivative(x::AbstractVector, y::AbstractVector)</code></pre><p>Compute second derivative y&#39;&#39;(x). If the length of <code>x</code> and <code>y</code> is <code>N</code>, the length of the returned vector is <code>N-2</code>.</p><p><strong>Arguments</strong></p><ul><li>x -&gt; Real frequency mesh.</li><li>y -&gt; Function values at real axis.</li></ul><p><strong>Returns</strong></p><ul><li>val -&gt; y&#39;&#39;(x).</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.gradient_via_fd" href="#ACFlow.gradient_via_fd"><code>ACFlow.gradient_via_fd</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gradient_via_fd(f, x)</code></pre><p>Compute ∂f/∂x via finite difference method. It is less accurate and much slower than the automatic differentiation approach. Actually, we won&#39;t use this function to calculate gradient. The <code>Zygote.gradient()</code> function is always a better choice.</p><p><strong>Arguments</strong></p><ul><li>x -&gt; Real frequency mesh.</li><li>f -&gt; Function values at real axis, f(x).</li></ul><p><strong>Returns</strong></p><ul><li>val -&gt; ∂f/∂x.</li></ul></div></section></article><h2 id="Interpolations"><a class="docs-heading-anchor" href="#Interpolations">Interpolations</a><a id="Interpolations-1"></a><a class="docs-heading-anchor-permalink" href="#Interpolations" title="Permalink"></a></h2><h3 id="Structs"><a class="docs-heading-anchor" href="#Structs">Structs</a><a id="Structs-1"></a><a class="docs-heading-anchor-permalink" href="#Structs" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.AbstractInterpolation" href="#ACFlow.AbstractInterpolation"><code>ACFlow.AbstractInterpolation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractInterpolation</code></pre><p>It represents an abstract interpolation engine, which is used to build the internal type system.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.LinearInterpolation" href="#ACFlow.LinearInterpolation"><code>ACFlow.LinearInterpolation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LinearInterpolation</code></pre><p>It represents the linear interpolation algorithm.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.QuadraticInterpolation" href="#ACFlow.QuadraticInterpolation"><code>ACFlow.QuadraticInterpolation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">QuadraticInterpolation</code></pre><p>It represents the quadratic interpolation algorithm.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.CubicSplineInterpolation" href="#ACFlow.CubicSplineInterpolation"><code>ACFlow.CubicSplineInterpolation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CubicSplineInterpolation</code></pre><p>It represents the cubic spline interpolation algorithm.</p></div></section></article><h3 id="Constructors"><a class="docs-heading-anchor" href="#Constructors">Constructors</a><a id="Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Constructors" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.LinearInterpolation-Tuple{AbstractVector, AbstractVector}" href="#ACFlow.LinearInterpolation-Tuple{AbstractVector, AbstractVector}"><code>ACFlow.LinearInterpolation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LinearInterpolation(u::AbstractVector, t::AbstractVector)</code></pre><p>Create a LinearInterpolation struct. Note that <code>u</code> and <code>t</code> denote <code>f(x)</code> and <code>x</code>, respectively.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.QuadraticInterpolation-Tuple{AbstractVector, AbstractVector}" href="#ACFlow.QuadraticInterpolation-Tuple{AbstractVector, AbstractVector}"><code>ACFlow.QuadraticInterpolation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">QuadraticInterpolation(u::AbstractVector, t::AbstractVector)</code></pre><p>Create a QuadraticInterpolation struct. Note that <code>u</code> and <code>t</code> denote <code>f(x)</code> and <code>x</code>, respectively.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.CubicSplineInterpolation-Tuple{AbstractVector, AbstractVector}" href="#ACFlow.CubicSplineInterpolation-Tuple{AbstractVector, AbstractVector}"><code>ACFlow.CubicSplineInterpolation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CubicSplineInterpolation(u::AbstractVector, t::AbstractVector)</code></pre><p>Create a CubicSplineInterpolation struct. Note that <code>u</code> and <code>t</code> denote <code>f(x)</code> and <code>x</code>, respectively.</p></div></section></article><h3 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.munge_data" href="#ACFlow.munge_data"><code>ACFlow.munge_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">munge_data(u::AbstractVector{&lt;:Real}, t::AbstractVector{&lt;:Real})</code></pre><p>Preprocess the input data. Note that <code>u</code> and <code>t</code> denote <code>f(x)</code> and <code>x</code>, respectively.</p></div></section><section><div><pre><code class="language-julia hljs">munge_data(u::AbstractVector, t::AbstractVector)</code></pre><p>Preprocess the input data. Note that <code>u</code> and <code>t</code> denote <code>f(x)</code> and <code>x</code>, respectively.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow._interp" href="#ACFlow._interp"><code>ACFlow._interp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_interp(A::LinearInterpolation{&lt;:AbstractVector}, t::Number)</code></pre><p>To implement the linear interpolation algorithm.</p><p>See also: <a href="math.html#ACFlow.LinearInterpolation"><code>LinearInterpolation</code></a>.</p></div></section><section><div><pre><code class="language-julia hljs">_interp(A::QuadraticInterpolation{&lt;:AbstractVector}, t::Number)</code></pre><p>To implement the quadratic interpolation algorithm.</p><p>See also: <a href="math.html#ACFlow.QuadraticInterpolation"><code>QuadraticInterpolation</code></a>.</p></div></section><section><div><pre><code class="language-julia hljs">_interp(A::CubicSplineInterpolation{&lt;:AbstractVector{&lt;:Number}}, t::Number)</code></pre><p>To implement the cubic spline interpolation algorithm.</p><p>See also: <a href="math.html#ACFlow.CubicSplineInterpolation"><code>CubicSplineInterpolation</code></a>.</p></div></section></article><h2 id="Einstein-Summation-Convention"><a class="docs-heading-anchor" href="#Einstein-Summation-Convention">Einstein Summation Convention</a><a id="Einstein-Summation-Convention-1"></a><a class="docs-heading-anchor-permalink" href="#Einstein-Summation-Convention" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.@einsum" href="#ACFlow.@einsum"><code>ACFlow.@einsum</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@einsum(ex)</code></pre><p>Perform Einstein summation like operations on Julia <code>Array</code>s.</p><p><strong>Examples</strong></p><p>Basic matrix multiplication can be implemented as:</p><pre><code class="language-julia hljs">@einsum A[i, j] := B[i, k] * C[k, j]</code></pre><p>If the destination array is preallocated, then use <code>=</code>:</p><pre><code class="language-julia hljs">A = ones(5, 6, 7) # Preallocated space
X = randn(5, 2)
Y = randn(6, 2)
Z = randn(7, 2)

# Store the result in A, overwriting as necessary:
@einsum A[i, j, k] = X[i, r] * Y[j, r] * Z[k, r]</code></pre><p>If destination is not preallocated, then use <code>:=</code> to automatically create a new array for the result:</p><pre><code class="language-julia hljs">X = randn(5, 2)
Y = randn(6, 2)
Z = randn(7, 2)

# Create new array B with appropriate dimensions:
@einsum B[i, j, k] := X[i, r] * Y[j, r] * Z[k, r]</code></pre></div></section></article><h2 id="Curve-Fitting"><a class="docs-heading-anchor" href="#Curve-Fitting">Curve Fitting</a><a id="Curve-Fitting-1"></a><a class="docs-heading-anchor-permalink" href="#Curve-Fitting" title="Permalink"></a></h2><h3 id="Structs-2"><a class="docs-heading-anchor" href="#Structs-2">Structs</a><a class="docs-heading-anchor-permalink" href="#Structs-2" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.OnceDifferentiable" href="#ACFlow.OnceDifferentiable"><code>ACFlow.OnceDifferentiable</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">OnceDifferentiable</code></pre><p>Mutable struct. It is used for objectives and solvers where the gradient is available/exists.</p><p><strong>Members</strong></p><ul><li>ℱ! -&gt; Objective. It is actually a function call and return objective.</li><li>𝒥! -&gt; It is a function call as well and returns jacobian of objective.</li><li>𝐹  -&gt; Cache for ℱ! output.</li><li>𝐽  -&gt; Cache for 𝒥! output.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.LMOptimizationResults" href="#ACFlow.LMOptimizationResults"><code>ACFlow.LMOptimizationResults</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LMOptimizationResults{T,N}</code></pre><p>It is used to save the optimization results of the <code>levenberg_marquardt</code> algorithm.</p><p><strong>Members</strong></p><ul><li>x₀         -&gt; Initial guess for the solution.</li><li>minimizer  -&gt; Final results for the solution.</li><li>minimum    -&gt; Residual.</li><li>iterations -&gt; Number of iterations.</li><li>xconv      -&gt; If the convergence criterion 1 is satisfied.</li><li>gconv      -&gt; If the convergence criterion 2 is satisfied.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.LsqFitResult" href="#ACFlow.LsqFitResult"><code>ACFlow.LsqFitResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LsqFitResult</code></pre><p>It encapsulates the results for curve fitting.</p><p><strong>Members</strong></p><ul><li>param     -&gt; Fitted results, i.e, the fitting parameters.</li><li>resid     -&gt; Residuals.</li><li>jacobian  -&gt; Jacobian matrix.</li><li>converged -&gt; If the curve-fitting algorithm is converged.</li></ul></div></section></article><h3 id="Constructors-2"><a class="docs-heading-anchor" href="#Constructors-2">Constructors</a><a class="docs-heading-anchor-permalink" href="#Constructors-2" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.OnceDifferentiable-Tuple{Any, AbstractArray, AbstractArray}" href="#ACFlow.OnceDifferentiable-Tuple{Any, AbstractArray, AbstractArray}"><code>ACFlow.OnceDifferentiable</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">OnceDifferentiable(𝑓, p0::AbstractArray, 𝐹::AbstractArray)</code></pre><p>Constructor for OnceDifferentiable struct. <code>𝑓</code> is the function, <code>p0</code> is the inital guess, <code>𝐹 = 𝑓(p0)</code> is the cache for <code>𝑓</code>&#39;s output.</p></div></section></article><h3 id="Functions-2"><a class="docs-heading-anchor" href="#Functions-2">Functions</a><a class="docs-heading-anchor-permalink" href="#Functions-2" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.value" href="#ACFlow.value"><code>ACFlow.value</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value(obj::OnceDifferentiable)</code></pre><p>Return <code>obj.𝐹</code>. <code>obj</code> will not be affected.</p></div></section><section><div><pre><code class="language-julia hljs">value(obj::OnceDifferentiable, 𝐹, x)</code></pre><p>Return <code>𝑓(x)</code>. <code>obj</code> will not be affected, but <code>𝐹</code> is updated.</p></div></section><section><div><pre><code class="language-julia hljs">value(obj::BFGSDifferentiable)</code></pre><p>Return <code>obj.𝐹</code>. <code>obj</code> will not be affected.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.value!" href="#ACFlow.value!"><code>ACFlow.value!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value!(obj::OnceDifferentiable, x)</code></pre><p>Return <code>𝑓(x)</code>. <code>obj.𝐹</code> will be updated and returned.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.jacobian" href="#ACFlow.jacobian"><code>ACFlow.jacobian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jacobian(obj::OnceDifferentiable)</code></pre><p>Return <code>obj.𝐽</code>. <code>obj</code> will not be affected.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.jacobian!" href="#ACFlow.jacobian!"><code>ACFlow.jacobian!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jacobian!(obj::OnceDifferentiable, x)</code></pre><p>Return jacobian. <code>obj.𝐽</code> will be updated and returned.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.levenberg_marquardt" href="#ACFlow.levenberg_marquardt"><code>ACFlow.levenberg_marquardt</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">levenberg_marquardt(df::OnceDifferentiable, x₀::AbstractVector{T})</code></pre><p>Returns the argmin over x of <code>sum(f(x).^2)</code> using the Levenberg-Marquardt algorithm. The function <code>f</code> is encoded in <code>df</code>. <code>x₀</code> is an initial guess for the solution.</p><p>See also: <a href="math.html#ACFlow.OnceDifferentiable"><code>OnceDifferentiable</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.curve_fit" href="#ACFlow.curve_fit"><code>ACFlow.curve_fit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">curve_fit(model, x, y, p0)</code></pre><p>Fit data to a non-linear <code>model</code>. <code>p0</code> is an initial model parameter guess. The return object is a composite type (<code>LsqFitResult</code>).</p><p>See also: <a href="math.html#ACFlow.LsqFitResult"><code>LsqFitResult</code></a>.</p></div></section></article><h2 id="Numerical-Optimization"><a class="docs-heading-anchor" href="#Numerical-Optimization">Numerical Optimization</a><a id="Numerical-Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Optimization" title="Permalink"></a></h2><h3 id="Structs-3"><a class="docs-heading-anchor" href="#Structs-3">Structs</a><a class="docs-heading-anchor-permalink" href="#Structs-3" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.BFGSDifferentiable" href="#ACFlow.BFGSDifferentiable"><code>ACFlow.BFGSDifferentiable</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BFGSDifferentiable</code></pre><p>Mutable struct. It is used for objectives and solvers where the gradient is available/exists.</p><p><strong>Members</strong></p><ul><li>ℱ! -&gt; Objective. It is actually a function call and return objective.</li><li>𝒟! -&gt; It is a function call as well and returns derivative of objective.</li><li>𝐹  -&gt; Cache for ℱ! output.</li><li>𝐷  -&gt; Cache for 𝒟! output.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.BFGSState" href="#ACFlow.BFGSState"><code>ACFlow.BFGSState</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BFGSState</code></pre><p>Mutable struct. It is used to trace the history of states visited.</p><p><strong>Members</strong></p><ul><li>x     -&gt; Current position.</li><li>ls    -&gt; Current search direction.</li><li>δx    -&gt; Changes in position.</li><li>δg    -&gt; Changes in gradient.</li><li>xₚ    -&gt; Previous position.</li><li>gₚ    -&gt; Previous gradient.</li><li>fₚ    -&gt; Previous f (f in xₚ).</li><li>H⁻¹   -&gt; Current inverse Hessian matrix.</li><li>alpha -&gt; A internal parameter to control the BFGS algorithm.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.BFGSOptimizationResults" href="#ACFlow.BFGSOptimizationResults"><code>ACFlow.BFGSOptimizationResults</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BFGSOptimizationResults</code></pre><p>It is used to save the optimization results of the BFGS algorithm.</p><p><strong>Members</strong></p><ul><li>x₀         -&gt; Initial guess for the solution.</li><li>minimizer  -&gt; Final results for the solution.</li><li>minimum    -&gt; Objective at the final solution.</li><li>iterations -&gt; Number of iterations.</li><li>δx         -&gt; Absolute change in x.</li><li>Δx         -&gt; Relative change in x.</li><li>δf         -&gt; Absolute change in f.</li><li>Δf         -&gt; Relative change in f.</li><li>resid      -&gt; Maximum gradient of f at the final solution.</li><li>gconv      -&gt; If the convergence criterion is satisfied</li></ul></div></section></article><h3 id="Constructors-3"><a class="docs-heading-anchor" href="#Constructors-3">Constructors</a><a class="docs-heading-anchor-permalink" href="#Constructors-3" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.BFGSDifferentiable-Tuple{Any, Any, AbstractArray}" href="#ACFlow.BFGSDifferentiable-Tuple{Any, Any, AbstractArray}"><code>ACFlow.BFGSDifferentiable</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BFGSDifferentiable(f, df, x::AbstractArray)</code></pre><p>Constructor for BFGSDifferentiable struct. <code>f</code> is the function, <code>df</code> is the derivative of objective, <code>x</code> is the initial guess.</p></div></section></article><h3 id="Functions-3"><a class="docs-heading-anchor" href="#Functions-3">Functions</a><a class="docs-heading-anchor-permalink" href="#Functions-3" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.value-Tuple{BFGSDifferentiable}" href="#ACFlow.value-Tuple{BFGSDifferentiable}"><code>ACFlow.value</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value(obj::BFGSDifferentiable)</code></pre><p>Return <code>obj.𝐹</code>. <code>obj</code> will not be affected.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.gradient" href="#ACFlow.gradient"><code>ACFlow.gradient</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gradient(obj::BFGSDifferentiable)</code></pre><p>Return <code>obj.𝐷</code>. <code>obj</code> will not be affected.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.value_gradient!" href="#ACFlow.value_gradient!"><code>ACFlow.value_gradient!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_gradient!(obj::BFGSDifferentiable, x)</code></pre><p>Evaluate objective and derivative at <code>x</code>. <code>obj.𝐹</code> and <code>obj.𝐷</code> should be updated. Note that here <code>obj.𝒟!</code> is actually <code>nac.jl/smooth_norm()</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.maxdiff" href="#ACFlow.maxdiff"><code>ACFlow.maxdiff</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">maxdiff(x::AbstractArray, y::AbstractArray)</code></pre><p>Return the maximum difference between two arrays: <code>x</code> and <code>y</code>. Note that the sizes of <code>x</code> and <code>y</code> should be the same.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.eval_δf" href="#ACFlow.eval_δf"><code>ACFlow.eval_δf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eval_δf(d::BFGSDifferentiable, s::BFGSState)</code></pre><p>Evaluate the absolute changes in f.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.eval_Δf" href="#ACFlow.eval_Δf"><code>ACFlow.eval_Δf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eval_Δf(d::BFGSDifferentiable, s::BFGSState)</code></pre><p>Evaluate the relative changes in f.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.eval_δx" href="#ACFlow.eval_δx"><code>ACFlow.eval_δx</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eval_δx(s::BFGSState)</code></pre><p>Evaluate the absolute changes in x.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.eval_Δx" href="#ACFlow.eval_Δx"><code>ACFlow.eval_Δx</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eval_Δx(s::BFGSState)</code></pre><p>Evaluate the relative changes in x.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.eval_resid" href="#ACFlow.eval_resid"><code>ACFlow.eval_resid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eval_resid(d::BFGSDifferentiable)</code></pre><p>Evaluate residual (maximum gradient of f at the current position).</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.optimize" href="#ACFlow.optimize"><code>ACFlow.optimize</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">optimize(f, g, x₀::AbstractArray; max_iter::I64 = 1000)</code></pre><p>Return the argmin over x of <code>f(x)</code> using the BFGS algorithm. Here, <code>f</code> is the function call, and <code>g</code> will return the gradient of <code>f</code>, <code>x₀</code> is an initial guess for the solution.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.init_state" href="#ACFlow.init_state"><code>ACFlow.init_state</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_state(d::BFGSDifferentiable, x₀::AbstractArray)</code></pre><p>Create a BFGSState object. Note that <code>d</code> should be updated in this function (<code>d.𝐹</code> and <code>d.𝐷</code>). <code>x₀</code> is an initial guess for the solution.</p><p>See also: <a href="math.html#ACFlow.BFGSDifferentiable"><code>BFGSDifferentiable</code></a>, <a href="math.html#ACFlow.BFGSState"><code>BFGSState</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.update_state!" href="#ACFlow.update_state!"><code>ACFlow.update_state!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_state!(d::BFGSDifferentiable, s::BFGSState)</code></pre><p>Evaluate line search direction and change of x. New position and old gradient are saved in <code>s</code>.</p><p>See also: <a href="math.html#ACFlow.BFGSDifferentiable"><code>BFGSDifferentiable</code></a>, <a href="math.html#ACFlow.BFGSState"><code>BFGSState</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.update_g!" href="#ACFlow.update_g!"><code>ACFlow.update_g!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_g!(d::BFGSDifferentiable, s::BFGSState)</code></pre><p>Update the function value and gradient (<code>d.𝐹</code> and <code>d.𝐷</code> are changed).</p><p>See also: <a href="math.html#ACFlow.BFGSDifferentiable"><code>BFGSDifferentiable</code></a>, <a href="math.html#ACFlow.BFGSState"><code>BFGSState</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.update_h!" href="#ACFlow.update_h!"><code>ACFlow.update_h!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_h!(d::BFGSDifferentiable, s::BFGSState)</code></pre><p>Try to evaluate the new Hessian matrix.</p><p>See also: <a href="math.html#ACFlow.BFGSDifferentiable"><code>BFGSDifferentiable</code></a>, <a href="math.html#ACFlow.BFGSState"><code>BFGSState</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.trace" href="#ACFlow.trace"><code>ACFlow.trace</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trace(d::BFGSDifferentiable, iter::I64, curr_time::F64)</code></pre><p>Print some useful information about the optimization procedure.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.linesearch!" href="#ACFlow.linesearch!"><code>ACFlow.linesearch!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">linesearch!(d::BFGSDifferentiable, s::BFGSState)</code></pre><p>Evaluate line search direction. Actually, <code>s.alpha</code>, <code>s.fₚ</code>, and <code>s.xₚ</code> will be updated in this function.</p><p>See also: <a href="math.html#ACFlow.BFGSDifferentiable"><code>BFGSDifferentiable</code></a>, <a href="math.html#ACFlow.BFGSState"><code>BFGSState</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.converged" href="#ACFlow.converged"><code>ACFlow.converged</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">converged(r::BFGSOptimizationResults)</code></pre><p>Check whether the optimization is converged.</p><p>See also: <a href="math.html#ACFlow.BFGSOptimizationResults"><code>BFGSOptimizationResults</code></a>.</p></div></section></article><h2 id="Line-Search"><a class="docs-heading-anchor" href="#Line-Search">Line Search</a><a id="Line-Search-1"></a><a class="docs-heading-anchor-permalink" href="#Line-Search" title="Permalink"></a></h2><h3 id="Structs-4"><a class="docs-heading-anchor" href="#Structs-4">Structs</a><a class="docs-heading-anchor-permalink" href="#Structs-4" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.LineSearchException" href="#ACFlow.LineSearchException"><code>ACFlow.LineSearchException</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LineSearchException</code></pre><p>Mutable struct. It contains information about the error occured in the line search.</p><p><strong>Members</strong></p><ul><li>message -&gt; Error message.</li><li>alpha   -&gt; A key parameter used to control line search.</li></ul></div></section></article><h3 id="Functions-4"><a class="docs-heading-anchor" href="#Functions-4">Functions</a><a class="docs-heading-anchor-permalink" href="#Functions-4" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ACFlow.LS" href="#ACFlow.LS"><code>ACFlow.LS</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LS(state::BFGSState, alpha::T, scaled::Bool)</code></pre><p>Line search: initial and static version.</p></div></section><section><div><pre><code class="language-julia hljs">LS(df::BFGSDifferentiable,
    x::Vector{C64}, s::Vector{C64},
    c::F64, phi_0::F64, dphi_0::F64)</code></pre><p>Line search: Hager-Zhang algorithm.</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="inout.html">« Input and Output</a><a class="docs-footer-nextpage" href="util.html">Utilities »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 3 April 2025 00:55">Thursday 3 April 2025</span>. Using Julia version 1.11.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
