<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tricks and tips · ACFlow</title><meta name="title" content="Tricks and tips · ACFlow"/><meta property="og:title" content="Tricks and tips · ACFlow"/><meta property="twitter:title" content="Tricks and tips · ACFlow"/><meta name="description" content="Documentation for ACFlow."/><meta property="og:description" content="Documentation for ACFlow."/><meta property="twitter:description" content="Documentation for ACFlow."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="ACFlow logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">ACFlow</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../intro/acp.html">Analytic Continuation</a></li><li><a class="tocitem" href="../intro/motivation.html">Motivation</a></li><li><a class="tocitem" href="../intro/ack.html">Acknowledgements</a></li><li><a class="tocitem" href="../intro/cite.html">Citation</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="feature.html">Main Features</a></li><li><a class="tocitem" href="impl.html">Implementations</a></li><li><a class="tocitem" href="install.html">Installation</a></li><li><a class="tocitem" href="run.html">Running Modes</a></li><li><a class="tocitem" href="input.html">Input Files</a></li><li><a class="tocitem" href="output.html">Output Files</a></li><li><a class="tocitem" href="param.html">Parameters</a></li><li class="is-active"><a class="tocitem" href="tricks.html">Tricks and tips</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#general"><span>General rules</span></a></li><li><a class="tocitem" href="#maxent"><span>MaxEnt solver</span></a></li><li><a class="tocitem" href="#barrat"><span>BarRat solver</span></a></li><li><a class="tocitem" href="#nevanac"><span>NevanAC solver</span></a></li><li><a class="tocitem" href="#stochac"><span>StochAC solver</span></a></li><li><a class="tocitem" href="#stochsk"><span>StochSK solver</span></a></li><li><a class="tocitem" href="#stochom"><span>StochOM solver</span></a></li><li><a class="tocitem" href="#stochpx"><span>StochPX solver</span></a></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/sigma.html">Matsubara Self-Energy Function</a></li><li><a class="tocitem" href="../examples/green1.html">Matsubara Green&#39;s Function</a></li><li><a class="tocitem" href="../examples/green2.html">Imaginary Time Green&#39;s Function</a></li><li><a class="tocitem" href="../examples/current.html">Current-Current Correlation Function</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../theory/basic.html">Basic Principles</a></li><li><a class="tocitem" href="../theory/maxent.html">Maximum Entropy Method</a></li><li><a class="tocitem" href="../theory/rfa.html">Barycentric Rational Function</a></li><li><a class="tocitem" href="../theory/nac.html">Nevanlinna Analytical Continuation</a></li><li><a class="tocitem" href="../theory/sac1.html">Stochastic Analytic Continuation 1</a></li><li><a class="tocitem" href="../theory/sac2.html">Stochastic Analytic Continuation 2</a></li><li><a class="tocitem" href="../theory/som.html">Stochastic Optimization Method</a></li><li><a class="tocitem" href="../theory/spx.html">Stochastic Pole Expansion</a></li><li><a class="tocitem" href="../theory/reference.html">References</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../library/outline.html">Outline</a></li><li><a class="tocitem" href="../library/acflow.html">ACFlow</a></li><li><a class="tocitem" href="../library/global.html">Constants</a></li><li><a class="tocitem" href="../library/type.html">Types</a></li><li><a class="tocitem" href="../library/base.html">Core</a></li><li><a class="tocitem" href="../library/solver.html">Solvers</a></li><li><a class="tocitem" href="../library/grid.html">Grids</a></li><li><a class="tocitem" href="../library/mesh.html">Meshes</a></li><li><a class="tocitem" href="../library/model.html">Models</a></li><li><a class="tocitem" href="../library/kernel.html">Kernels</a></li><li><a class="tocitem" href="../library/config.html">Configuration</a></li><li><a class="tocitem" href="../library/inout.html">Input and output</a></li><li><a class="tocitem" href="../library/math.html">Math</a></li><li><a class="tocitem" href="../library/util.html">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href="tricks.html">Tricks and tips</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="tricks.html">Tricks and tips</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/huangli712/ACFlow" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="tricks"><a class="docs-heading-anchor" href="#tricks">Tricks and tips</a><a id="tricks-1"></a><a class="docs-heading-anchor-permalink" href="#tricks" title="Permalink"></a></h1><p><em>A comprehensive guide about how to perform reliable analytic continuation.</em></p><p>As is well-known, analytic continuation is a tedious, tricky, and complicated job. This page contains all of the details (and experiences), that need to be known by the users, about how to get reliable and accurate spectra by using various solvers as implemented in the ACFlow toolkit.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The following tricks and tips are <strong>MY</strong> personal viewpoints or experiences. They are not general rules. They might be wrong or ineffective or useless for some cases. They are definitely not suitable for the other analytic continuation codes.</p></div></div><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="tricks.html#tricks">Tricks and tips</a></li><li class="no-marker"><ul><li><a href="tricks.html#Contents">Contents</a></li><li><a href="tricks.html#general">General rules</a></li><li><a href="tricks.html#maxent">MaxEnt solver</a></li><li><a href="tricks.html#barrat">BarRat solver</a></li><li><a href="tricks.html#nevanac">NevanAC solver</a></li><li><a href="tricks.html#stochac">StochAC solver</a></li><li><a href="tricks.html#stochsk">StochSK solver</a></li><li><a href="tricks.html#stochom">StochOM solver</a></li><li><a href="tricks.html#stochpx">StochPX solver</a></li></ul></li></ul><h2 id="general"><a class="docs-heading-anchor" href="#general">General rules</a><a id="general-1"></a><a class="docs-heading-anchor-permalink" href="#general" title="Permalink"></a></h2><ol><li><p>It would be better to perform analytic continuation in Matsubara frequency axis, instead of imaginary time axis. See <a href="param.html#grid"><code>grid</code></a> and <a href="param.html#ngrid"><code>ngrid</code></a>.</p></li><li><p>Employ the BarRat or MaxEnt solver for a fast analytic continuation task. And then the stochastic methods (the StochPX solver is preferred) can be used to get a better spectrum. See <a href="param.html#solver"><code>solver</code></a>.</p></li><li><p>If the input data is broken or discontinuous, please setup the <a href="param.html#grid"><code>grid</code></a> parameter correctly.</p></li><li><p>Set <a href="param.html#nmesh"><code>nmesh</code></a> to an odd number.</p></li><li><p>The spectra generated by any analytic continuation solvers (<code>Aout.data</code>) can be used as the default model for the <code>MaxEnt</code> and <code>StochAC</code> solvers. See <a href="param.html#mtype"><code>mtype</code></a>.</p></li><li><p>Employ the <a href="param.html#pmodel"><code>pmode</code></a> and <a href="param.html#mtype"><code>mtype</code></a> parameters to customize the default model if you know <em>a priori</em> information about the spectra.</p></li><li><p>Employ the <a href="param.html#pmesh"><code>pmesh</code></a> and <a href="param.html#mesh"><code>mesh</code></a> parameters to customize the real-frequency mesh if you know the positions for the sharp features in the spectra.</p></li><li><p>Employ the <a href="param.html#exclude"><code>exclude</code></a> parameters to limit the distributions of random fields for the <code>StochAC</code>, <code>StochSK</code>, and <code>StochPX</code> solvers, if you have rough estimations about the band edges or band gaps in the spectra. Actually, we can use the constrained algorithm to determine the positions for these sharp features.</p></li></ol><h2 id="maxent"><a class="docs-heading-anchor" href="#maxent">MaxEnt solver</a><a id="maxent-1"></a><a class="docs-heading-anchor-permalink" href="#maxent" title="Permalink"></a></h2><ol><li><p>The <code>chi2kink</code> and <code>bryan</code> algorithms are recommended. See <a href="param.html#maxent_method"><code>method</code></a>.</p></li><li><p>The Shannon-Jaynes entropy is recommented. But sometimes, if sharp features are essential, please choose the Bayesian Reconstruction entropy. See <a href="param.html#maxent_stype"><code>stype</code></a>.</p></li><li><p>Adjust the <a href="param.html#maxent_nalph"><code>nalph</code></a>, <a href="param.html#maxent_alpha"><code>alpha</code></a>, <a href="param.html#maxent_ratio"><code>ratio</code></a> parameters to make sure that the <span>$\chi^2(\alpha)$</span> curve is reasonable. It means that the <code>default model region</code> and the <code>noise-fitting region</code> should exhibit similar lengths.</p></li><li><p>If there is a <code>NaN</code> error, please decrease the <a href="param.html#maxent_nalph"><code>nalph</code></a> parameter at first. And then you can increase the <a href="param.html#maxent_alpha"><code>alpha</code></a> parameter. Of cource, a different scheme for determining optimal <span>$\alpha$</span> is also possible. See <a href="param.html#maxent_method"><code>method</code></a>.</p></li></ol><h2 id="barrat"><a class="docs-heading-anchor" href="#barrat">BarRat solver</a><a id="barrat-1"></a><a class="docs-heading-anchor-permalink" href="#barrat" title="Permalink"></a></h2><ol><li><p>If you know the possible type of the spectrum (continuum or discrete), please setup the <code>atype</code> parameter. See <a href="param.html#barrat_atype"><code>atype</code></a>.</p></li><li><p>The BarRat solver wants more input data than the other solvers. The <code>ngrid</code> parameter should be at least 100. See <a href="param.html#ngrid"><code>ngrid</code></a>.</p></li><li><p>Sometimes the Prony approximation will lead to worse results. Use it carefully. See <a href="param.html#barrat_denoise"><code>denoise</code></a>.</p></li><li><p>If you know the noise level of input data, please set <code>epsilon</code> to it and let <code>denoise</code> = &quot;prony_s&quot;.</p></li><li><p>If you do not know the noise level of input data, just let <code>denoise</code> = &quot;prony_o&quot; or &quot;none&quot;. See <a href="param.html#barrat_denoise"><code>denoise</code></a>.</p></li><li><p>If the spectrum is discrete, the BarRat solver will output the positions of the poles. Please adjust the <code>pcut</code> parameter to control how many poles are kept. See <a href="param.html#barrat_pcut"><code>pcut</code></a>.</p></li></ol><h2 id="nevanac"><a class="docs-heading-anchor" href="#nevanac">NevanAC solver</a><a id="nevanac-1"></a><a class="docs-heading-anchor-permalink" href="#nevanac" title="Permalink"></a></h2><ol><li><p>It is extremely sensitive to the noise. So please make sure that the input data is smooth and is free of noise.</p></li><li><p>Actually, I think it is not suitable for quantum Monte Carlo data.</p></li></ol><h2 id="stochac"><a class="docs-heading-anchor" href="#stochac">StochAC solver</a><a id="stochac-1"></a><a class="docs-heading-anchor-permalink" href="#stochac" title="Permalink"></a></h2><ol><li><p>Increase <code>nfine</code> to 20000. See <a href="param.html#stochac_nfine"><code>nfine</code></a>.</p></li><li><p>Perhaps more <span>$\alpha$</span> could help. See <a href="param.html#stochac_nalph"><code>nalph</code></a>.</p></li><li><p>Run it parallelly (use <code>Pacrun.jl</code>).</p></li></ol><h2 id="stochsk"><a class="docs-heading-anchor" href="#stochsk">StochSK solver</a><a id="stochsk-1"></a><a class="docs-heading-anchor-permalink" href="#stochsk" title="Permalink"></a></h2><ol><li><p>The <code>chi2min</code> algorithm is recommended. See <a href="param.html#stochsk_method"><code>method</code></a>.</p></li><li><p>Increase <code>nfine</code> and <code>nstep</code>. See <a href="param.html#stochsk_nfine"><code>nfine</code></a>.</p></li><li><p>Run it parallelly (use <code>Pacrun.jl</code>).</p></li></ol><h2 id="stochom"><a class="docs-heading-anchor" href="#stochom">StochOM solver</a><a id="stochom-1"></a><a class="docs-heading-anchor-permalink" href="#stochom" title="Permalink"></a></h2><ol><li><p>It is more efficient for Matsubara frequency Green&#39;s functions.</p></li><li><p>Increase <code>ntry</code>, <code>nstep</code> and <code>nbox</code>. See <a href="param.html#stochom_ntry"><code>ntry</code></a>.</p></li><li><p>Run it parallelly (use <code>Pacrun.jl</code>).</p></li></ol><h2 id="stochpx"><a class="docs-heading-anchor" href="#stochpx">StochPX solver</a><a id="stochpx-1"></a><a class="docs-heading-anchor-permalink" href="#stochpx" title="Permalink"></a></h2><ol><li><p>If the spectrum is expected to be broad, please set <code>method = &#39;mean&#39;</code>. If the spectrum is expected to be <span>$\delta$</span>-like, please set <code>method = &#39;best&#39;</code>. See <a href="param.html#stochpx_method"><code>method</code></a>.</p></li><li><p>Run it parallelly (use <code>Pacrun.jl</code>).</p></li><li><p>Increase <code>ntry</code> to get smooth spectrum. See <a href="param.html#stochpx_ntry"><code>ntry</code></a>.</p></li><li><p>The <code>nstep</code> parameter is related with the <code>npole</code> parameter. If <code>npole</code> is large, <code>nstep</code> could be small. If <code>npole</code> is small, <code>nstep</code> should be large. See <a href="param.html#stochpx_nstep"><code>nstep</code></a> and <a href="param.html#stochpx_npole"><code>npole</code></a>.</p></li><li><p>For condensed matter cases, <code>npole</code> should be quite large. While for molecule cases, <code>npole</code> should be small. See <a href="param.html#stochpx_npole"><code>npole</code></a>.</p></li><li><p>How to determine the <code>nstep</code> parameter? We just increase <code>nstep</code> from its default value and observe the terminal output of the <code>StochPX</code> solver. If <span>$\chi^2$</span> becomes stable (it means that the value of <span>$\chi^2$</span> can be oscillating, but increasing <code>nstep</code> can not suppress <span>$\chi^2$</span> further), the corresponding <code>nstep</code> is optimal. See <a href="param.html#stochpx_nstep"><code>nstep</code></a>.</p></li><li><p>How to determine the <code>theta</code> parameter? Please look at the acceptance probabilities for various Monte Carlo proposals in the <code>stat.data</code> file. They should not be too large or too small, or else we should adjust <code>theta</code>. See <a href="param.html#stochpx_theta"><code>theta</code></a>.</p></li><li><p>If you want to obtain a smoother spectrum, please increase <code>eta</code>, or else reduce <code>eta</code>. See <a href="param.html#stochpx_eta"><code>eta</code></a>.</p></li><li><p>If the spectrum contains many sharp features, the <code>constrained sampling algorithm</code> and <code>self-adaptive sampling algorithm</code> can help. See <a href="../theory/spx.html#stochpx_csa"><code>constrained sampling algorithm</code></a> and <a href="../theory/spx.html#stochpx_ssa"><code>self-adaptive sampling algorithm</code></a> for the basic principles.</p></li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="param.html">« Parameters</a><a class="docs-footer-nextpage" href="../examples/sigma.html">Matsubara Self-Energy Function »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 10 September 2024 19:50">Tuesday 10 September 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
